import{u as ft}from"./theme-FqGrJpQM.js";import{_ as Nt}from"./MainWrapperView.vue_vue_type_style_index_0_lang-Bq1bBcjB.js";import{_ as ge}from"./SelectView.vue_vue_type_style_index_0_lang-q8pLSMPC.js";import{_ as fe}from"./InputView.vue_vue_type_style_index_0_lang-DhjbNr1m.js";import{_ as M}from"./ButtonView.vue_vue_type_style_index_0_computed_true_lang-GI_eqwBr.js";import{t as lt}from"./trunk-DoavT4Nh.js";import{d as at,h as r,B as Yt,i as ot,L as tt,r as Ge,o as s,c as n,a as i,w as D,b as re,l as S,g as yt,k as N,e as t,p as c,n as X,u as x,x as Ee,K as Fe,t as g,f as Y,F as $,y as j,_ as mt,m as At}from"./index-Bem7mkP8.js";import{a as He}from"./axios-BimPEqV4.js";import{i as Rt}from"./index-CehbAW_K.js";import{h as U}from"./moment-C5S46NFB.js";import{_ as jt,m as It,a as Ut,u as qt,L as Bt}from"./LoadingView-D7ApsncX.js";const Kt={style:{width:"100%",display:"flex","flex-flow":"column"}},Wt=at({__name:"PressureDistView",props:{selectedSpot:{type:String,required:!0},data:{type:Object,required:!0},leakPointResult:Object},setup(ze){const ue=r(!1),K=ze,le=Yt(()=>K.data),A=r(lt().getAllTrunk()),m=r({}),F=r(K.selectedSpot),P=()=>A.value[F.value].trunkLength,O=r(0),I=W=>{O.value=W};return ot(()=>{ue.value=!0,m.value=le.value,ue.value=!1}),tt(()=>{ue.value=!0,m.value=le.value,ue.value=!1}),(W,w)=>{const Z=Ge("center");return s(),n("div",Kt,[i(Z,null,{default:D(()=>[i(fe,{"in-label":"Drop Tolerance Value","in-type":"number","model-value":O.value,"onUpdate:modelValue":w[0]||(w[0]=d=>O.value=d),style:{width:"200px"}},null,8,["model-value"])]),_:1}),!ue.value&&Object.keys(m.value).length?(s(),re(jt,{key:0,onOnToleranceChanged:I,"chart-data":m.value,"selected-spot":F.value,"trunk-length":P(),"tolerance-value":O.value,"prediction-result":K.leakPointResult},null,8,["chart-data","selected-spot","trunk-length","tolerance-value","prediction-result"])):S("",!0)])}}}),Ht={key:0,class:"datepickdialog"},Gt={class:"datepickinner"},Qt={style:{display:"flex","flex-flow":"row nowrap",gap:"0.2rem"}},Jt={key:1,class:"selfnavdialog"},Xt={class:"selfnavdialog-inner"},Zt={style:{display:"flex","flex-flow":"row nowrap","justify-content":"center","margin-bottom":"1rem",gap:"1rem"}},el={style:{display:"flex","flex-flow":"row nowrap",gap:"0.5rem","justify-content":"space-between"}},tl={style:{display:"flex","flex-flow":"row nowrap",gap:"0.3rem"}},ll={style:{display:"flex","flex-flow":"row nowrap",gap:"0.3rem",height:"45px","align-items":"center"}},al={style:{"border-radius":"10px",display:"flex","flex-flow":"row nowrap","justify-content":"space-between","padding-left":"10px","padding-right":"10px",border:"1px solid #ccc",padding:"20px","margin-bottom":"1rem"}},ol={style:{border:"1px solid #ccc",padding:"5px","padding-left":"70px","text-align":"center","padding-right":"70px","border-radius":"100px"}},sl={key:0,style:{"font-size":"11px"}},nl={key:0,style:{"font-size":"11px"}},il={key:1,style:{"font-size":"11px"}},rl={style:{display:"flex","flex-flow":"row nowrap",width:"100%","align-items":"center","margin-top":"-40px"}},ul={style:{display:"flex","flex-flow":"no wrap",padding:"10px",gap:"0.5rem"}},dl={style:{width:"100%",padding:"10px",position:"relative"}},pl=["max","value"],vl={key:0,class:"sel-wrapper"},cl={style:{display:"flex","justify-content":"flex-start","overflow-x":"auto","white-space":"nowrap",padding:"20px",gap:"1rem",width:"40%"}},fl=["onClick"],yl={key:0,class:"dataspan"},ml={style:{width:"50%"}},bl={style:{color:"#fff",background:"red",width:"70px",padding:"5px","border-radius":"5px","font-size":"10px","text-align":"center"}},gl={style:{width:"60%","padding-right":"5rem","padding-top":"1rem","padding-bottom":"1rem"}},kl=["src"],hl={class:"table-responsive"},xl={style:{"margin-top":"1rem"}},wl={class:"tbl2"},Dl={style:{"margin-top":"1rem"}},Sl={class:"tbl2"},Cl={key:0,style:{color:"red","text-shadow":"0.5px 0.5px 1px rgba(0,0,0,0.6)"}},Ml={key:1,style:{color:"orange","text-shadow":"0.5px 0.5px 1px rgba(0,0,0,0.6)"}},$l={key:2,style:{color:"yellow","text-shadow":"0.5px 0.5px 1px rgba(0,0,0,0.6)"}},Pl={key:3,style:{color:"lime","text-shadow":"0.5px 0.5px 1px rgba(0,0,0,0.6)"}},Ol={key:4},_l={key:2,class:"hmloader"},Ll={key:3,class:"model-window"},Tl={class:"modelpick-inner"},Vl={key:4,class:"predict-action"},El={style:{"margin-bottom":"0.1rem"}},Fl={style:{"margin-bottom":"0.5rem"}},zl={style:{display:"flex","flex-flow":"row nowrap",gap:"0.5rem"}},Nl={key:5,class:"leak-window"},Yl={style:{color:"rgb(0,150,255)"}},Al={class:"table-responsive"},Rl={style:{width:"100%","margin-top":"1rem"},class:"table table-striped table-hover;"},jl={key:0,style:{border:"1px solid #ccc",padding:"10px"}},Il={key:1,style:{border:"1px solid #ccc",padding:"10px"}},Ul={style:{"font-weight":"bold",border:"1px solid #ccc",padding:"10px"}},ql={key:0,style:{"font-weight":"bold",border:"1px solid #ccc",padding:"10px"}},Bl={key:1,style:{"font-weight":"bold",border:"1px solid #ccc",padding:"10px"}},Kl={key:0},Wl=["href"],Hl={style:{"margin-top":"1rem"}},Gl={key:1},Ql={style:{"margin-top":"1rem"}},Jl={key:6,class:"setting-window"},Xl={class:"setting-inner"},Zl={class:"pref-block"},ea={key:7,class:"save-window"},ta={class:"save-inner"},la={style:{display:"flex","flex-flow":"row nowrap",gap:"0.5rem"}},aa=at({__name:"PlaybackView",props:{initDateFilter:{type:String,required:!0},selectedSpot:{type:String,required:!0},initPlaybackDatas:{type:Array,required:!0},snapShots:{type:Object,required:!1,default:null},mainSize:{type:Object,required:!1}},emits:["onDateChange","onDataSave","onLoadPreset"],setup(ze,{emit:ue}){const K=qt(),le=lt(),A=ue,m=ft(),F=r("forward"),P=r(!1),O=r(""),I=r(!0),W=r(!1),w=ze,Z=r(),d=r(),ae=r(le.getAllTrunk()),_=r(0),Ce=r(0),ke=r([]),he=r(!1),ee=r(250);let H=null;const xe=r(!1);let oe=[];const we={},Qe=r(),se=r(""),De=r(""),J=r(!0),q=r(!1),k=r(!1),ye=r(!1),me=r(!1),ve=r(!1),G=r(7),Je=yt();r(Je.params.saveid);let v=r({}),u=null;const C=r(null),y=r({}),L=()=>{d.value=Rt(Z.value);const a={grid:{top:"10%",left:"10%",right:"10%",bottom:"15%"},legend:{show:!0,type:"scroll",orient:"horizontal"},tooltip:{trigger:"item",triggerOn:"mousemove",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},axisPointer:{show:!0,type:"shadow"},xAxis:[{type:"category",data:[],boundaryGap:!1,splitNumber:1,minInterval:1,scale:!0,axisLabel:{formatter:function(e){return e.split(" (")[1].split(")")[0]},rotate:45,labelStyle:{fontSize:10}},splitLine:{show:!0,lineStyle:{type:"dashed"}},axisTick:{alignWithLabel:!0}}],yAxis:{type:"value",name:"Pressure (PSI)",nameGap:10,max:200,interval:20,axisTick:{show:!0,inside:!0},splitLine:{show:!0,lineStyle:{type:"solid",color:"#999"}},minorTick:{show:!0},minorSplitLine:{show:!0,lineStyle:{type:"dashed",color:"#ccc"}}},series:[]};d.value.setOption(a),setTimeout(()=>{d.value.dispatchAction({type:"legendInverseSelect"}),d.value.dispatchAction({type:"legendAllSelect"}),d.value.resize()},100)},V=()=>{const a=U().format("YYYY-MM-DD"),e=U(w.initDateFilter).format("YYYY-MM-DD");xe.value=a===e};ot(()=>{window.addEventListener("keyup",kt),V()}),N(()=>Z.value,()=>{L(),T(_.value)}),N(()=>w.initPlaybackDatas,(a,e)=>{!a||a.length===0||(V(),R(),T(_.value),he.value=!1,q.value&&(k.value=!0))});const T=a=>{oe=[];for(let l of ae.value[w.selectedSpot].spot)we[l.name]=[];w.initPlaybackDatas.slice(0,a+1).forEach((l,p)=>{const b=`${l.dateFilter} (${l.timeRange})`;oe.push(b),Qe.value=b,l.data.forEach(z=>{const Be=ae.value[w.selectedSpot].spot.find(We=>We.id===z.idSpot).name,Ke=z.avgPsiValues??0;we[Be][p]=Number(Ke.toFixed(2))})});const o=Object.keys(we).map(l=>({name:l,type:"line",data:we[l],showAllSymbol:ve.value,smooth:!1,tooltip:{trigger:"axis",formatter:function(p){return p[0].value}},endLabel:{show:!0,formatter:function(p){return p.value+" ; "+l},color:"#000",backgroundColor:"inherit",padding:5,fontSize:10,borderRadius:5}}));let f=d.value.getOption();f.xAxis[0].data=oe,f.series=o,d.value.setOption(f)},de=()=>{d.value.getOption()},R=()=>{k.value=!1,_.value=0,ke.value=[],clearInterval(H),T(_.value),Ce.value=_.value/w.initPlaybackDatas.length*100},Ne=a=>{k.value=!1,ke.value=[],_.value=parseInt(a.target.value,10),T(_.value),Ce.value=_.value/w.initPlaybackDatas.length*100};N(()=>w.initDateFilter,async()=>{Ze(),Xe(),await Me().then(()=>{st()})});const st=()=>{const a=U(w.initDateFilter),e=a.add(1,"days").format("YYYY-MM-DD"),o=a.subtract(2,"days").format("YYYY-MM-DD");se.value=e,De.value=o};st();const Ye=async()=>{Ze(),await Me().then(()=>{if(xe.value)m.notifyShowError("End of playback");else{ye.value=!0,R();const a=U(se.value).format("YYYY-MM-DD");q.value&&(k.value=!0),he.value=!0,A("onDateChange",a),setTimeout(()=>{ye.value=!1},5e3)}})},Ae=async()=>{Ze(),await Me().then(()=>{ye.value=!0,R();const a=U(De.value).format("YYYY-MM-DD");q.value&&(k.value=!0),he.value=!0,A("onDateChange",a),setTimeout(()=>{ye.value=!1},5e3)})};N(()=>J.value,()=>{J.value&&(Pe(),P.value=!1,q.value=!1)}),N(()=>P.value,()=>{P.value?(J.value=!1,q.value=!0):J.value=!0}),N(()=>q.value,()=>{q.value&&(J.value=!1)}),N(()=>k.value,()=>{if(!k.value&&_.value==w.initPlaybackDatas.length)if(J.value)R(),k.value=!0;else{const a=U().format("YYYY-MM-DD"),e=U(w.initDateFilter).format("YYYY-MM-DD");a===e?k.value=!1:P.value?F.value=="forward"?ne.value?w.initDateFilter!=ie.value?Ye():je.value?(R(),A("onDateChange",pe.value)):Pe():Ye():ne.value?w.initDateFilter!=pe.value?Ae():je.value?(R(),A("onDateChange",ie.value)):Pe():Ae():(R(),k.value=!0)}B.value&&E.value?(it(),nt(),de()):Re()});const nt=()=>{if(k.value)Re();else{const a=d.value.getOption();a.series.forEach(o=>{o.symbolSize=G.value}),a.series.forEach(o=>{o.symbol="circle"});const e=d.value.getOption().tooltip;e.show=!0,d.value.setOption(a)}},Re=()=>{const a=d.value.getOption();a.series.forEach(e=>{e.symbolSize=0}),a.series.forEach(e=>{e.symbol="none"}),d.value.setOption(a),d.value.off("click")},h=r({}),it=()=>{d.value.off("click"),d.value.on("click",a=>{if(a.componentType==="markLine"){if(a.seriesName==="Normal"){m.notifyConfirm("Delete Normal","Are you sure?","Delete","Cancel",async()=>{rt()},()=>{});return}else m.notifyConfirm("Delete Marker","Delete this marker?","Delete","Cancel",async()=>{const p=d.value.getOption();p.series=p.series.filter((b,z)=>z!==a.seriesIndex),d.value.clear(),d.value.setOption(p),Object.keys(h.value).forEach(b=>{h.value[b].index===a.value&&delete h.value[b]}),I.value=!1,setTimeout(()=>{I.value=!0},100)},()=>{});return}const e=oe.findIndex(p=>p===a.name);if(e<0)return;if(h.value.normal){const p=Object.keys(h.value).length,b={type:"line",name:`Drop ${p}`,xAxisIndex:0,data:[],markLine:{symbol:"image://https://gpng.net/wp-content/uploads/ROBBER.png",symbolSize:35,data:[{xAxis:e,symbolRotate:180}],lineStyle:{color:"blue",width:2,type:"dotted"},label:{show:!0,formatter:`Drop ${p}`,position:"insideEndTop"}}},z=d.value.getOption().series;z.push(b),d.value.setOption({series:z})}else{const p={type:"line",name:"Normal",xAxisIndex:0,data:[],markLine:{symbol:"image://https://png.pngtree.com/png-clipart/20230325/original/pngtree-petroleum-workers-or-miners-vector-png-image_9004441.png",symbolSize:42,data:[{xAxis:e}],lineStyle:{color:"red",width:2,type:"dotted"},label:{show:!0,formatter:"Normal",position:"insideEndTop"}}},b=d.value.getOption().series;b.push(p),d.value.setOption({series:b})}const l=d.value.getOption().series.filter(p=>Array.isArray(p.data)).map(p=>({seriesName:p.name,yValue:p.data[e]??0}));if(h.value.normal){const p=Object.keys(h.value).length;h.value[`drop${p}`]={index:e,name:`Drop ${p}`,data:l,order:d.value.getOption().series.length-1,type:"drop",timerange:oe[e].split(" (")[1].split(")")[0],seriesName:oe[e].split(" (")[1].split(")")[0]+".drop."+w.initDateFilter,date:w.initDateFilter}}else{const p={normal:{index:e,name:"Normal",data:l,order:0,type:"normal",timerange:oe[e].split(" (")[1].split(")")[0],seriesName:oe[e].split(" (")[1].split(")")[0]+".normal."+w.initDateFilter,date:w.initDateFilter}};h.value={...p,...h.value},C.value=p.normal.seriesName}})},rt=()=>{const a=d.value.getOption();a.series=a.series.filter(e=>e.name!=="Normal"),d.value.clear(),d.value.setOption(a),delete h.value.normal,m.notifyShow("Normal deleted"),C.value=null},Me=()=>new Promise((a,e)=>{try{if(Object.keys(h.value).length===0){a();return}const o=d.value.getOption();o.series=o.series.filter(f=>!f.markLine),d.value.clear(),d.value.setOption(o),h.value={},a()}catch(o){e(o)}});N(()=>[k.value,ee.value],()=>{k.value?(H!=null&&clearInterval(H),H=setInterval(()=>{_.value<w.initPlaybackDatas.length?(_.value++,w.initPlaybackDatas[_.value]!=null&&(T(_.value),Ce.value=_.value/w.initPlaybackDatas.length*100)):(k.value=!1,clearInterval(H))},ee.value)):H&&(clearInterval(H),H=null)}),N(()=>[m.asideVisible],()=>{setTimeout(()=>{d.value.resize()},500)});const $e=r(!1),bt=()=>F.value=="forward"?se.value:De.value,ce=r(!1),ne=r(!1),je=r(!0),pe=r(""),ie=r(""),gt=()=>{pe.value?ie.value?(ne.value=!0,J.value=!1,P.value=!0,q.value=!0,ce.value=!1,k.value=!1):m.notifyShowError("Date 2 is required"):m.notifyShowError("Date 1 is required")};N(()=>ce.value,()=>{ce.value?(k.value=!1,ne.value=!1):k.value=!0}),N(()=>[ne.value],()=>{ne.value&&(R(),F.value=="forward"?A("onDateChange",pe.value):A("onDateChange",ie.value))}),N(()=>F.value,()=>{F.value=="backward"&&(R(),Pe())});const Pe=()=>{R(),A("onDateChange",w.initDateFilter),ne.value=!1,pe.value=null,ie.value=null},kt=a=>{W.value||((a.keyCode==80||a.keyCode==32)&&(k.value=!k.value),a.keyCode==37&&Ae(),a.keyCode==39&&Ye())},ht=(a,e)=>{if(a.type=="normal"){m.notifyConfirm("Delete Normal","Are you sure?","Delete","Cancel",async()=>{rt()},()=>{});return}const o=d.value.getOption();o.series=o.series.filter(f=>f.name!==a.name),d.value.clear(),d.value.setOption(o),delete h.value[e],I.value=!1,setTimeout(()=>{I.value=!0},100)},B=r(null),E=r(null),te=r(!1),Oe=r(!1),xt=()=>{Oe.value?(te.value=!1,Oe.value=!1):(B.value=null,E.value=null,te.value=!1)};N(()=>te.value,()=>{Oe.value=!1});const Xe=()=>{B.value=null,E.value=null,te.value=!1,Re(),Me(),h.value={}};N(()=>[B.value,E.value],()=>{B.value&&E.value?(it(),nt()):(Re(),m.notifyShow("Prediction stopped"))});const wt=()=>{Oe.value=!0,te.value=!0},_e=r(!1),ut=r([]),Q=r([]),Se=r(!1),Ie=r(),Dt=r(),St=()=>{if(!B.value||!E.value){m.notifyShowError("Please select model and method");return}m.notifyShow("Prediction started"),te.value=!1;let a={};Object.keys(h.value).forEach(o=>{if(h.value[o].type!=="normal"||h.value[o].type!=="drop"){const f=le.getAllTrunk().trunk1.spot.length;let l={name:h.value[o].name,data:h.value[o].data.map(p=>({avgPsiValues:p.yValue})).slice(0,f),type:h.value[o].type};a[h.value[o].name]=l}}),ut.value=[];const e=K.mlpredict(a,E.value);if(_e.value=!0,E.value==="rf_single"?setTimeout(()=>{Q.value=e.sort((o,f)=>o.drop-f.drop)},4e3):E.value==="rf4_multi"?setTimeout(()=>{Q.value=e.sort((o,f)=>o.drop-f.drop)},4e3):E.value==="lr_single"?setTimeout(()=>{Q.value=e.sort((o,f)=>o.drop-f.drop)},4e3):E.value==="dt_single"?setTimeout(()=>{Q.value=e.sort((o,f)=>o.drop-f.drop)},4e3):E.value==="dt4_multi"?setTimeout(()=>{Q.value=e.sort((o,f)=>o.drop-f.drop)},4e3):E.value==="dynamic"&&setTimeout(()=>{Q.value=e.sort((o,f)=>o.drop-f.drop)},4e3),Q.value!=null)for(let o=0;o<Q.value.length;o++)Q.value[o].suspectLocation.leak&&ut.value.push(Q.value[o])},dt=r(),pt=r(),Ct=(a,e,o)=>{Ie.value=a,Se.value=!1,Se.value=!0,dt.value=e,pt.value=o};N(()=>_e.value,()=>{_e.value||(Se.value=!1,Q.value=null,Ie.value=null,Dt.value=null)});const Mt=async a=>{O.value=a,await navigator.clipboard.writeText(O.value),m.notifyShow("Coordinate copied to clipboard")},Ue=a=>{const e=Math.floor(a),o=Math.abs(a-e)*60,f=Math.floor(o),l=(o-f)*60;return`${e}° ${f}' ${l.toFixed(2)}"`};N(()=>ve.value,()=>{if(ve.value){G.value=5;const a=d.value.getOption();a.series.forEach(e=>{e.showAllSymbol=!0}),a.series.forEach(e=>{e.symbolSize=G.value}),d.value.setOption(a)}else{G.value=7;const a=d.value.getOption();a.series.forEach(e=>{e.showAllSymbol=!1}),a.series.forEach(e=>{e.symbolSize=G.value}),d.value.setOption(a)}}),N(()=>G.value,()=>{const a=d.value.getOption();a.series.forEach(e=>{e.symbolSize=G.value}),d.value.setOption(a)});const Ze=()=>{G.value=7,ve.value=!1;const a=d.value.getOption();a.series.forEach(e=>{e.symbolSize=G.value,e.showAllSymbol=!1}),d.value.setOption(a)},be=r(!1);N(()=>h.value,()=>{v.value={},Object.keys(h.value).forEach(a=>{const e=h.value[a].seriesName,o=h.value[a].data,l=o.map(p=>{const b=le.getAllTrunk().trunk1.spot.find(z=>z.name===p.seriesName);if(b!==void 0)return b.id}).filter(p=>p!==void 0);v.value[e]===void 0&&(v.value[e]=[]),l.length>0&&(v.value[e]={date:h.value[a].date,timerange:h.value[a].timerange,type:h.value[a].type,data:l.map((p,b)=>({idSpot:p,avgPsiValues:o[b].yValue}))})})},{deep:!0});const vt=(a,e)=>{const f=v.value[a].data;for(let l=0;l<f.length;l++)if(f[l].idSpot==e)return f[l].avgPsiValues.toFixed(2)};tt(()=>{var a;if(v.value!=null&&(u=Object.keys(v.value),C.value!=null)){y.value=[];const e=C.value,o=(a=v.value[e])==null?void 0:a.data;u.filter(l=>l!==e).forEach(l=>{const p=v.value[l].data,b=[];ae.value.trunk1.spot.forEach((z,Be)=>{const Ke=z.id,We=o.find(Ve=>Ve.idSpot===Ke),ct=p.find(Ve=>Ve.idSpot===Ke);if(We&&ct){const Ve=We.avgPsiValues.toFixed(2)-ct.avgPsiValues.toFixed(2);b[Be]=Ve}else b[Be]=0}),y.value.push({dropKey:l,deltas:b})})}});const et=a=>a.spot,qe=r(!1),Le=r(""),Te=r(""),$t=()=>{k.value=!1,qe.value=!0,W.value=!0},Pt=()=>{qe.value=!1,W.value=!1},Ot=()=>{if(Le.value==""||Te.value==""){m.notifyShowError("Name and description are required");return}m.notifyShow("Saving preset. Please wait..."),qe.value=!1;const a={name:Le.value,desc:Te.value,selectedModel:B.value,selectedMethod:E.value,selections:h.value,seekerValue:_.value};A("onDataSave",a),Le.value="",Te.value=""},_t=()=>{A("onLoadPreset")},Lt=()=>{m.notifyShow("Snapshot loaded"),B.value=w.snapShots.selectedModel,E.value=w.snapShots.selectedMethod,setTimeout(()=>{_.value=w.snapShots.seekerValue,setTimeout(()=>{h.value=w.snapShots.selection;const a=d.value.getOption().series;Object.keys(h.value).forEach(o=>{const f=h.value[o];f.type==="normal"?(a.push({type:"line",name:"Normal",xAxisIndex:0,data:[],markLine:{symbol:"image://https://png.pngtree.com/png-clipart/20230325/original/pngtree-petroleum-workers-or-miners-vector-png-image_9004441.png",symbolSize:42,data:[{xAxis:f.index}],lineStyle:{color:"red",width:2,type:"dotted"},label:{show:!0,formatter:"Normal",position:"insideEndTop"}}}),C.value=f.seriesName):a.push({type:"line",name:f.name,xAxisIndex:0,data:[],markLine:{symbol:"image://https://gpng.net/wp-content/uploads/ROBBER.png",symbolSize:35,data:[{xAxis:f.index,symbolRotate:180}],lineStyle:{color:"blue",width:2,type:"dotted"},label:{show:!0,formatter:f.name,position:"insideEndTop"}}})}),d.value.setOption({series:a});const e=d.value.getOption();d.value.clear(),d.value.setOption(e)},1e3),T(_.value)},3e3)};tt(()=>{d.value&&w.snapShots&&Object.keys(w.snapShots).length>0&&Lt()});const Tt=(a,e)=>{let o=!0;return e.forEach(f=>{a<f&&(o=!1)}),o},Vt=(a,e)=>{let o=0;e.forEach(l=>{o<l&&(o=l)});let f=!0;return e.forEach(l=>{a<l&&l<o&&(f=!1)}),f},Et=(a,e)=>{let o=0;e.forEach(p=>{o<p&&(o=p)});let f=0;e.forEach(p=>{f<p&&p<o&&(f=p)});let l=!0;return e.forEach(p=>{a<p&&p<f&&(l=!1)}),l},Ft=(a,e)=>{let o=!0;return e.forEach(f=>{a>f&&(o=!1)}),o},zt=()=>{d.value&&d.value.getWidth()<1e3&&d.value.resize()};return(a,e)=>{const o=Ge("font-awesome-icon"),f=Ge("center");return s(),n($,null,[ce.value?(s(),n("div",Ht,[t("div",Gt,[e[31]||(e[31]=t("h2",null,[t("b",null,"Select Range")],-1)),e[32]||(e[32]=t("p",{style:{padding:"0",margin:"0"}},"Automatically plays the playback based on current setup",-1)),i(ge,{"in-label":"Speed","model-value":ee.value,"onUpdate:modelValue":e[0]||(e[0]=l=>ee.value=l)},{default:D(()=>e[28]||(e[28]=[t("option",{value:"1000"},"Slowest",-1),t("option",{value:"500"},"Slower",-1),t("option",{value:"300"},"Moderate",-1),t("option",{value:"250"},"Faster",-1),t("option",{value:"200"},"Fastest",-1)])),_:1},8,["model-value"]),i(fe,{"in-type":"date","in-label":"Date 1","model-value":pe.value,"onUpdate:modelValue":e[1]||(e[1]=l=>pe.value=l)},null,8,["model-value"]),i(fe,{"in-type":"date","in-label":"Date 2","model-value":ie.value,"onUpdate:modelValue":e[2]||(e[2]=l=>ie.value=l)},null,8,["model-value"]),t("div",Qt,[i(M,{onClick:gt,"bt-disabled":!1,style:{width:"fit-content"}},{default:D(()=>e[29]||(e[29]=[c("Apply Filter")])),_:1}),i(M,{onClick:e[3]||(e[3]=l=>ce.value=!ce.value),"bt-disabled":!1,style:{width:"fit-content"}},{default:D(()=>e[30]||(e[30]=[c("Cancel ")])),_:1})])])])):S("",!0),$e.value?(s(),n("div",Jt,[t("div",Xt,[e[35]||(e[35]=t("h2",null,[t("b",null,"Select Preference")],-1)),i(ge,{"in-label":"Select","model-value":F.value,"onUpdate:modelValue":e[4]||(e[4]=l=>F.value=l)},{default:D(()=>e[33]||(e[33]=[t("option",{value:"forward"},"Forward",-1),t("option",{value:"backward"},"Backward",-1)])),_:1},8,["model-value"]),i(M,{onClick:e[5]||(e[5]=l=>$e.value=!$e.value),style:{width:"fit-content"},"bt-disabled":!1},{default:D(()=>[i(o,{icon:"save"}),e[34]||(e[34]=c(" Save & Apply"))]),_:1})])])):S("",!0),e[90]||(e[90]=t("h5",{style:{"text-align":"center"}},[t("b",null,"Playback")],-1)),i(f,null,{default:D(()=>[i(ge,{style:{width:"400px"},"in-label":"Speed","model-value":ee.value,"onUpdate:modelValue":e[6]||(e[6]=l=>ee.value=l)},{default:D(()=>e[36]||(e[36]=[t("option",{value:"1000"},"Slowest",-1),t("option",{value:"500"},"Slower",-1),t("option",{value:"300"},"Moderate",-1),t("option",{value:"250"},"Faster",-1),t("option",{value:"200"},"Fastest",-1)])),_:1},8,["model-value"])]),_:1}),t("div",Zt,[!k.value&&!E.value&&!B.value?(s(),re(M,{key:0,onClick:e[7]||(e[7]=l=>te.value=!te.value),"bt-disabled":!1},{default:D(()=>[i(o,{icon:"atom"}),e[37]||(e[37]=c(" Leak Detection"))]),_:1})):S("",!0),k.value?S("",!0):(s(),re(M,{key:1,onClick:_t,"bt-disabled":!1},{default:D(()=>[i(o,{icon:"download"}),e[38]||(e[38]=c(" Import Snapshot "))]),_:1})),E.value&&B.value?(s(),re(M,{key:2,onClick:e[8]||(e[8]=l=>me.value=!me.value),"bt-disabled":!1},{default:D(()=>[i(o,{icon:"sliders"}),e[39]||(e[39]=c(" Settings "))]),_:1})):S("",!0),E.value&&B.value?(s(),re(M,{key:3,style:{background:"red"},onClick:Xe,"bt-disabled":!1},{default:D(()=>[i(o,{icon:"close"}),e[40]||(e[40]=c(" Quit Prediction"))]),_:1})):S("",!0)]),t("div",el,[t("div",tl,[t("label",{class:X([`${x(m).textTheme}`]),style:{cursor:"pointer",padding:"10px",border:"1px solid #ccc","margin-bottom":"1rem","border-radius":"10px"}},[Ee(t("input",{"onUpdate:modelValue":e[9]||(e[9]=l=>J.value=l),type:"checkbox"},null,512),[[Fe,J.value]]),e[41]||(e[41]=c(" Auto-replay "))],2),t("label",{class:X([`${x(m).textTheme}`]),style:{cursor:"pointer",padding:"10px",border:"1px solid #ccc","margin-bottom":"1rem","border-radius":"10px"}},[Ee(t("input",{"onUpdate:modelValue":e[10]||(e[10]=l=>q.value=l),type:"checkbox"},null,512),[[Fe,q.value]]),e[42]||(e[42]=c(" Autoplay on navigating "))],2),t("label",{class:X([`${x(m).textTheme}`]),style:{cursor:"pointer",padding:"10px",border:"1px solid #ccc","margin-bottom":"1rem","border-radius":"10px"}},[Ee(t("input",{"onUpdate:modelValue":e[11]||(e[11]=l=>P.value=l),type:"checkbox"},null,512),[[Fe,P.value]]),e[43]||(e[43]=c(" Self Navigate "))],2),P.value?(s(),re(M,{key:0,onClick:e[12]||(e[12]=l=>$e.value=!$e.value),"bt-disabled":!1,type:"button",class:"slfnavbtn"},{default:D(()=>[i(o,{icon:"sliders"})]),_:1})):S("",!0)]),t("div",ll,[ne.value?(s(),n("label",{key:0,class:X([`${x(m).textTheme}`]),style:{border:"1px solid #ccc",padding:"10px","border-radius":"10px"}},[c(g(x(U)(pe.value).format("ddd, DD MMM YY"))+"    ",1),i(o,{icon:F.value=="forward"?"caret-right":"caret-left"},null,8,["icon"]),c("    "+g(x(U)(ie.value).format("ddd, DD MMM YY")),1)],2)):S("",!0),ne.value?(s(),n("label",{key:1,class:X([`${x(m).textTheme}`]),style:{cursor:"pointer",padding:"10px",border:"1px solid #ccc","border-radius":"10px"}},[Ee(t("input",{"onUpdate:modelValue":e[13]||(e[13]=l=>je.value=l),type:"checkbox"},null,512),[[Fe,je.value]]),e[44]||(e[44]=c(" Repeat "))],2)):S("",!0),i(M,{onClick:e[14]||(e[14]=l=>ce.value=!ce.value),"bt-disabled":!1,type:"button",class:"slfnavbtn"},{default:D(()=>[i(o,{icon:"calendar"})]),_:1}),pe.value&&ie.value?(s(),re(M,{key:2,onClick:Pe,"bt-disabled":!1,class:"slfnavbtn"},{default:D(()=>[i(o,{icon:"close"})]),_:1})):S("",!0)])]),t("div",al,[i(M,{"bt-disabled":ye.value,onClick:Ae},{default:D(()=>[i(o,{icon:"backward"}),c("    "+g(x(U)(De.value).format("ddd, DD MMM YY")),1)]),_:1},8,["bt-disabled"]),t("span",ol,[t("b",{style:Y({color:`${x(m).accentColor}`})},g(x(U)(w.initDateFilter).format("ddd, DD MMM YY")),5),e[48]||(e[48]=t("br",null,null,-1)),ne.value?(s(),n("span",{key:0,class:X([`${x(m).textTheme}`]),style:{"font-size":"11px"}},[e[45]||(e[45]=c("Stops at: ")),t("b",null,g(x(U)(ie.value).format("ddd, DD MMM YY")),1)],2)):(s(),n($,{key:1},[J.value?(s(),n("span",sl,[e[46]||(e[46]=c("Repeating: ")),t("b",null,g(x(U)(w.initDateFilter).format("ddd, DD MMM YY")),1)])):(s(),n($,{key:1},[xe.value?(s(),n("span",il,"[End of playback  ·  Autoplay stopped]")):(s(),n("span",nl,[e[47]||(e[47]=c("Upcoming: ")),t("b",null,g(x(U)(bt()).format("ddd, DD MMM YY")),1)]))],64))],64))]),i(M,{"bt-disabled":xe.value,onClick:Ye},{default:D(()=>[c(g(x(U)(se.value).format("ddd, DD MMM YY"))+"    ",1),i(o,{icon:"forward"})]),_:1},8,["bt-disabled"])]),t("div",{style:Y([{position:"relative",width:"100%"},{marginBottom:Object.keys(h.value).length>1?"8rem":"0"}])},[t("div",{ref_key:"heatMap",ref:Z,style:{width:"100%",height:"600px"}},null,512),t("div",rl,[t("div",ul,[k.value?S("",!0):(s(),n("button",{key:0,style:{"z-index":"1",position:"relative"},onClick:e[15]||(e[15]=l=>k.value=!k.value),class:"controlbtn",type:"button"},[i(o,{icon:"play"})])),k.value?(s(),n("button",{key:1,style:{"z-index":"1",position:"relative"},onClick:e[16]||(e[16]=l=>k.value=!k.value),class:"controlbtn",type:"button"},[i(o,{icon:"pause"})])):S("",!0)]),t("div",dl,[t("input",{onChange:Ne,type:"range",min:0,max:w.initPlaybackDatas.length,value:_.value,class:"slider"},null,40,pl)]),t("div",null,[!k.value&&_.value==w.initPlaybackDatas.length?(s(),n("button",{key:0,onClick:R,class:"controlbtn",type:"button"},[i(o,{icon:"undo"})])):S("",!0)])]),Object.keys(h.value).length?(s(),n("div",vl,[t("div",cl,[(s(!0),n($,null,j(h.value,(l,p)=>(s(),n("div",{key:p,class:"selection-item",onClick:b=>ht(l,p)},[t("h5",{style:Y({color:l.type=="normal"?"red":"blue"})},[t("b",null,g(l.name),1)],4),(s(!0),n($,null,j(l.data,b=>(s(),n("div",{key:b.seriesName},[b.seriesName!="Normal"&&!b.seriesName.includes("Drop")?(s(),n("span",yl,[t("span",ml,g(b.seriesName),1),e[49]||(e[49]=c()),t("span",bl,[t("b",null,g(b.yValue)+" PSI",1)])])):S("",!0)]))),128))],8,fl))),128))]),t("div",gl,[e[54]||(e[54]=t("h4",{style:{"text-align":"center"}},[t("b",null,"Pressure Distribution")],-1)),I.value?(s(),re(Wt,{key:0,style:{width:"100%"},data:x(v),"selected-spot":"trunk1"},null,8,["data"])):S("",!0),t("img",{src:x(It),alt:"map",style:{width:"100%",height:"600px","border-radius":"10px","object-fit":"contain"}},null,8,kl),t("div",hl,[t("h5",xl,[t("b",null,[i(o,{icon:"oil-well"}),e[50]||(e[50]=c(" Selected Pressures"))])]),t("table",wl,[t("thead",null,[t("tr",{style:{padding:"5px"},class:X([`${x(m).textTheme}`])},[t("th",{style:Y({border:`1px solid ${x(m).accentColor}`})},"ACTION",4),t("th",{style:Y({border:`1px solid ${x(m).accentColor}`})},"PINNED SERIES",4),(s(!0),n($,null,j(et(ae.value.trunk1),(l,p)=>(s(),n("th",{style:Y({border:`1px solid ${x(m).accentColor}`}),key:p},g(l.name),5))),128))],2)]),t("tbody",null,[(s(!0),n($,null,j(x(u),(l,p)=>(s(),n("tr",{key:p},[t("td",{style:Y({border:`1px solid ${x(m).accentColor}`,position:"relative",textTransform:"uppercase",fontWeight:"bold"})},null,4),t("td",{class:X([`${x(m).textTheme}`]),style:Y({border:`1px solid ${x(m).accentColor}`,position:"relative",textTransform:"uppercase",fontWeight:"bold"})},[c(g(x(v)[l].date),1),e[51]||(e[51]=t("br",null,null,-1)),c(" "+g(x(v)[l].timerange),1),e[52]||(e[52]=t("br",null,null,-1)),c(" "+g(x(v)[l].type),1)],6),(s(!0),n($,null,j(et(ae.value.trunk1),(b,z)=>(s(),n("td",{style:Y({border:`1px solid ${x(m).accentColor}`}),class:X([`${x(m).textTheme}`]),key:z},[vt(l,b.id)?(s(),n($,{key:0},[c(g(vt(l,b.id)),1)],64)):(s(),n($,{key:1},[c("0.00")],64))],6))),128))]))),128))])]),t("h5",Dl,[t("b",null,[i(o,{icon:"turn-down"}),e[53]||(e[53]=c(" Delta"))])]),t("table",Sl,[t("thead",null,[t("tr",{style:{padding:"5px"},class:X([`${x(m).textTheme}`])},[t("th",{style:Y({border:`1px solid ${x(m).accentColor}`})},"DROPS",4),t("th",{style:Y({border:`1px solid ${x(m).accentColor}`})},"PINNED SERIES",4),(s(!0),n($,null,j(et(ae.value.trunk1),(l,p)=>(s(),n("th",{style:Y({border:`1px solid ${x(m).accentColor}`}),key:p},g(l.name),5))),128))],2)]),t("tbody",null,[(s(!0),n($,null,j(y.value,(l,p)=>(s(),n("tr",{key:p},[t("td",{style:Y({border:`1px solid ${x(m).accentColor}`})},g(p+1),5),t("td",{style:Y({border:`1px solid ${x(m).accentColor}`})},g(l.dropKey.split(".")[0]+"."+l.dropKey.split(".")[1]+"."+l.dropKey.split(".")[2]),5),(s(!0),n($,null,j(l.deltas,(b,z)=>(s(),n("td",{key:z,style:Y({border:`1px solid ${x(m).accentColor}`})},[Tt(b,l.deltas)?(s(),n("span",Cl,g(b.toFixed(2)),1)):Vt(b,l.deltas)?(s(),n("span",Ml,g(b.toFixed(2)),1)):Et(b,l.deltas)?(s(),n("span",$l,g(b.toFixed(2)),1)):Ft(b,l.deltas)?(s(),n("span",Pl,g(b.toFixed(2)),1)):(s(),n("span",Ol,g(b.toFixed(2)),1))],4))),128))]))),128))])])])])])):S("",!0)],4),he.value?(s(),n("div",_l,e[55]||(e[55]=[t("img",{src:"https://cdn.dribbble.com/users/1138184/screenshots/3796132/oil.gif"},null,-1)]))):S("",!0),te.value?(s(),n("div",Ll,[t("div",Tl,[t("button",{onClick:xt,class:"modelpick-dismiss"},[i(o,{icon:"times"})]),e[58]||(e[58]=t("h2",null,[t("b",null,"Leak Detection")],-1)),i(ge,{"in-label":"Select Model","model-value":B.value,"onUpdate:modelValue":e[17]||(e[17]=l=>B.value=l)},{default:D(()=>e[56]||(e[56]=[t("option",{value:""},"Select...",-1),t("option",{value:"normal_pick"},"Normal Pick",-1),t("option",{value:"ranged_pick"},"Ranged Pick",-1)])),_:1},8,["model-value"]),i(ge,{"in-label":"Select Prediction Method","model-value":E.value,"onUpdate:modelValue":e[18]||(e[18]=l=>E.value=l)},{default:D(()=>e[57]||(e[57]=[t("option",{value:""},"Select method...",-1),t("option",{value:"rf_single"},"RF Single-leak",-1),t("option",{value:"rf4_multi"},"RF4 Multi-leak",-1),t("option",{value:"dt_single"},"DT Single-leak",-1),t("option",{value:"dt4_multi"},"DT4 Multi-leak",-1),t("option",{value:"lr_single"},"LR Single-leak",-1),t("option",{value:"dynamic"},"Dynamic",-1)])),_:1},8,["model-value"]),i(M,{onClick:e[19]||(e[19]=l=>te.value=!te.value),style:{width:"fit-content","margin-top":"0.5rem"},"bt-disabled":!1},{default:D(()=>[c(g(Oe.value?"Update Preference":"Start Picking"),1)]),_:1})])])):S("",!0),Object.keys(h.value).length>1&&!be.value?(s(),n("div",Vl,[t("button",{type:"button",class:"predict-action-hide",onClick:e[20]||(e[20]=l=>be.value=!be.value)},[i(o,{icon:"eye-slash"})]),t("div",El,[e[59]||(e[59]=c("Picking Model: ")),t("b",null,g(B.value.split("_").map(l=>l.charAt(0).toUpperCase()+l.slice(1)).join(" ")),1),e[60]||(e[60]=c(" ··· Prediction Method: ")),t("b",null,g(E.value.split("_").map(l=>l.charAt(0).toUpperCase()+l.slice(1)).join(" ")),1)]),t("div",Fl,[e[61]||(e[61]=c("Num of drops: ")),t("b",null,g(Object.keys(h.value).filter(l=>h.value[l].type=="drop").length),1)]),t("div",zl,[i(M,{"bt-size":"small",onClick:St,"bt-disabled":!1,style:{width:"fit-content"}},{default:D(()=>[i(o,{icon:"check"}),e[62]||(e[62]=c(" Predict "))]),_:1}),i(M,{"bt-size":"small",onClick:$t,"bt-disabled":!1,style:{width:"fit-content",background:"rgb(0,150,255)"}},{default:D(()=>[i(o,{icon:"plus"}),e[63]||(e[63]=c(" Create Snapshot "))]),_:1}),i(M,{"bt-size":"small",onClick:wt,"bt-disabled":!1,style:{width:"fit-content",background:"#666"}},{default:D(()=>[i(o,{icon:"refresh"}),e[64]||(e[64]=c(" Change Method "))]),_:1}),i(M,{"bt-size":"small",onClick:Me,"bt-disabled":!1,style:{width:"fit-content",background:"orange"}},{default:D(()=>[i(o,{icon:"trash"}),e[65]||(e[65]=c(" Clear Selection "))]),_:1}),i(M,{"bt-size":"small",onClick:Xe,"bt-disabled":!1,style:{width:"fit-content",background:"red"}},{default:D(()=>[i(o,{icon:"close"}),e[66]||(e[66]=c(" Quit Prediction "))]),_:1})])])):S("",!0),_e.value?(s(),n("div",Nl,[t("div",{class:X(["leak-body",[`${x(m).mTheme}`]])},[t("button",{type:"button",onClick:e[21]||(e[21]=l=>_e.value=!1),class:"leak-dismiss"},[i(o,{icon:"times"})]),t("div",{class:"l-left",style:Y({width:Se.value?"40%":"100%"})},[e[79]||(e[79]=t("h4",{style:{"font-weight":"bold"}},"Leak Analysis",-1)),e[80]||(e[80]=t("hr",null,null,-1)),Q.value?(s(!0),n($,{key:0},j(Q.value,(l,p)=>(s(),n("div",{class:"analysis-set",key:p},[l!=!1?(s(),n($,{key:0},[t("h4",Yl,[t("b",null," DROP "+g(l.drop),1)]),t("p",null,[e[77]||(e[77]=c(" Result: ")),l!=!1&&l.suspectLocation.leak?(s(),n($,{key:0},[e[75]||(e[75]=t("b",{style:{color:"red"}},"Possible leak detected!",-1)),t("div",Al,[t("table",Rl,[t("tr",null,[e[67]||(e[67]=t("th",{style:{border:"1px solid #ccc",padding:"10px"}},"Estimated Leak Point",-1)),l.suspectLocation.leakData.pu_location?(s(),n("th",jl," PU ")):S("",!0),l.suspectLocation.leakData.coordinate?(s(),n("th",Il," Coordinate ")):S("",!0)]),t("tbody",null,[t("tr",null,[t("td",Ul,g(l.suspectLocation.leakData.leak_point)+" KM ",1),l.suspectLocation.leakData.pu_location?(s(),n("td",ql," KM "+g(l.suspectLocation.leakData.pu_location),1)):S("",!0),l.suspectLocation.leakData.coordinate?(s(),n("td",Bl,[e[69]||(e[69]=c(" LatLng: ")),t("code",null,g(l.suspectLocation.leakData.coordinate.latitude+", "+l.suspectLocation.leakData.coordinate.longitude),1),e[70]||(e[70]=t("br",null,null,-1)),e[71]||(e[71]=c(" DMS: ")),t("code",null,g(`${Ue(l.suspectLocation.leakData.coordinate.latitude)}, ${Ue(l.suspectLocation.leakData.coordinate.longitude)}`),1),e[72]||(e[72]=t("br",null,null,-1)),i(M,{onClick:b=>Mt(`LATLNG: ${l.suspectLocation.leakData.coordinate.latitude}, ${l.suspectLocation.leakData.coordinate.longitude}
DMS: ${Ue(l.suspectLocation.leakData.coordinate.latitude)}, ${Ue(l.suspectLocation.leakData.coordinate.longitude)}`),style:{"margin-top":"5px"},"bt-disabled":!1,"bt-size":"small"},{default:D(()=>[i(o,{icon:"copy"}),e[68]||(e[68]=c(" Copy Coord "))]),_:2},1032,["onClick"])])):S("",!0)])])])]),l.suspectLocation.leakData.coordinate?S("",!0):(s(),n("p",Kl,[i(o,{icon:"info-circle"}),e[73]||(e[73]=c(" Map view and PU Location data is currently not supported for this line "))])),i(M,{onClick:b=>Ct(l.suspectLocation.leakData.coordinate,l.suspectLocation.leakData.leak_point,l.suspectLocation.leakData.pu_location),"bt-disabled":!l.suspectLocation.leakData.coordinate},{default:D(()=>[i(o,{icon:"map-marker"}),e[74]||(e[74]=c(" Pinpoint on Map"))]),_:2},1032,["onClick","bt-disabled"]),l.suspectLocation.leakData.coordinate?(s(),n("a",{key:1,class:"gmaps",target:"_blank",href:`https://www.google.com/maps?q=${l.suspectLocation.leakData.coordinate.latitude},${l.suspectLocation.leakData.coordinate.longitude}`,style:{"margin-left":"0.5rem"}},"Google Maps",8,Wl)):S("",!0)],64)):(s(),n($,{key:1},[e[76]||(e[76]=t("b",{style:{color:"#555"}},"No leak detected",-1)),t("ol",Hl,[(s(!0),n($,null,j(l.suspectLocation.probabilities,(b,z)=>(s(),n("li",{key:z},g(b),1))),128))])],64))])],64)):(s(),n("h6",Gl,[t("b",null,"Analysis on Dataset "+g(p+1),1),e[78]||(e[78]=t("b",{style:{color:"#555"}},"Tidak ada indikasi",-1)),t("ol",Ql,[(s(!0),n($,null,j(l.suspectLocation.probabilities,(b,z)=>(s(),n("li",{key:z},g(b),1))),128))])]))]))),128)):(s(),re(Bt,{key:1,message:"Calculating leak probabilities..."}))],4),Se.value?(s(),n("div",{key:0,class:"l-right",style:Y({width:Se.value?"60%":"100%",position:"relative"})},[e[81]||(e[81]=t("h4",{style:{"font-weight":"bold"}},"Map View",-1)),e[82]||(e[82]=t("hr",null,null,-1)),i(Ut,{latitude:Ie.value.latitude,longitude:Ie.value.longitude,"leak-point":dt.value,"pu-location":pt.value},null,8,["latitude","longitude","leak-point","pu-location"])],4)):S("",!0)],2)])):S("",!0),me.value?(s(),n("div",Jl,[t("div",Xl,[e[85]||(e[85]=t("h5",null,[t("b",null,"Prediction Mode Preferences")],-1)),e[86]||(e[86]=t("hr",null,null,-1)),i(fe,{"in-label":"Dot Symbol Size","model-value":G.value,"onUpdate:modelValue":e[22]||(e[22]=l=>G.value=l),"in-type":"number"},null,8,["model-value"]),t("label",Zl,[Ee(t("input",{type:"checkbox","onUpdate:modelValue":e[23]||(e[23]=l=>ve.value=l)},null,512),[[Fe,ve.value]]),e[83]||(e[83]=t("div",{style:{display:"flex","flex-flow":"column","margin-left":"0.7rem"}},[t("span",{style:{"font-size":"13px"}},[t("b",null,"Show all dots")]),t("span",{style:{"font-size":"11px"}},"Show all dots or reduce the dot placement")],-1))]),i(M,{onClick:e[24]||(e[24]=l=>me.value=!me.value),style:{width:"fit-content"},"bt-disabled":!1},{default:D(()=>e[84]||(e[84]=[c("Save Preferences")])),_:1})])])):S("",!0),qe.value?(s(),n("div",ea,[t("div",ta,[e[89]||(e[89]=t("h2",null,[t("b",null,"Snapshot")],-1)),i(fe,{"in-label":"Name","model-value":Le.value,"onUpdate:modelValue":e[25]||(e[25]=l=>Le.value=l),"in-type":"text"},null,8,["model-value"]),i(fe,{"in-label":"Description","model-value":Te.value,"onUpdate:modelValue":e[26]||(e[26]=l=>Te.value=l),"in-type":"text"},null,8,["model-value"]),t("div",la,[i(M,{onClick:Ot,style:{width:"fit-content"},"bt-disabled":!1},{default:D(()=>[i(o,{icon:"save"}),e[87]||(e[87]=c(" Create "))]),_:1}),i(M,{onClick:Pt,style:{width:"fit-content"},"bt-disabled":!1},{default:D(()=>e[88]||(e[88]=[c("Cancel ")])),_:1})])])])):S("",!0),be.value?(s(),n("button",{key:8,type:"button",onClick:e[27]||(e[27]=l=>be.value=!be.value),class:"predict-action-show"},[i(o,{icon:"eye"})])):S("",!0),be.value?S("",!0):(s(),n("button",{key:9,type:"button",onClick:zt,class:"chart-resize"},[i(o,{icon:"left-right"})]))],64)}}}),oa=mt(aa,[["__scopeId","data-v-98552821"]]),sa={class:"row"},na={class:"col-md-3"},ia=["value"],ra={style:{display:"flex","flex-flow":"row nowrap","align-items":"center",gap:"1rem"}},ua={style:{display:"flex","flex-flow":"row nowrap",gap:"1rem","align-items":"center"}},da={class:"col-md-12",style:{position:"relative"}},pa={key:0,class:"loaders"},va={key:0,class:"load-window"},ca={class:"load-inner"},fa={style:{display:"flex","flex-flow":"column","align-items":"flex-start",gap:"0.2rem"}},ya={style:{margin:"0",padding:"0"}},ma={style:{"font-size":"9px",color:"red"}},ba={style:{"font-size":"11px","margin-bottom":"1rem"}},ga={style:{display:"flex","flex-flow":"row wrap","font-size":"11px",gap:"0.2rem",border:"1px solid #ccc",width:"100%",padding:"10px","border-radius":"10px"}},ka={style:{color:"#555",padding:"5px",background:"#ddd","border-radius":"5px"}},ha={style:{display:"flex","flex-flow":"row wrap","font-size":"11px",gap:"0.2rem",border:"1px solid #ccc",width:"100%",padding:"10px","border-radius":"10px"}},xa={style:{color:"#555",padding:"10px",background:"#eee","border-radius":"5px","text-align":"center"}},wa={style:{display:"flex","flex-flow":"row wrap","font-size":"12px",background:"#eee",padding:"10px","border-radius":"10px",border:"1px solid #ccc",width:"100%"}},Da={style:{"margin-right":"10px","font-weight":"bold"}},Sa={style:{"font-weight":"bold"}},Ca={style:{"font-weight":"bold"}},Ma={style:{"font-weight":"bold"}},$a={style:{display:"flex","flex-flow":"row nowrap",gap:"0.3rem"}},Pa={key:1,style:{display:"flex","flex-flow":"column","align-items":"center","justify-content":"center",gap:"1rem"}},Oa={style:{"font-size":"30px"}},_a=at({__name:"PlaybackFol",setup(ze){const ue=lt(),K=ft();K.asideToggle(!1);const le=r(ue.getAllTrunk()),A=r("trunk1"),m=r();m.value=Object.keys(le.value);const F=r(5),P=r(),O=r([]),I=r(0),W=r([]),w=r(!1),Z=r(!1),d=r(!1);r(!1);const ae=r(!0),_=r({}),Ce=yt(),ke=()=>{I.value++,O.value.push(null)};ot(()=>{const v=Ce.params.saveid;v?setTimeout(async()=>{const u="https://rtunode.findingoillosses.com/api/v1/getpresetbyid",C={key:v},y=await He.post(u,C),L=y.data.status,V=y.data.data;if(L===200){const T=V;W.value=[],O.value=[];const de=T.dates;I.value=0,F.value=T.timerange,P.value=de[0];for(let R=1;R<de.length;R++)ke();setTimeout(()=>{document.querySelectorAll('input[type="date"]').forEach((R,Ne)=>{R.value=de[Ne],O.value[Ne]=R}),H(),_.value={name:T.name,desc:T.desc,selectedMethod:T.selectedMethod,selectedModel:T.selectedModel,selection:T.selections,seekerValue:T.seekerValue},w.value=!0},100)}else K.notifyShowError("Failed fetching snapshot!")},1e3):(he(),w.value=!0)}),N(()=>[P.value,F.value,A.value],async()=>{_.value={},Z.value=!0,await H()});const he=()=>{const v=new Date,u=v.getFullYear(),C=String(v.getMonth()+1).padStart(2,"0"),y=String(v.getDate()).padStart(2,"0"),L=`${u}-${C}-${y}`;P.value=L},ee=async v=>new Promise(async(u,C)=>{try{const y=le.value[A.value];let L=[];for(let de=0;de<y.spot.length;de++)L.push(y.spot[de].id);const V={datefilter:v,timeFilter:F.value,idFilter:L},T=await He.post(At.baseEnd+"api/History/getsplittedhistdata",V);u(T.data)}catch(y){C(y)}}),H=async()=>{try{d.value=!0;let u=[...await ee(P.value)];if(O.value.length>0){for(let C=0;C<O.value.length;C++){const y=O.value[C];if(y!==null){if(y.value!==P.value){const L=await ee(y.value);u=u.concat(L)}}else console.log("Null")}Z.value=!1}W.value=u,d.value=!1}catch(v){console.log(v),Z.value=!1,d.value=!1}},xe=async()=>new Promise(async(v,u)=>{try{d.value=!0;let y=[...await ee(P.value)];if(O.value.length>0){for(let L=0;L<O.value.length;L++){const V=O.value[L];if(V!==null){if(V.value!==P.value){const T=await ee(V.value);y=y.concat(T)}}else console.log("Null")}Z.value=!1}W.value=y,d.value=!1,v(!0)}catch(C){console.log(C),Z.value=!1,d.value=!1,u(!1)}}),oe=(v,u)=>{O.value[u]=v,H()},we=()=>{I.value>0&&(I.value--,O.value.pop()),H()},Qe=v=>{P.value=v},se=r([]),De=async v=>{J();const u={};u.name=v.name,u.desc=v.desc,u.timerange=F.value,u.selectedModel=v.selectedModel,u.selectedMethod=v.selectedMethod,u.dates=se.value,u.selections=v.selections,u.seekerValue=v.seekerValue,u.context="jamerfol",(await He.post("https://rtunode.findingoillosses.com/api/v1/savepreset",u)).data.status===200?(K.notifyShow("Preset has been saved!"),se.value=[]):(K.notifyShowError("Failed saving preset!"),se.value=[])},J=()=>{if(se.value.push(P.value),O.value.length)for(let v in O.value)se.value.push(O.value[v].value)},q=r([]),k=r(!1),ye=()=>{k.value=!0,me()},me=async()=>{const v={context:"jamerfol"},u=await He.post("https://rtunode.findingoillosses.com/api/v1/getpresets",v);u.data.status===200?q.value=u.data.data:K.notifyShowError("Failed fetching snapshots!")},ve=async v=>{ae.value=!1,W.value=null,O.value=[];const u=v.dates;I.value=0,F.value=v.timerange,P.value=u[0];for(let C=1;C<u.length;C++)ke();G(u).then(async()=>{await xe().then(()=>{_.value={name:v.name,desc:v.desc,selectedMethod:v.selectedMethod,selectedModel:v.selectedModel,selection:v.selections,seekerValue:v.seekerValue},k.value=!1,setTimeout(()=>{ae.value=!0},1e3)})})},G=v=>new Promise((u,C)=>{try{setTimeout(()=>{document.querySelectorAll('input[type="date"]').forEach((y,L)=>{y.value=v[L],O.value[L]=y}),u(!0)},50)}catch(y){C(y)}}),Je=v=>{const u=`https://jamer.findingoillosses.com/fol/playback/${v.key}`;navigator.clipboard.writeText(u).then(()=>{K.notifyShow(`${v.name} -> Link copied. CTRL+V to paste`)}),k.value=!1};return(v,u)=>{const C=Ge("font-awesome-icon");return s(),n($,null,[i(Nt,{"context-title":"Playback"},{default:D(()=>[t("div",sa,[t("div",na,[i(ge,{"in-label":"Select Line","model-value":A.value,"onUpdate:modelValue":u[0]||(u[0]=y=>A.value=y)},{default:D(()=>[(s(!0),n($,null,j(m.value,(y,L)=>(s(),n("option",{key:L,value:y},g(le.value[y].name),9,ia))),128))]),_:1},8,["model-value"]),i(ge,{"in-label":"Time Range","model-value":F.value,"onUpdate:modelValue":u[1]||(u[1]=y=>F.value=y)},{default:D(()=>u[5]||(u[5]=[t("option",{value:"1"},"1 Menit",-1),t("option",{value:"2"},"2 Menit",-1),t("option",{value:"3"},"3 Menit",-1),t("option",{value:"4"},"4 Menit",-1),t("option",{value:"5"},"5 Menit",-1),t("option",{value:"10"},"10 Menit",-1),t("option",{value:"15"},"15 Menit",-1),t("option",{value:"30"},"30 Menit",-1),t("option",{value:"60"},"60 Menit",-1)])),_:1},8,["model-value"]),t("div",ra,[i(fe,{"in-type":"date","in-label":"Date Filter","model-value":P.value,"onUpdate:modelValue":u[2]||(u[2]=y=>P.value=y),style:{width:"100%"}},null,8,["model-value"])]),t("div",ua,[i(M,{onClick:we,"bt-size":"small","bt-type":"button","bt-disabled":!1},{default:D(()=>[i(C,{icon:"minus"})]),_:1}),t("span",{class:X([`${x(K).textTheme}`])},g(I.value),3),i(M,{onClick:ke,"bt-size":"small","bt-type":"button","bt-disabled":!1},{default:D(()=>[i(C,{icon:"plus"})]),_:1})]),(s(!0),n($,null,j(I.value,(y,L)=>(s(),n("div",{key:L,style:{display:"flex","flex-flow":"row nowrap","align-items":"center",gap:"1rem"}},[i(fe,{"in-type":"date","in-label":`Date Filter ${y}`,onOnValueChange:V=>oe(V,L),style:{width:"100%"}},null,8,["in-label","onOnValueChange"])]))),128))]),t("div",da,[d.value&&w.value?(s(),n("div",pa,u[6]||(u[6]=[t("img",{src:"https://cdn.dribbble.com/users/1138184/screenshots/3796132/oil.gif",style:{width:"350px",height:"350px","object-fit":"contain","border-radius":"20px"}},null,-1)]))):S("",!0),W.value&&ae.value?(s(),re(oa,{key:1,"snap-shots":_.value,onOnDataSave:De,onOnLoadPreset:ye,"init-date-filter":P.value,"selected-spot":A.value,"init-playback-datas":W.value,onOnDateChange:Qe},null,8,["snap-shots","init-date-filter","selected-spot","init-playback-datas"])):S("",!0)])])]),_:1}),k.value?(s(),n("div",va,[t("div",ca,[t("button",{type:"button",class:"load-dismiss",onClick:u[3]||(u[3]=y=>k.value=!k.value)},[i(C,{icon:"times"})]),q.value.length>0?(s(),n($,{key:0},[u[12]||(u[12]=t("h2",{style:{"padding-left":"1rem"}},[t("b",null,"Saved Snapshots")],-1)),(s(!0),n($,null,j(q.value,(y,L)=>(s(),n("div",{class:"preset-item",key:L},[t("div",fa,[t("h5",ya,[t("b",null,[c(g(y.name)+" ",1),t("sup",ma,[t("b",null,"#"+g(y.key),1)])])]),t("div",ba,[u[7]||(u[7]=c("Description: ")),t("b",null,g(y.desc),1)]),t("div",ga,[(s(!0),n($,null,j(y.dates,(V,T)=>(s(),n("div",{key:T,style:{"font-weight":"bold"}},[t("div",ka,[t("b",null,[i(C,{icon:"calendar"}),c(" "+g(V),1)])])]))),128))]),t("div",ha,[(s(!0),n($,null,j(y.selections,(V,T)=>(s(),n("div",{key:T,style:{"font-weight":"bold",width:"150px"}},[t("div",xa,[t("b",{style:Y({color:`${V.type=="drop"?"red":"green"}`})},g(`${V.name}: (${V.timerange})`),5)])]))),128))]),t("div",wa,[t("span",Da,[u[8]||(u[8]=c("Pick: ")),t("code",Sa,g(y.selectedModel),1)]),t("span",Ca,[u[9]||(u[9]=c("Prediction: ")),t("code",Ma,g(y.selectedMethod),1)])]),t("div",$a,[i(M,{"bt-disabled":!1,"bt-size":"small","bt-type":"button",onClick:V=>ve(y),style:{"margin-top":"1rem"}},{default:D(()=>[i(C,{icon:"plus"}),c(" Import "+g(y.name),1)]),_:2},1032,["onClick"]),i(M,{"bt-disabled":!1,"bt-size":"small","bt-type":"button",onClick:V=>Je(y),style:{"margin-top":"1rem"}},{default:D(()=>[i(C,{icon:"copy"}),u[10]||(u[10]=c(" Copy Share Link "))]),_:2},1032,["onClick"]),i(M,{"bt-disabled":!1,"bt-size":"small","bt-type":"button",onClick:u[4]||(u[4]=V=>k.value=!k.value),style:{"margin-top":"1rem",background:"red"}},{default:D(()=>[i(C,{icon:"trash"}),u[11]||(u[11]=c(" Delete "))]),_:1})])])]))),128))],64)):(s(),n("div",Pa,[t("span",Oa,[i(C,{icon:"inbox"})]),u[13]||(u[13]=t("h5",{style:{padding:"0",margin:"0"}},"No Snapshot(s) Found!",-1)),u[14]||(u[14]=t("p",{style:{padding:"0",margin:"0","text-align":"center"}},[c("To add a new Snapshot, select Normal & Drop(s) on active Leak Detection chart and click "),t("b",null,"Create Snapshot")],-1))]))])])):S("",!0)],64)}}}),Ia=mt(_a,[["__scopeId","data-v-1d466ca7"]]);export{Ia as default};
