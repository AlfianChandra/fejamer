import{_ as O}from"./MainWrapperView.vue_vue_type_style_index_0_lang-BRLEboC9.js";import{u as N}from"./theme-CtTJxO7h.js";import{_ as E}from"./SelectView.vue_vue_type_style_index_0_lang-Dtw0SieO.js";import{t as P}from"./trunk-DoavT4Nh.js";import{d as h,h as a,i as k,m as R,j as S,r as $,o as r,c,e,t as n,a as d,p as i,u as w,_ as M,k as j,L as A,b as B,w as T,y as x,F as I}from"./index-BLhB0yuf.js";import{a as V}from"./axios-BimPEqV4.js";import{h as _}from"./moment-C5S46NFB.js";const C={class:"dev-wrapper"},G={class:"device-reading"},L={style:{"margin-top":"1.5rem"},class:"info-sums"},U={style:{"text-align":"left"}},q={style:{"padding-left":"5px"}},F={key:0,style:{"text-align":"right"}},H={style:{color:"green","font-weight":"bold"}},Y={key:1,style:{"text-align":"right"}},K={style:{color:"orange","font-weight":"bold"}},z={key:2,style:{"text-align":"right"}},J={style:{color:"red","font-weight":"bold"}},Q=h({__name:"DeviceInfo",props:{idSpot:{type:Object,required:!0},spotData:{type:Object,required:!0}},setup(D){const s=a({}),v=a(null),p=a(20),b=a(8e3),m=D;k(()=>{g()}),v.value=setInterval(()=>{g()},b);const g=async()=>new Promise(async(f,t)=>{try{const o={id:m.idSpot+""},y=(await V.post(R.baseEnd+"api/Device/getdevicedata",o)).data;s.value=y}catch(o){t(o)}}),l=()=>{const f=_(s.value.time);let o=_().diff(f,"seconds");return o<0&&(o=0),o>60?{active:o<p.value,diff:Math.floor(o/60),diffType:"minutes"}:o>3600?{active:o<p.value,diff:Math.floor(o/3600),diffType:"minutes"}:{active:o<p.value,diff:o,diffType:"seconds"}};return S(()=>{clearInterval(v.value),v.value=null}),(f,t)=>{const o=$("font-awesome-icon");return r(),c("div",C,[e("h5",null,[e("b",null,n(m.spotData.name),1)]),t[9]||(t[9]=e("img",{src:"https://cdn-icons-png.flaticon.com/512/11330/11330463.png",style:{"margin-top":"1rem",width:"80px",height:"80px","object-fit":"cover","border-radius":"100px"}},null,-1)),e("div",G,[e("div",null,[e("label",null,[d(o,{icon:"gauge"})]),e("span",null,n(s.value.pressure)+" PSI",1)]),e("div",null,[e("label",null,[d(o,{icon:"car-battery"})]),e("span",null,n(s.value.battery)+"%",1)]),e("div",null,[e("label",null,[d(o,{icon:"wifi"})]),e("span",null,n(s.value.signal),1)])]),e("div",L,[e("div",U,[t[1]||(t[1]=e("label",null,"Last Update ",-1)),e("span",q,[i(n(w(_)(s.value.time).fromNow()),1),t[0]||(t[0]=e("br",null,null,-1)),i(n(w(_)(s.value.time).format("( ddd, DD MMM YY HH:mm:ss )")),1)])]),e("div",null,[l().active&&l().diff<10?(r(),c("div",F,[d(o,{icon:"circle",style:{color:"green"}}),t[4]||(t[4]=i()),e("span",H,[t[2]||(t[2]=i("Device Active ")),t[3]||(t[3]=e("br",null,null,-1)),i("("+n(l().diff)+" "+n(l().diffType)+" response gap)",1)])])):l().active&&l().diff>=p.value/2?(r(),c("div",Y,[d(o,{icon:"circle",style:{color:"orange"}}),t[7]||(t[7]=i()),e("span",K,[t[5]||(t[5]=i("Device Active ")),t[6]||(t[6]=e("br",null,null,-1)),i("("+n(l().diff)+" "+n(l().diffType)+" response gap - slow)",1)])])):(r(),c("div",z,[d(o,{icon:"circle",style:{color:"red"}}),t[8]||(t[8]=i()),e("span",J,"Trouble reading... ("+n(l().diff)+")",1)]))])]),t[10]||(t[10]=e("div",{style:{"margin-top":"1rem"}},[e("h4",{style:{"text-align":"left"}},[e("b",null,"Battery Stats")])],-1))])}}}),W=M(Q,[["__scopeId","data-v-a90f5588"]]),X={class:"col-md-3"},Z=["value"],ee={class:"device-display"},te=h({__name:"DeviceMonitoring",setup(D){const s=a(null),v=a(!1),p=a(1e3),b=N(),m=a(P().getAllTrunk()),g=a("trunk1"),l=a(Object.keys(m.value)),f=a([]);return b.asideToggle(!0),k(()=>{v.value=!0}),j(()=>v.value,t=>{t?(console.log("MONITORING STARTED"),s.value=setInterval(()=>{},p.value)):(console.log("MONITORING STOPPED"),clearInterval(s.value))}),S(()=>{v.value=!1,s.value&&(clearInterval(s.value),s.value=null),console.log("MONITORING STOPPED")}),A(()=>{l.value&&(f.value=m.value[g.value].spot,console.log(f.value))}),(t,o)=>(r(),B(O,{"context-title":"Device Monitoring"},{default:T(()=>[e("div",X,[d(E,{"in-label":"Installed Device","model-value":g.value,"onUpdate:modelValue":o[0]||(o[0]=u=>g.value=u)},{default:T(()=>[(r(!0),c(I,null,x(l.value,(u,y)=>(r(),c("option",{key:y,value:u},n(m.value[u].name),9,Z))),128))]),_:1},8,["model-value"])]),e("div",ee,[(r(!0),c(I,null,x(f.value,(u,y)=>(r(),c("div",{class:"device-items",key:y},[d(W,{idSpot:u.id,"spot-data":u},null,8,["idSpot","spot-data"])]))),128))])]),_:1}))}}),ue=M(te,[["__scopeId","data-v-710f48bc"]]);export{ue as default};
