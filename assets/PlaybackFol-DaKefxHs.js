import{u as yt}from"./theme-BXCADLRF.js";import{_ as At}from"./MainWrapperView.vue_vue_type_style_index_0_lang-Cz8XsXBD.js";import{_ as De}from"./SelectView.vue_vue_type_style_index_0_lang-BhZuLC4p.js";import{_ as ye}from"./InputView.vue_vue_type_style_index_0_lang-CSapKU24.js";import{_ as $}from"./ButtonView.vue_vue_type_style_index_0_computed_true_lang-BHaR68_I.js";import{t as st}from"./trunk-DoavT4Nh.js";import{d as Xe,h as u,B as Ft,i as nt,L as Je,r as Ie,o as a,c as n,a as i,w,b as X,l as M,g as mt,k as I,e as t,p,n as te,u as f,x as Re,K as je,t as y,f as K,F as O,y as B,_ as it,M as Nt,m as Rt}from"./index-abuGOtBY.js";import{a as Qe}from"./axios-BimPEqV4.js";import{i as jt}from"./index-CehbAW_K.js";import{h as P}from"./moment-C5S46NFB.js";import{_ as It,m as Ut,a as qt,u as Kt,L as Bt}from"./LoadingView-CwL8Vwir.js";const Wt={style:{width:"100%",display:"flex","flex-flow":"column"}},Ht=Xe({__name:"PressureDistView",props:{selectedSpot:{type:String,required:!0},data:{type:Object,required:!0},leakPointResult:Object},setup(Se){const le=u(!1),Y=Se,E=Ft(()=>Y.data),j=u(st().getAllTrunk()),m=u({}),A=u(Y.selectedSpot),L=()=>j.value[A.value].trunkLength,b=u(0),T=_=>{b.value=_};return nt(()=>{le.value=!0,m.value=E.value,le.value=!1}),Je(()=>{le.value=!0,m.value=E.value,le.value=!1}),(_,D)=>{const ae=Ie("center");return a(),n("div",Wt,[i(ae,null,{default:w(()=>[i(ye,{"in-label":"Drop Tolerance Value","in-type":"number","model-value":b.value,"onUpdate:modelValue":D[0]||(D[0]=v=>b.value=v),style:{width:"200px"}},null,8,["model-value"])]),_:1}),!le.value&&Object.keys(m.value).length?(a(),X(It,{key:0,onOnToleranceChanged:T,"chart-data":m.value,"selected-spot":A.value,"trunk-length":L(),"tolerance-value":b.value,"prediction-result":Y.leakPointResult},null,8,["chart-data","selected-spot","trunk-length","tolerance-value","prediction-result"])):M("",!0)])}}}),Gt={key:0,class:"datepickdialog"},Qt={class:"datepickinner"},Jt={style:{display:"flex","flex-flow":"row nowrap",gap:"0.2rem"}},Xt={key:1,class:"selfnavdialog"},Zt={class:"selfnavdialog-inner"},el={style:{display:"flex","flex-flow":"row nowrap","justify-content":"center","margin-bottom":"1rem",gap:"1rem"}},tl={style:{display:"flex","flex-flow":"row nowrap",gap:"0.5rem","justify-content":"space-between"}},ll={style:{display:"flex","flex-flow":"row nowrap",gap:"0.3rem"}},al={style:{display:"flex","flex-flow":"row nowrap",gap:"0.3rem",height:"45px","align-items":"center"}},ol={style:{"border-radius":"10px",display:"flex","flex-flow":"row nowrap","justify-content":"space-between","padding-left":"10px","padding-right":"10px",border:"1px solid #ccc",padding:"20px","margin-bottom":"1rem"}},sl={style:{border:"1px solid #ccc",padding:"5px","padding-left":"70px","text-align":"center","padding-right":"70px","border-radius":"100px"}},nl={key:0,style:{"font-size":"11px"}},il={key:0,style:{"font-size":"11px"}},rl={key:1,style:{"font-size":"11px"}},ul={style:{display:"flex","flex-flow":"row nowrap",width:"100%","align-items":"center","margin-top":"-40px"}},dl={style:{display:"flex","flex-flow":"no wrap",padding:"10px",gap:"0.5rem"}},pl={style:{width:"100%",padding:"10px",position:"relative"}},vl=["max","value"],cl={key:0,class:"sel-wrapper"},fl={style:{display:"flex","justify-content":"flex-start","overflow-x":"auto","white-space":"nowrap",padding:"20px",gap:"1rem",width:"40%"}},yl=["onClick"],ml={key:0,class:"dataspan"},bl={style:{width:"50%"}},gl={style:{color:"#fff",background:"red",width:"70px",padding:"5px","border-radius":"5px","font-size":"10px","text-align":"center"}},kl={style:{width:"60%","padding-right":"5rem","padding-top":"1rem","padding-bottom":"1rem"}},hl=["src"],wl={class:"table-responsive"},xl={style:{"margin-top":"1rem"}},Dl={class:"tbl2"},Sl={style:{"margin-top":"1rem"}},Ml={class:"tbl2"},Cl={key:0,style:{color:"red","text-shadow":"0.5px 0.5px 1px rgba(0,0,0,0.6)"}},$l={key:1,style:{color:"orange","text-shadow":"0.5px 0.5px 1px rgba(0,0,0,0.6)"}},_l={key:2,style:{color:"yellow","text-shadow":"0.5px 0.5px 1px rgba(0,0,0,0.6)"}},Pl={key:3,style:{color:"lime","text-shadow":"0.5px 0.5px 1px rgba(0,0,0,0.6)"}},Yl={key:4},Ol={key:2,class:"hmloader"},Ll={key:3,class:"model-window"},Tl={class:"modelpick-inner"},Vl={key:4,class:"predict-action"},zl={style:{"margin-bottom":"0.1rem"}},El={style:{"margin-bottom":"0.5rem"}},Al={style:{display:"flex","flex-flow":"row nowrap",gap:"0.5rem"}},Fl={key:5,class:"leak-window"},Nl={style:{color:"rgb(0,150,255)"}},Rl={class:"table-responsive"},jl={style:{width:"100%","margin-top":"1rem"},class:"table table-striped table-hover;"},Il={key:0,style:{border:"1px solid #ccc",padding:"10px"}},Ul={key:1,style:{border:"1px solid #ccc",padding:"10px"}},ql={style:{"font-weight":"bold",border:"1px solid #ccc",padding:"10px"}},Kl={key:0,style:{"font-weight":"bold",border:"1px solid #ccc",padding:"10px"}},Bl={key:1,style:{"font-weight":"bold",border:"1px solid #ccc",padding:"10px"}},Wl={key:0},Hl=["href"],Gl={style:{"margin-top":"1rem"}},Ql={key:1},Jl={style:{"margin-top":"1rem"}},Xl={key:6,class:"setting-window"},Zl={class:"setting-inner"},ea={class:"pref-block"},ta={key:7,class:"save-window"},la={class:"save-inner"},aa={style:{display:"flex","flex-flow":"row nowrap",gap:"0.5rem"}},oa=Xe({__name:"PlaybackView",props:{initDateFilter:{type:String,required:!0},selectedSpot:{type:String,required:!0},initPlaybackDatas:{type:Array,required:!0},snapShots:{type:Object,required:!1,default:null},mainSize:{type:Object,required:!1}},emits:["onDateChange","onDataSave","onLoadPreset"],setup(Se,{emit:le}){const Y=Kt(),E=st(),j=le,m=yt(),A=u("forward"),L=u(!1),b=u(""),T=u(!0),_=u(!1),D=Se,ae=u(),v=u(),ne=u(E.getAllTrunk()),V=u(0),Ye=u(0),me=u([]),Me=u(!1),oe=u(250);let W=null;const Ce=u(!1);let ie=[];const $e={},Ze=u(),re=u(""),_e=u(""),Z=u(!0),H=u(!1),x=u(!1),be=u(!1),ge=u(!1),ve=u(!1),Q=u(7),et=mt();u(et.params.saveid);let U=u({}),ke=null;const he=u(null),Oe=u({}),tt=()=>{v.value=jt(ae.value);const s={grid:{top:"10%",left:"10%",right:"10%",bottom:"15%"},legend:{show:!0,type:"scroll",orient:"horizontal"},tooltip:{trigger:"item",triggerOn:"mousemove",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},axisPointer:{show:!0,type:"shadow"},xAxis:[{type:"category",data:[],boundaryGap:!1,splitNumber:1,minInterval:1,scale:!0,axisLabel:{formatter:function(e){return e.split(" (")[1].split(")")[0]},rotate:45,labelStyle:{fontSize:10}},splitLine:{show:!0,lineStyle:{type:"dashed"}},axisTick:{alignWithLabel:!0}}],yAxis:{type:"value",name:"Pressure (PSI)",nameGap:10,max:200,interval:20,axisTick:{show:!0,inside:!0},splitLine:{show:!0,lineStyle:{type:"solid",color:"#999"}},minorTick:{show:!0},minorSplitLine:{show:!0,lineStyle:{type:"dashed",color:"#ccc"}}},series:[]};v.value.setOption(s),setTimeout(()=>{v.value.dispatchAction({type:"legendInverseSelect"}),v.value.dispatchAction({type:"legendAllSelect"}),v.value.resize()},100)},g=()=>{const s=P().format("YYYY-MM-DD"),e=P(D.initDateFilter).format("YYYY-MM-DD");Ce.value=s===e};nt(()=>{window.addEventListener("keyup",kt),g()}),I(()=>ae.value,()=>{tt(),r(V.value)}),I(()=>D.initPlaybackDatas,(s,e)=>{!s||s.length===0||(g(),c(),r(V.value),Me.value=!1,H.value&&(x.value=!0))});const r=s=>{ie=[];for(let l of ne.value[D.selectedSpot].spot)$e[l.name]=[];D.initPlaybackDatas.slice(0,s+1).forEach((l,d)=>{const h=`${l.dateFilter} (${l.timeRange})`;ie.push(h),Ze.value=h,l.data.forEach(q=>{const We=ne.value[D.selectedSpot].spot.find(Ge=>Ge.id===q.idSpot).name,He=q.avgPsiValues??0;$e[We][d]=Number(He.toFixed(2))})});const o=Object.keys($e).map(l=>({name:l,type:"line",data:$e[l],showAllSymbol:ve.value,smooth:!1,tooltip:{trigger:"axis",formatter:function(d){return d[0].value}},endLabel:{show:!0,formatter:function(d){return d.value+" ; "+l},color:"#000",backgroundColor:"inherit",padding:5,fontSize:10,borderRadius:5}}));let k=v.value.getOption();k.xAxis[0].data=ie,k.series=o,v.value.setOption(k)},C=()=>{v.value.getOption()},c=()=>{x.value=!1,V.value=0,me.value=[],clearInterval(W),r(V.value),Ye.value=V.value/D.initPlaybackDatas.length*100},z=s=>{x.value=!1,me.value=[],V.value=parseInt(s.target.value,10),r(V.value),Ye.value=V.value/D.initPlaybackDatas.length*100};I(()=>D.initDateFilter,async()=>{at(),lt(),await Le().then(()=>{F()})});const F=()=>{const s=P(D.initDateFilter),e=s.add(1,"days").format("YYYY-MM-DD"),o=s.subtract(2,"days").format("YYYY-MM-DD");re.value=e,_e.value=o};F();const N=async()=>{at(),await Le().then(()=>{if(Ce.value)m.notifyShowError("End of playback");else{be.value=!0,c();const s=P(re.value).format("YYYY-MM-DD");H.value&&(x.value=!0),Me.value=!0,j("onDateChange",s),setTimeout(()=>{be.value=!1},5e3)}})},ee=async()=>{at(),await Le().then(()=>{be.value=!0,c();const s=P(_e.value).format("YYYY-MM-DD");H.value&&(x.value=!0),Me.value=!0,j("onDateChange",s),setTimeout(()=>{be.value=!1},5e3)})};I(()=>Z.value,()=>{Z.value&&(Ve(),L.value=!1,H.value=!1)}),I(()=>L.value,()=>{L.value?(Z.value=!1,H.value=!0):Z.value=!0}),I(()=>H.value,()=>{H.value&&(Z.value=!1)}),I(()=>x.value,()=>{if(!x.value&&V.value==D.initPlaybackDatas.length)if(Z.value)c(),x.value=!0;else{const s=P().format("YYYY-MM-DD"),e=P(D.initDateFilter).format("YYYY-MM-DD");s===e?x.value=!1:L.value?A.value=="forward"?ue.value?D.initDateFilter!=de.value?N():Ue.value?(c(),j("onDateChange",pe.value)):Ve():N():ue.value?D.initDateFilter!=pe.value?ee():Ue.value?(c(),j("onDateChange",de.value)):Ve():ee():(c(),x.value=!0)}G.value&&R.value?(rt(),ce(),C()):we()});const ce=()=>{if(x.value)we();else{const s=v.value.getOption();s.series.forEach(o=>{o.symbolSize=Q.value}),s.series.forEach(o=>{o.symbol="circle"});const e=v.value.getOption().tooltip;e.show=!0,v.value.setOption(s)}},we=()=>{const s=v.value.getOption();s.series.forEach(e=>{e.symbolSize=0}),s.series.forEach(e=>{e.symbol="none"}),v.value.setOption(s),v.value.off("click")},S=u({}),rt=()=>{v.value.off("click"),v.value.on("click",s=>{if(s.componentType==="markLine"){if(s.seriesName==="Normal"){m.notifyConfirm("Delete Normal","Are you sure?","Delete","Cancel",async()=>{ut()},()=>{});return}else m.notifyConfirm("Delete Marker","Delete this marker?","Delete","Cancel",async()=>{const d=v.value.getOption();d.series=d.series.filter((h,q)=>q!==s.seriesIndex),v.value.clear(),v.value.setOption(d),Object.keys(S.value).forEach(h=>{S.value[h].index===s.value&&delete S.value[h]}),T.value=!1,setTimeout(()=>{T.value=!0},100)},()=>{});return}const e=ie.findIndex(d=>d===s.name);if(e<0)return;if(S.value.normal){const d=Object.keys(S.value).length,h={type:"line",name:`Drop ${d}`,xAxisIndex:0,data:[],markLine:{symbol:"image://https://gpng.net/wp-content/uploads/ROBBER.png",symbolSize:35,data:[{xAxis:e,symbolRotate:180}],lineStyle:{color:"blue",width:2,type:"dotted"},label:{show:!0,formatter:`Drop ${d}`,position:"insideEndTop"}}},q=v.value.getOption().series;q.push(h),v.value.setOption({series:q})}else{const d={type:"line",name:"Normal",xAxisIndex:0,data:[],markLine:{symbol:"image://https://png.pngtree.com/png-clipart/20230325/original/pngtree-petroleum-workers-or-miners-vector-png-image_9004441.png",symbolSize:42,data:[{xAxis:e}],lineStyle:{color:"red",width:2,type:"dotted"},label:{show:!0,formatter:"Normal",position:"insideEndTop"}}},h=v.value.getOption().series;h.push(d),v.value.setOption({series:h})}const l=v.value.getOption().series.filter(d=>Array.isArray(d.data)).map(d=>({seriesName:d.name,yValue:d.data[e]??0}));if(S.value.normal){const d=Object.keys(S.value).length;S.value[`drop${d}`]={index:e,name:`Drop ${d}`,data:l,order:v.value.getOption().series.length-1,type:"drop",timerange:ie[e].split(" (")[1].split(")")[0],seriesName:ie[e].split(" (")[1].split(")")[0]+".drop."+D.initDateFilter,date:D.initDateFilter}}else{const d={normal:{index:e,name:"Normal",data:l,order:0,type:"normal",timerange:ie[e].split(" (")[1].split(")")[0],seriesName:ie[e].split(" (")[1].split(")")[0]+".normal."+D.initDateFilter,date:D.initDateFilter}};S.value={...d,...S.value},he.value=d.normal.seriesName}})},ut=()=>{const s=v.value.getOption();s.series=s.series.filter(e=>e.name!=="Normal"),v.value.clear(),v.value.setOption(s),delete S.value.normal,m.notifyShow("Normal deleted"),he.value=null},Le=()=>new Promise((s,e)=>{try{if(Object.keys(S.value).length===0){s();return}const o=v.value.getOption();o.series=o.series.filter(k=>!k.markLine),v.value.clear(),v.value.setOption(o),S.value={},s()}catch(o){e(o)}});I(()=>[x.value,oe.value],()=>{x.value?(W!=null&&clearInterval(W),W=setInterval(()=>{V.value<D.initPlaybackDatas.length?(V.value++,D.initPlaybackDatas[V.value]!=null&&(r(V.value),Ye.value=V.value/D.initPlaybackDatas.length*100)):(x.value=!1,clearInterval(W))},oe.value)):W&&(clearInterval(W),W=null)}),I(()=>[m.asideVisible],()=>{setTimeout(()=>{v.value.resize()},500)});const Te=u(!1),bt=()=>A.value=="forward"?re.value:_e.value,fe=u(!1),ue=u(!1),Ue=u(!0),pe=u(""),de=u(""),gt=()=>{pe.value?de.value?(ue.value=!0,Z.value=!1,L.value=!0,H.value=!0,fe.value=!1,x.value=!1):m.notifyShowError("Date 2 is required"):m.notifyShowError("Date 1 is required")};I(()=>fe.value,()=>{fe.value?(x.value=!1,ue.value=!1):x.value=!0}),I(()=>[ue.value],()=>{ue.value&&(c(),A.value=="forward"?j("onDateChange",pe.value):j("onDateChange",de.value))}),I(()=>A.value,()=>{A.value=="backward"&&(c(),Ve())});const Ve=()=>{c(),j("onDateChange",D.initDateFilter),ue.value=!1,pe.value=null,de.value=null},kt=s=>{_.value||((s.keyCode==80||s.keyCode==32)&&(x.value=!x.value),s.keyCode==37&&ee(),s.keyCode==39&&N())},ht=(s,e)=>{if(s.type=="normal"){m.notifyConfirm("Delete Normal","Are you sure?","Delete","Cancel",async()=>{ut()},()=>{});return}const o=v.value.getOption();o.series=o.series.filter(k=>k.name!==s.name),v.value.clear(),v.value.setOption(o),delete S.value[e],T.value=!1,setTimeout(()=>{T.value=!0},100)},G=u(null),R=u(null),se=u(!1),ze=u(!1),wt=()=>{ze.value?(se.value=!1,ze.value=!1):(G.value=null,R.value=null,se.value=!1)};I(()=>se.value,()=>{ze.value=!1});const lt=()=>{G.value=null,R.value=null,se.value=!1,we(),Le(),S.value={}};I(()=>[G.value,R.value],()=>{G.value&&R.value?(rt(),ce()):(we(),m.notifyShow("Prediction stopped"))});const xt=()=>{ze.value=!0,se.value=!0},Ee=u(!1),dt=u([]),J=u([]),Pe=u(!1),qe=u(),Dt=u(),St=()=>{if(!G.value||!R.value){m.notifyShowError("Please select model and method");return}m.notifyShow("Prediction started"),se.value=!1;let s={};Object.keys(S.value).forEach(o=>{if(S.value[o].type!=="normal"||S.value[o].type!=="drop"){const k=E.getAllTrunk().trunk1.spot.length;let l={name:S.value[o].name,data:S.value[o].data.map(d=>({avgPsiValues:d.yValue})).slice(0,k),type:S.value[o].type};s[S.value[o].name]=l}}),dt.value=[];const e=Y.mlpredict(s,R.value);if(Ee.value=!0,R.value==="rf_single"?setTimeout(()=>{J.value=e.sort((o,k)=>o.drop-k.drop)},4e3):R.value==="rf4_multi"?setTimeout(()=>{J.value=e.sort((o,k)=>o.drop-k.drop)},4e3):R.value==="lr_single"?setTimeout(()=>{J.value=e.sort((o,k)=>o.drop-k.drop)},4e3):R.value==="dt_single"?setTimeout(()=>{J.value=e.sort((o,k)=>o.drop-k.drop)},4e3):R.value==="dt4_multi"?setTimeout(()=>{J.value=e.sort((o,k)=>o.drop-k.drop)},4e3):R.value==="dynamic"&&setTimeout(()=>{J.value=e.sort((o,k)=>o.drop-k.drop)},4e3),J.value!=null)for(let o=0;o<J.value.length;o++)J.value[o].suspectLocation.leak&&dt.value.push(J.value[o])},pt=u(),vt=u(),Mt=(s,e,o)=>{qe.value=s,Pe.value=!1,Pe.value=!0,pt.value=e,vt.value=o};I(()=>Ee.value,()=>{Ee.value||(Pe.value=!1,J.value=null,qe.value=null,Dt.value=null)});const Ct=async s=>{b.value=s,await navigator.clipboard.writeText(b.value),m.notifyShow("Coordinate copied to clipboard")},Ke=s=>{const e=Math.floor(s),o=Math.abs(s-e)*60,k=Math.floor(o),l=(o-k)*60;return`${e}° ${k}' ${l.toFixed(2)}"`};I(()=>ve.value,()=>{if(ve.value){Q.value=5;const s=v.value.getOption();s.series.forEach(e=>{e.showAllSymbol=!0}),s.series.forEach(e=>{e.symbolSize=Q.value}),v.value.setOption(s)}else{Q.value=7;const s=v.value.getOption();s.series.forEach(e=>{e.showAllSymbol=!1}),s.series.forEach(e=>{e.symbolSize=Q.value}),v.value.setOption(s)}}),I(()=>Q.value,()=>{const s=v.value.getOption();s.series.forEach(e=>{e.symbolSize=Q.value}),v.value.setOption(s)});const at=()=>{Q.value=7,ve.value=!1;const s=v.value.getOption();s.series.forEach(e=>{e.symbolSize=Q.value,e.showAllSymbol=!1}),v.value.setOption(s)},xe=u(!1);I(()=>S.value,()=>{U.value={},Object.keys(S.value).forEach(s=>{const e=S.value[s].seriesName,o=S.value[s].data,l=o.map(d=>{const h=E.getAllTrunk().trunk1.spot.find(q=>q.name===d.seriesName);if(h!==void 0)return h.id}).filter(d=>d!==void 0);U.value[e]===void 0&&(U.value[e]=[]),l.length>0&&(U.value[e]={date:S.value[s].date,timerange:S.value[s].timerange,type:S.value[s].type,data:l.map((d,h)=>({idSpot:d,avgPsiValues:o[h].yValue}))})})},{deep:!0});const ct=(s,e)=>{const k=U.value[s].data;for(let l=0;l<k.length;l++)if(k[l].idSpot==e)return k[l].avgPsiValues.toFixed(2)};Je(()=>{var s;if(U.value!=null&&(ke=Object.keys(U.value),he.value!=null)){Oe.value=[];const e=he.value,o=(s=U.value[e])==null?void 0:s.data;ke.filter(l=>l!==e).forEach(l=>{const d=U.value[l].data,h=[];ne.value.trunk1.spot.forEach((q,We)=>{const He=q.id,Ge=o.find(Ne=>Ne.idSpot===He),ft=d.find(Ne=>Ne.idSpot===He);if(Ge&&ft){const Ne=Ge.avgPsiValues.toFixed(2)-ft.avgPsiValues.toFixed(2);h[We]=Ne}else h[We]=0}),Oe.value.push({dropKey:l,deltas:h})})}});const ot=s=>s.spot,Be=u(!1),Ae=u(""),Fe=u(""),$t=()=>{x.value=!1,Be.value=!0,_.value=!0},_t=()=>{Be.value=!1,_.value=!1},Pt=()=>{if(Ae.value==""||Fe.value==""){m.notifyShowError("Name and description are required");return}m.notifyShow("Saving preset. Please wait..."),Be.value=!1;const s={name:Ae.value,desc:Fe.value,selectedModel:G.value,selectedMethod:R.value,selections:S.value,seekerValue:V.value};j("onDataSave",s),Ae.value="",Fe.value=""},Yt=()=>{j("onLoadPreset")},Ot=()=>{m.notifyShow("Snapshot loaded"),G.value=D.snapShots.selectedModel,R.value=D.snapShots.selectedMethod,setTimeout(()=>{V.value=D.snapShots.seekerValue,setTimeout(()=>{S.value=D.snapShots.selection;const s=v.value.getOption().series;Object.keys(S.value).forEach(o=>{const k=S.value[o];k.type==="normal"?(s.push({type:"line",name:"Normal",xAxisIndex:0,data:[],markLine:{symbol:"image://https://png.pngtree.com/png-clipart/20230325/original/pngtree-petroleum-workers-or-miners-vector-png-image_9004441.png",symbolSize:42,data:[{xAxis:k.index}],lineStyle:{color:"red",width:2,type:"dotted"},label:{show:!0,formatter:"Normal",position:"insideEndTop"}}}),he.value=k.seriesName):s.push({type:"line",name:k.name,xAxisIndex:0,data:[],markLine:{symbol:"image://https://gpng.net/wp-content/uploads/ROBBER.png",symbolSize:35,data:[{xAxis:k.index,symbolRotate:180}],lineStyle:{color:"blue",width:2,type:"dotted"},label:{show:!0,formatter:k.name,position:"insideEndTop"}}})}),v.value.setOption({series:s});const e=v.value.getOption();v.value.clear(),v.value.setOption(e)},1e3),r(V.value)},3e3)};Je(()=>{v.value&&D.snapShots&&Object.keys(D.snapShots).length>0&&Ot()});const Lt=(s,e)=>{let o=!0;return e.forEach(k=>{s<k&&(o=!1)}),o},Tt=(s,e)=>{let o=0;e.forEach(l=>{o<l&&(o=l)});let k=!0;return e.forEach(l=>{s<l&&l<o&&(k=!1)}),k},Vt=(s,e)=>{let o=0;e.forEach(d=>{o<d&&(o=d)});let k=0;e.forEach(d=>{k<d&&d<o&&(k=d)});let l=!0;return e.forEach(d=>{s<d&&d<k&&(l=!1)}),l},zt=(s,e)=>{let o=!0;return e.forEach(k=>{s>k&&(o=!1)}),o},Et=()=>{v.value&&v.value.resize()};return(s,e)=>{const o=Ie("font-awesome-icon"),k=Ie("center");return a(),n(O,null,[fe.value?(a(),n("div",Gt,[t("div",Qt,[e[31]||(e[31]=t("h2",null,[t("b",null,"Select Range")],-1)),e[32]||(e[32]=t("p",{style:{padding:"0",margin:"0"}},"Automatically plays the playback based on current setup",-1)),i(De,{"in-label":"Speed","model-value":oe.value,"onUpdate:modelValue":e[0]||(e[0]=l=>oe.value=l)},{default:w(()=>e[28]||(e[28]=[t("option",{value:"1000"},"Slowest",-1),t("option",{value:"500"},"Slower",-1),t("option",{value:"300"},"Moderate",-1),t("option",{value:"250"},"Faster",-1),t("option",{value:"200"},"Fastest",-1)])),_:1},8,["model-value"]),i(ye,{"in-type":"date","in-label":"Date 1","model-value":pe.value,"onUpdate:modelValue":e[1]||(e[1]=l=>pe.value=l)},null,8,["model-value"]),i(ye,{"in-type":"date","in-label":"Date 2","model-value":de.value,"onUpdate:modelValue":e[2]||(e[2]=l=>de.value=l)},null,8,["model-value"]),t("div",Jt,[i($,{onClick:gt,"bt-disabled":!1,style:{width:"fit-content"}},{default:w(()=>e[29]||(e[29]=[p("Apply Filter")])),_:1}),i($,{onClick:e[3]||(e[3]=l=>fe.value=!fe.value),"bt-disabled":!1,style:{width:"fit-content"}},{default:w(()=>e[30]||(e[30]=[p("Cancel ")])),_:1})])])])):M("",!0),Te.value?(a(),n("div",Xt,[t("div",Zt,[e[35]||(e[35]=t("h2",null,[t("b",null,"Select Preference")],-1)),i(De,{"in-label":"Select","model-value":A.value,"onUpdate:modelValue":e[4]||(e[4]=l=>A.value=l)},{default:w(()=>e[33]||(e[33]=[t("option",{value:"forward"},"Forward",-1),t("option",{value:"backward"},"Backward",-1)])),_:1},8,["model-value"]),i($,{onClick:e[5]||(e[5]=l=>Te.value=!Te.value),style:{width:"fit-content"},"bt-disabled":!1},{default:w(()=>[i(o,{icon:"save"}),e[34]||(e[34]=p(" Save & Apply"))]),_:1})])])):M("",!0),e[90]||(e[90]=t("h5",{style:{"text-align":"center"}},[t("b",null,"Playback")],-1)),i(k,null,{default:w(()=>[i(De,{style:{width:"400px"},"in-label":"Speed","model-value":oe.value,"onUpdate:modelValue":e[6]||(e[6]=l=>oe.value=l)},{default:w(()=>e[36]||(e[36]=[t("option",{value:"1000"},"Slowest",-1),t("option",{value:"500"},"Slower",-1),t("option",{value:"300"},"Moderate",-1),t("option",{value:"250"},"Faster",-1),t("option",{value:"200"},"Fastest",-1)])),_:1},8,["model-value"])]),_:1}),t("div",el,[!x.value&&!R.value&&!G.value?(a(),X($,{key:0,onClick:e[7]||(e[7]=l=>se.value=!se.value),"bt-disabled":!1},{default:w(()=>[i(o,{icon:"atom"}),e[37]||(e[37]=p(" Leak Detection"))]),_:1})):M("",!0),x.value?M("",!0):(a(),X($,{key:1,onClick:Yt,"bt-disabled":!1},{default:w(()=>[i(o,{icon:"download"}),e[38]||(e[38]=p(" Import Snapshot "))]),_:1})),R.value&&G.value?(a(),X($,{key:2,onClick:e[8]||(e[8]=l=>ge.value=!ge.value),"bt-disabled":!1},{default:w(()=>[i(o,{icon:"sliders"}),e[39]||(e[39]=p(" Settings "))]),_:1})):M("",!0),R.value&&G.value?(a(),X($,{key:3,style:{background:"red"},onClick:lt,"bt-disabled":!1},{default:w(()=>[i(o,{icon:"close"}),e[40]||(e[40]=p(" Quit Prediction"))]),_:1})):M("",!0)]),t("div",tl,[t("div",ll,[t("label",{class:te([`${f(m).textTheme}`]),style:{cursor:"pointer",padding:"10px",border:"1px solid #ccc","margin-bottom":"1rem","border-radius":"10px"}},[Re(t("input",{"onUpdate:modelValue":e[9]||(e[9]=l=>Z.value=l),type:"checkbox"},null,512),[[je,Z.value]]),e[41]||(e[41]=p(" Auto-replay "))],2),t("label",{class:te([`${f(m).textTheme}`]),style:{cursor:"pointer",padding:"10px",border:"1px solid #ccc","margin-bottom":"1rem","border-radius":"10px"}},[Re(t("input",{"onUpdate:modelValue":e[10]||(e[10]=l=>H.value=l),type:"checkbox"},null,512),[[je,H.value]]),e[42]||(e[42]=p(" Autoplay on navigating "))],2),t("label",{class:te([`${f(m).textTheme}`]),style:{cursor:"pointer",padding:"10px",border:"1px solid #ccc","margin-bottom":"1rem","border-radius":"10px"}},[Re(t("input",{"onUpdate:modelValue":e[11]||(e[11]=l=>L.value=l),type:"checkbox"},null,512),[[je,L.value]]),e[43]||(e[43]=p(" Self Navigate "))],2),L.value?(a(),X($,{key:0,onClick:e[12]||(e[12]=l=>Te.value=!Te.value),"bt-disabled":!1,type:"button",class:"slfnavbtn"},{default:w(()=>[i(o,{icon:"sliders"})]),_:1})):M("",!0)]),t("div",al,[ue.value?(a(),n("label",{key:0,class:te([`${f(m).textTheme}`]),style:{border:"1px solid #ccc",padding:"10px","border-radius":"10px"}},[p(y(f(P)(pe.value).format("ddd, DD MMM YY"))+"    ",1),i(o,{icon:A.value=="forward"?"caret-right":"caret-left"},null,8,["icon"]),p("    "+y(f(P)(de.value).format("ddd, DD MMM YY")),1)],2)):M("",!0),ue.value?(a(),n("label",{key:1,class:te([`${f(m).textTheme}`]),style:{cursor:"pointer",padding:"10px",border:"1px solid #ccc","border-radius":"10px"}},[Re(t("input",{"onUpdate:modelValue":e[13]||(e[13]=l=>Ue.value=l),type:"checkbox"},null,512),[[je,Ue.value]]),e[44]||(e[44]=p(" Repeat "))],2)):M("",!0),i($,{onClick:e[14]||(e[14]=l=>fe.value=!fe.value),"bt-disabled":!1,type:"button",class:"slfnavbtn"},{default:w(()=>[i(o,{icon:"calendar"})]),_:1}),pe.value&&de.value?(a(),X($,{key:2,onClick:Ve,"bt-disabled":!1,class:"slfnavbtn"},{default:w(()=>[i(o,{icon:"close"})]),_:1})):M("",!0)])]),t("div",ol,[i($,{"bt-disabled":be.value,onClick:ee},{default:w(()=>[i(o,{icon:"backward"}),p("    "+y(f(P)(_e.value).format("ddd, DD MMM YY")),1)]),_:1},8,["bt-disabled"]),t("span",sl,[t("b",{style:K({color:`${f(m).accentColor}`})},y(f(P)(D.initDateFilter).format("ddd, DD MMM YY")),5),e[48]||(e[48]=t("br",null,null,-1)),ue.value?(a(),n("span",{key:0,class:te([`${f(m).textTheme}`]),style:{"font-size":"11px"}},[e[45]||(e[45]=p("Stops at: ")),t("b",null,y(f(P)(de.value).format("ddd, DD MMM YY")),1)],2)):(a(),n(O,{key:1},[Z.value?(a(),n("span",nl,[e[46]||(e[46]=p("Repeating: ")),t("b",null,y(f(P)(D.initDateFilter).format("ddd, DD MMM YY")),1)])):(a(),n(O,{key:1},[Ce.value?(a(),n("span",rl,"[End of playback  ·  Autoplay stopped]")):(a(),n("span",il,[e[47]||(e[47]=p("Upcoming: ")),t("b",null,y(f(P)(bt()).format("ddd, DD MMM YY")),1)]))],64))],64))]),i($,{"bt-disabled":Ce.value,onClick:N},{default:w(()=>[p(y(f(P)(re.value).format("ddd, DD MMM YY"))+"    ",1),i(o,{icon:"forward"})]),_:1},8,["bt-disabled"])]),t("div",{style:K([{position:"relative",width:"100%"},{marginBottom:Object.keys(S.value).length>1?"8rem":"0"}])},[t("div",{ref_key:"heatMap",ref:ae,style:{width:"100%",height:"600px"}},null,512),t("div",ul,[t("div",dl,[x.value?M("",!0):(a(),n("button",{key:0,style:{"z-index":"1",position:"relative"},onClick:e[15]||(e[15]=l=>x.value=!x.value),class:"controlbtn",type:"button"},[i(o,{icon:"play"})])),x.value?(a(),n("button",{key:1,style:{"z-index":"1",position:"relative"},onClick:e[16]||(e[16]=l=>x.value=!x.value),class:"controlbtn",type:"button"},[i(o,{icon:"pause"})])):M("",!0)]),t("div",pl,[t("input",{onChange:z,type:"range",min:0,max:D.initPlaybackDatas.length,value:V.value,class:"slider"},null,40,vl)]),t("div",null,[!x.value&&V.value==D.initPlaybackDatas.length?(a(),n("button",{key:0,onClick:c,class:"controlbtn",type:"button"},[i(o,{icon:"undo"})])):M("",!0)])]),Object.keys(S.value).length?(a(),n("div",cl,[t("div",fl,[(a(!0),n(O,null,B(S.value,(l,d)=>(a(),n("div",{key:d,class:"selection-item",onClick:h=>ht(l,d)},[t("h5",{style:K({color:l.type=="normal"?"red":"blue"})},[t("b",null,y(l.name),1)],4),(a(!0),n(O,null,B(l.data,h=>(a(),n("div",{key:h.seriesName},[h.seriesName!="Normal"&&!h.seriesName.includes("Drop")?(a(),n("span",ml,[t("span",bl,y(h.seriesName),1),e[49]||(e[49]=p()),t("span",gl,[t("b",null,y(h.yValue)+" PSI",1)])])):M("",!0)]))),128))],8,yl))),128))]),t("div",kl,[e[54]||(e[54]=t("h4",{style:{"text-align":"center"}},[t("b",null,"Pressure Distribution")],-1)),T.value?(a(),X(Ht,{key:0,style:{width:"100%"},data:f(U),"selected-spot":"trunk1"},null,8,["data"])):M("",!0),t("img",{src:f(Ut),alt:"map",style:{width:"100%",height:"600px","border-radius":"10px","object-fit":"contain"}},null,8,hl),t("div",wl,[t("h5",xl,[t("b",null,[i(o,{icon:"oil-well"}),e[50]||(e[50]=p(" Selected Pressures"))])]),t("table",Dl,[t("thead",null,[t("tr",{style:{padding:"5px"},class:te([`${f(m).textTheme}`])},[t("th",{style:K({border:`1px solid ${f(m).accentColor}`})},"ACTION",4),t("th",{style:K({border:`1px solid ${f(m).accentColor}`})},"PINNED SERIES",4),(a(!0),n(O,null,B(ot(ne.value.trunk1),(l,d)=>(a(),n("th",{style:K({border:`1px solid ${f(m).accentColor}`}),key:d},y(l.name),5))),128))],2)]),t("tbody",null,[(a(!0),n(O,null,B(f(ke),(l,d)=>(a(),n("tr",{key:d},[t("td",{style:K({border:`1px solid ${f(m).accentColor}`,position:"relative",textTransform:"uppercase",fontWeight:"bold"})},null,4),t("td",{class:te([`${f(m).textTheme}`]),style:K({border:`1px solid ${f(m).accentColor}`,position:"relative",textTransform:"uppercase",fontWeight:"bold"})},[p(y(f(U)[l].date),1),e[51]||(e[51]=t("br",null,null,-1)),p(" "+y(f(U)[l].timerange),1),e[52]||(e[52]=t("br",null,null,-1)),p(" "+y(f(U)[l].type),1)],6),(a(!0),n(O,null,B(ot(ne.value.trunk1),(h,q)=>(a(),n("td",{style:K({border:`1px solid ${f(m).accentColor}`}),class:te([`${f(m).textTheme}`]),key:q},[ct(l,h.id)?(a(),n(O,{key:0},[p(y(ct(l,h.id)),1)],64)):(a(),n(O,{key:1},[p("0.00")],64))],6))),128))]))),128))])]),t("h5",Sl,[t("b",null,[i(o,{icon:"turn-down"}),e[53]||(e[53]=p(" Delta"))])]),t("table",Ml,[t("thead",null,[t("tr",{style:{padding:"5px"},class:te([`${f(m).textTheme}`])},[t("th",{style:K({border:`1px solid ${f(m).accentColor}`})},"DROPS",4),t("th",{style:K({border:`1px solid ${f(m).accentColor}`})},"PINNED SERIES",4),(a(!0),n(O,null,B(ot(ne.value.trunk1),(l,d)=>(a(),n("th",{style:K({border:`1px solid ${f(m).accentColor}`}),key:d},y(l.name),5))),128))],2)]),t("tbody",null,[(a(!0),n(O,null,B(Oe.value,(l,d)=>(a(),n("tr",{key:d},[t("td",{style:K({border:`1px solid ${f(m).accentColor}`})},y(d+1),5),t("td",{style:K({border:`1px solid ${f(m).accentColor}`})},y(l.dropKey.split(".")[0]+"."+l.dropKey.split(".")[1]+"."+l.dropKey.split(".")[2]),5),(a(!0),n(O,null,B(l.deltas,(h,q)=>(a(),n("td",{key:q,style:K({border:`1px solid ${f(m).accentColor}`})},[Lt(h,l.deltas)?(a(),n("span",Cl,y(h.toFixed(2)),1)):Tt(h,l.deltas)?(a(),n("span",$l,y(h.toFixed(2)),1)):Vt(h,l.deltas)?(a(),n("span",_l,y(h.toFixed(2)),1)):zt(h,l.deltas)?(a(),n("span",Pl,y(h.toFixed(2)),1)):(a(),n("span",Yl,y(h.toFixed(2)),1))],4))),128))]))),128))])])])])])):M("",!0)],4),Me.value?(a(),n("div",Ol,e[55]||(e[55]=[t("img",{src:"https://cdn.dribbble.com/users/1138184/screenshots/3796132/oil.gif"},null,-1)]))):M("",!0),se.value?(a(),n("div",Ll,[t("div",Tl,[t("button",{onClick:wt,class:"modelpick-dismiss"},[i(o,{icon:"times"})]),e[58]||(e[58]=t("h2",null,[t("b",null,"Leak Detection")],-1)),i(De,{"in-label":"Select Model","model-value":G.value,"onUpdate:modelValue":e[17]||(e[17]=l=>G.value=l)},{default:w(()=>e[56]||(e[56]=[t("option",{value:""},"Select...",-1),t("option",{value:"normal_pick"},"Normal Pick",-1),t("option",{value:"ranged_pick"},"Ranged Pick",-1)])),_:1},8,["model-value"]),i(De,{"in-label":"Select Prediction Method","model-value":R.value,"onUpdate:modelValue":e[18]||(e[18]=l=>R.value=l)},{default:w(()=>e[57]||(e[57]=[t("option",{value:""},"Select method...",-1),t("option",{value:"rf_single"},"RF Single-leak",-1),t("option",{value:"rf4_multi"},"RF4 Multi-leak",-1),t("option",{value:"dt_single"},"DT Single-leak",-1),t("option",{value:"dt4_multi"},"DT4 Multi-leak",-1),t("option",{value:"lr_single"},"LR Single-leak",-1),t("option",{value:"dynamic"},"Dynamic",-1)])),_:1},8,["model-value"]),i($,{onClick:e[19]||(e[19]=l=>se.value=!se.value),style:{width:"fit-content","margin-top":"0.5rem"},"bt-disabled":!1},{default:w(()=>[p(y(ze.value?"Update Preference":"Start Picking"),1)]),_:1})])])):M("",!0),Object.keys(S.value).length>1&&!xe.value?(a(),n("div",Vl,[t("button",{type:"button",class:"predict-action-hide",onClick:e[20]||(e[20]=l=>xe.value=!xe.value)},[i(o,{icon:"eye-slash"})]),t("div",zl,[e[59]||(e[59]=p("Picking Model: ")),t("b",null,y(G.value.split("_").map(l=>l.charAt(0).toUpperCase()+l.slice(1)).join(" ")),1),e[60]||(e[60]=p(" ··· Prediction Method: ")),t("b",null,y(R.value.split("_").map(l=>l.charAt(0).toUpperCase()+l.slice(1)).join(" ")),1)]),t("div",El,[e[61]||(e[61]=p("Num of drops: ")),t("b",null,y(Object.keys(S.value).filter(l=>S.value[l].type=="drop").length),1)]),t("div",Al,[i($,{"bt-size":"small",onClick:St,"bt-disabled":!1,style:{width:"fit-content"}},{default:w(()=>[i(o,{icon:"check"}),e[62]||(e[62]=p(" Predict "))]),_:1}),i($,{"bt-size":"small",onClick:$t,"bt-disabled":!1,style:{width:"fit-content",background:"rgb(0,150,255)"}},{default:w(()=>[i(o,{icon:"plus"}),e[63]||(e[63]=p(" Create Snapshot "))]),_:1}),i($,{"bt-size":"small",onClick:xt,"bt-disabled":!1,style:{width:"fit-content",background:"#666"}},{default:w(()=>[i(o,{icon:"refresh"}),e[64]||(e[64]=p(" Change Method "))]),_:1}),i($,{"bt-size":"small",onClick:Le,"bt-disabled":!1,style:{width:"fit-content",background:"orange"}},{default:w(()=>[i(o,{icon:"trash"}),e[65]||(e[65]=p(" Clear Selection "))]),_:1}),i($,{"bt-size":"small",onClick:lt,"bt-disabled":!1,style:{width:"fit-content",background:"red"}},{default:w(()=>[i(o,{icon:"close"}),e[66]||(e[66]=p(" Quit Prediction "))]),_:1})])])):M("",!0),Ee.value?(a(),n("div",Fl,[t("div",{class:te(["leak-body",[`${f(m).mTheme}`]])},[t("button",{type:"button",onClick:e[21]||(e[21]=l=>Ee.value=!1),class:"leak-dismiss"},[i(o,{icon:"times"})]),t("div",{class:"l-left",style:K({width:Pe.value?"40%":"100%"})},[e[79]||(e[79]=t("h4",{style:{"font-weight":"bold"}},"Leak Analysis",-1)),e[80]||(e[80]=t("hr",null,null,-1)),J.value?(a(!0),n(O,{key:0},B(J.value,(l,d)=>(a(),n("div",{class:"analysis-set",key:d},[l!=!1?(a(),n(O,{key:0},[t("h4",Nl,[t("b",null," DROP "+y(l.drop),1)]),t("p",null,[e[77]||(e[77]=p(" Result: ")),l!=!1&&l.suspectLocation.leak?(a(),n(O,{key:0},[e[75]||(e[75]=t("b",{style:{color:"red"}},"Possible leak detected!",-1)),t("div",Rl,[t("table",jl,[t("tr",null,[e[67]||(e[67]=t("th",{style:{border:"1px solid #ccc",padding:"10px"}},"Estimated Leak Point",-1)),l.suspectLocation.leakData.pu_location?(a(),n("th",Il," PU ")):M("",!0),l.suspectLocation.leakData.coordinate?(a(),n("th",Ul," Coordinate ")):M("",!0)]),t("tbody",null,[t("tr",null,[t("td",ql,y(l.suspectLocation.leakData.leak_point)+" KM ",1),l.suspectLocation.leakData.pu_location?(a(),n("td",Kl," KM "+y(l.suspectLocation.leakData.pu_location),1)):M("",!0),l.suspectLocation.leakData.coordinate?(a(),n("td",Bl,[e[69]||(e[69]=p(" LatLng: ")),t("code",null,y(l.suspectLocation.leakData.coordinate.latitude+", "+l.suspectLocation.leakData.coordinate.longitude),1),e[70]||(e[70]=t("br",null,null,-1)),e[71]||(e[71]=p(" DMS: ")),t("code",null,y(`${Ke(l.suspectLocation.leakData.coordinate.latitude)}, ${Ke(l.suspectLocation.leakData.coordinate.longitude)}`),1),e[72]||(e[72]=t("br",null,null,-1)),i($,{onClick:h=>Ct(`LATLNG: ${l.suspectLocation.leakData.coordinate.latitude}, ${l.suspectLocation.leakData.coordinate.longitude}
DMS: ${Ke(l.suspectLocation.leakData.coordinate.latitude)}, ${Ke(l.suspectLocation.leakData.coordinate.longitude)}`),style:{"margin-top":"5px"},"bt-disabled":!1,"bt-size":"small"},{default:w(()=>[i(o,{icon:"copy"}),e[68]||(e[68]=p(" Copy Coord "))]),_:2},1032,["onClick"])])):M("",!0)])])])]),l.suspectLocation.leakData.coordinate?M("",!0):(a(),n("p",Wl,[i(o,{icon:"info-circle"}),e[73]||(e[73]=p(" Map view and PU Location data is currently not supported for this line "))])),i($,{onClick:h=>Mt(l.suspectLocation.leakData.coordinate,l.suspectLocation.leakData.leak_point,l.suspectLocation.leakData.pu_location),"bt-disabled":!l.suspectLocation.leakData.coordinate},{default:w(()=>[i(o,{icon:"map-marker"}),e[74]||(e[74]=p(" Pinpoint on Map"))]),_:2},1032,["onClick","bt-disabled"]),l.suspectLocation.leakData.coordinate?(a(),n("a",{key:1,class:"gmaps",target:"_blank",href:`https://www.google.com/maps?q=${l.suspectLocation.leakData.coordinate.latitude},${l.suspectLocation.leakData.coordinate.longitude}`,style:{"margin-left":"0.5rem"}},"Google Maps",8,Hl)):M("",!0)],64)):(a(),n(O,{key:1},[e[76]||(e[76]=t("b",{style:{color:"#555"}},"No leak detected",-1)),t("ol",Gl,[(a(!0),n(O,null,B(l.suspectLocation.probabilities,(h,q)=>(a(),n("li",{key:q},y(h),1))),128))])],64))])],64)):(a(),n("h6",Ql,[t("b",null,"Analysis on Dataset "+y(d+1),1),e[78]||(e[78]=t("b",{style:{color:"#555"}},"Tidak ada indikasi",-1)),t("ol",Jl,[(a(!0),n(O,null,B(l.suspectLocation.probabilities,(h,q)=>(a(),n("li",{key:q},y(h),1))),128))])]))]))),128)):(a(),X(Bt,{key:1,message:"Calculating leak probabilities..."}))],4),Pe.value?(a(),n("div",{key:0,class:"l-right",style:K({width:Pe.value?"60%":"100%",position:"relative"})},[e[81]||(e[81]=t("h4",{style:{"font-weight":"bold"}},"Map View",-1)),e[82]||(e[82]=t("hr",null,null,-1)),i(qt,{latitude:qe.value.latitude,longitude:qe.value.longitude,"leak-point":pt.value,"pu-location":vt.value},null,8,["latitude","longitude","leak-point","pu-location"])],4)):M("",!0)],2)])):M("",!0),ge.value?(a(),n("div",Xl,[t("div",Zl,[e[85]||(e[85]=t("h5",null,[t("b",null,"Prediction Mode Preferences")],-1)),e[86]||(e[86]=t("hr",null,null,-1)),i(ye,{"in-label":"Dot Symbol Size","model-value":Q.value,"onUpdate:modelValue":e[22]||(e[22]=l=>Q.value=l),"in-type":"number"},null,8,["model-value"]),t("label",ea,[Re(t("input",{type:"checkbox","onUpdate:modelValue":e[23]||(e[23]=l=>ve.value=l)},null,512),[[je,ve.value]]),e[83]||(e[83]=t("div",{style:{display:"flex","flex-flow":"column","margin-left":"0.7rem"}},[t("span",{style:{"font-size":"13px"}},[t("b",null,"Show all dots")]),t("span",{style:{"font-size":"11px"}},"Show all dots or reduce the dot placement")],-1))]),i($,{onClick:e[24]||(e[24]=l=>ge.value=!ge.value),style:{width:"fit-content"},"bt-disabled":!1},{default:w(()=>e[84]||(e[84]=[p("Save Preferences")])),_:1})])])):M("",!0),Be.value?(a(),n("div",ta,[t("div",la,[e[89]||(e[89]=t("h2",null,[t("b",null,"Snapshot")],-1)),i(ye,{"in-label":"Name","model-value":Ae.value,"onUpdate:modelValue":e[25]||(e[25]=l=>Ae.value=l),"in-type":"text"},null,8,["model-value"]),i(ye,{"in-label":"Description","model-value":Fe.value,"onUpdate:modelValue":e[26]||(e[26]=l=>Fe.value=l),"in-type":"text"},null,8,["model-value"]),t("div",aa,[i($,{onClick:Pt,style:{width:"fit-content"},"bt-disabled":!1},{default:w(()=>[i(o,{icon:"save"}),e[87]||(e[87]=p(" Create "))]),_:1}),i($,{onClick:_t,style:{width:"fit-content"},"bt-disabled":!1},{default:w(()=>e[88]||(e[88]=[p("Cancel ")])),_:1})])])])):M("",!0),xe.value?(a(),n("button",{key:8,type:"button",onClick:e[27]||(e[27]=l=>xe.value=!xe.value),class:"predict-action-show"},[i(o,{icon:"eye"})])):M("",!0),xe.value?M("",!0):(a(),n("button",{key:9,type:"button",onClick:Et,class:"chart-resize"},[i(o,{icon:"left-right"})]))],64)}}}),sa=it(oa,[["__scopeId","data-v-9e651b16"]]),na={class:"dateselect-window"},ia={class:"dateselect-inner"},ra={class:"calendar-navigation"},ua={style:{"font-size":"19px"}},da={class:"calendar-days"},pa=["onClick"],va={key:0,style:{color:"orange","font-weight":"bold"}},ca={key:1},fa={style:{"margin-top":"1rem",display:"flex","flex-flow":"row nowrap","justify-content":"space-between"}},ya={style:{display:"flex","flex-flow":"row nowrap",gap:"0.3rem"}},ma=Xe({__name:"DateSelectView",props:{calendarTitle:{type:String,default:"Select Dates"},initialDates:{type:Array,default:()=>[]}},emits:["onApply","onClose"],setup(Se,{emit:le}){const Y=u(P().format("YYYY-MM-DD")),E=u([]),j=le,m=Se;I(()=>E.value,L=>{E.value=L.sort((b,T)=>new Date(b).getTime()-new Date(T).getTime())},{deep:!0});const A=()=>{j("onApply",E.value)};return Je(()=>{m.initialDates.length&&(E.value=m.initialDates)}),(L,b)=>{const T=Ie("font-awesome-icon");return a(),n("div",na,[t("div",ia,[t("h4",null,[t("b",null,[i(T,{icon:"calendar"}),p(" "+y(m.calendarTitle),1)])]),b[8]||(b[8]=t("hr",null,null,-1)),t("div",ra,[t("button",{class:"navmonth-btn",onClick:b[0]||(b[0]=_=>Y.value=f(P)(Y.value).subtract(1,"month").format("YYYY-MM-DD"))},[i(T,{icon:"angle-left"}),p(" "+y(f(P)(Y.value).subtract(1,"month").format("MMMM")),1)]),t("h3",ua,[t("b",null,y(f(P)(Y.value).format("MMMM YYYY")),1)]),t("button",{class:"navmonth-btn",onClick:b[1]||(b[1]=_=>Y.value=f(P)(Y.value).add(1,"month").format("YYYY-MM-DD"))},[p(y(f(P)(Y.value).add(1,"month").format("MMMM"))+" ",1),i(T,{icon:"angle-right"})])]),b[9]||(b[9]=Nt('<div class="calendar-days" data-v-0be19428><div class="calendar-day-week" data-v-0be19428>Sen</div><div class="calendar-day-week" data-v-0be19428>Sel</div><div class="calendar-day-week" data-v-0be19428>Rab</div><div class="calendar-day-week" data-v-0be19428>Kam</div><div class="calendar-day-week" data-v-0be19428>Jum</div><div class="calendar-day-week" data-v-0be19428>Sab</div><div class="calendar-day-week" data-v-0be19428>Min</div></div>',1)),t("div",da,[(a(!0),n(O,null,B(f(P)(Y.value).startOf("month").day(),_=>(a(),n("div",{key:_,class:"calendar-day-unclickable"}))),128)),(a(!0),n(O,null,B(f(P)(Y.value).daysInMonth(),_=>(a(),n("div",{key:_,class:"calendar-day",onClick:D=>E.value.includes(f(P)(Y.value).date(_).format("YYYY-MM-DD"))?E.value.splice(E.value.indexOf(f(P)(Y.value).date(_).format("YYYY-MM-DD")),1):E.value.push(f(P)(Y.value).date(_).format("YYYY-MM-DD")),style:K({background:E.value.includes(f(P)(Y.value).date(_).format("YYYY-MM-DD"))?"#aaaaaa":"#f0f0f0"})},[f(P)(Y.value).date(_).format("YYYY-MM-DD")==f(P)().format("YYYY-MM-DD")?(a(),n("span",va,[p(y(_)+" ",1),b[4]||(b[4]=t("b",{style:{"font-size":"7px"}},"TODAY",-1))])):(a(),n("span",ca,y(_),1))],12,pa))),128)),(a(!0),n(O,null,B(6-f(P)(Y.value).endOf("month").day(),_=>(a(),n("div",{key:_,class:"calendar-day-unclickable"}))),128))]),t("div",fa,[i($,{onClick:A,"bt-disabled":!E.value.length},{default:w(()=>b[5]||(b[5]=[p("Apply Selections")])),_:1},8,["bt-disabled"]),t("div",ya,[E.value.length?(a(),X($,{key:0,style:{background:"red"},onClick:b[2]||(b[2]=_=>E.value=[]),"bt-disabled":!1},{default:w(()=>[i(T,{icon:"trash"}),b[6]||(b[6]=p(" Clear"))]),_:1})):M("",!0),i($,{onClick:b[3]||(b[3]=_=>j("onClose")),"bt-disabled":!1},{default:w(()=>[i(T,{icon:"times"}),b[7]||(b[7]=p(" Close"))]),_:1})])])])])}}}),ba=it(ma,[["__scopeId","data-v-0be19428"]]),ga={class:"row"},ka={class:"col-md-3"},ha=["value"],wa={style:{display:"flex","flex-flow":"row nowrap","align-items":"center",gap:"1rem"}},xa={style:{display:"flex","flex-flow":"row nowrap",gap:"1rem","align-items":"center"}},Da={class:"col-md-12",style:{position:"relative"}},Sa={key:0,class:"loaders"},Ma={key:0,class:"load-window"},Ca={class:"load-inner"},$a={style:{display:"flex","flex-flow":"column","align-items":"flex-start",gap:"0.2rem"}},_a={style:{margin:"0",padding:"0"}},Pa={style:{"font-size":"9px",color:"red"}},Ya={style:{"font-size":"11px","margin-bottom":"1rem"}},Oa={style:{display:"flex","flex-flow":"row wrap","font-size":"11px",gap:"0.2rem",border:"1px solid #ccc",width:"100%",padding:"10px","border-radius":"10px"}},La={style:{color:"#555",padding:"5px",background:"#ddd","border-radius":"5px"}},Ta={style:{display:"flex","flex-flow":"row wrap","font-size":"11px",gap:"0.2rem",border:"1px solid #ccc",width:"100%",padding:"10px","border-radius":"10px"}},Va={style:{color:"#555",padding:"10px",background:"#eee","border-radius":"5px","text-align":"center"}},za={style:{display:"flex","flex-flow":"row wrap","font-size":"12px",background:"#eee",padding:"10px","border-radius":"10px",border:"1px solid #ccc",width:"100%"}},Ea={style:{"margin-right":"10px","font-weight":"bold"}},Aa={style:{"font-weight":"bold"}},Fa={style:{"font-weight":"bold"}},Na={style:{"font-weight":"bold"}},Ra={style:{display:"flex","flex-flow":"row nowrap",gap:"0.3rem"}},ja={key:1,style:{display:"flex","flex-flow":"column","align-items":"center","justify-content":"center",gap:"1rem"}},Ia={style:{"font-size":"30px"}},Ua=Xe({__name:"PlaybackFol",setup(Se){const le=st(),Y=yt();Y.asideToggle(!1);const E=u(le.getAllTrunk()),j=u("trunk1"),m=u();m.value=Object.keys(E.value);const A=u(5),L=u(),b=u([]),T=u(0),_=u([]),D=u(!1),ae=u(!1),v=u(!1);u(!1);const ne=u(!0),V=u({}),Ye=mt(),me=()=>{T.value++,b.value.push(null)};nt(()=>{const g=Ye.params.saveid;g?setTimeout(async()=>{const r="https://rtunode.findingoillosses.com/api/v1/getpresetbyid",C={key:g},c=await Qe.post(r,C),z=c.data.status,F=c.data.data;if(z===200){const N=F;_.value=[],b.value=[];const ee=N.dates;T.value=0,A.value=N.timerange,L.value=ee[0];for(let ce=1;ce<ee.length;ce++)me();setTimeout(()=>{document.querySelectorAll('input[type="date"]').forEach((ce,we)=>{ce.value=ee[we],b.value[we]=ce}),W(),V.value={name:N.name,desc:N.desc,selectedMethod:N.selectedMethod,selectedModel:N.selectedModel,selection:N.selections,seekerValue:N.seekerValue},D.value=!0},100)}else Y.notifyShowError("Failed fetching snapshot!")},1e3):(Me(),D.value=!0)}),I(()=>[L.value,A.value,j.value],async()=>{V.value={},ae.value=!0,await W()});const Me=()=>{const g=new Date,r=g.getFullYear(),C=String(g.getMonth()+1).padStart(2,"0"),c=String(g.getDate()).padStart(2,"0"),z=`${r}-${C}-${c}`;L.value=z},oe=async g=>new Promise(async(r,C)=>{try{const c=E.value[j.value];let z=[];for(let ee=0;ee<c.spot.length;ee++)z.push(c.spot[ee].id);const F={datefilter:g,timeFilter:A.value,idFilter:z},N=await Qe.post(Rt.baseEnd+"api/History/getsplittedhistdata",F);r(N.data)}catch(c){C(c)}}),W=async()=>{try{v.value=!0;let r=[...await oe(L.value)];if(b.value.length>0){for(let C=0;C<b.value.length;C++){const c=b.value[C];if(c!==null){if(c.value!==L.value){const z=await oe(c.value);r=r.concat(z)}}else console.log("Null")}ae.value=!1}_.value=r,v.value=!1}catch(g){console.log(g),ae.value=!1,v.value=!1}},Ce=async()=>new Promise(async(g,r)=>{try{v.value=!0;let c=[...await oe(L.value)];if(b.value.length>0){for(let z=0;z<b.value.length;z++){const F=b.value[z];if(F!==null){if(F.value!==L.value){const N=await oe(F.value);c=c.concat(N)}}else console.log("Null")}ae.value=!1}_.value=c,v.value=!1,g(!0)}catch(C){console.log(C),ae.value=!1,v.value=!1,r(!1)}}),ie=(g,r)=>{b.value[r]=g,W()},$e=()=>{T.value>0&&(T.value--,b.value.pop()),W()},Ze=g=>{L.value=g},re=u([]),_e=async g=>{Z();const r={};r.name=g.name,r.desc=g.desc,r.timerange=A.value,r.selectedModel=g.selectedModel,r.selectedMethod=g.selectedMethod,r.dates=re.value,r.selections=g.selections,r.seekerValue=g.seekerValue,r.context="jamerfol",(await Qe.post("https://rtunode.findingoillosses.com/api/v1/savepreset",r)).data.status===200?(Y.notifyShow("Preset has been saved!"),re.value=[]):(Y.notifyShowError("Failed saving preset!"),re.value=[])},Z=()=>{if(re.value.push(L.value),b.value.length)for(let g in b.value)re.value.push(b.value[g].value)},H=u([]),x=u(!1),be=()=>{x.value=!0,ge()},ge=async()=>{const g={context:"jamerfol"},r=await Qe.post("https://rtunode.findingoillosses.com/api/v1/getpresets",g);r.data.status===200?H.value=r.data.data:Y.notifyShowError("Failed fetching snapshots!")},ve=async g=>{ne.value=!1,_.value=null,b.value=[];const r=g.dates;T.value=0,A.value=g.timerange,L.value=r[0];for(let C=1;C<r.length;C++)me();Q(r).then(async()=>{await Ce().then(()=>{V.value={name:g.name,desc:g.desc,selectedMethod:g.selectedMethod,selectedModel:g.selectedModel,selection:g.selections,seekerValue:g.seekerValue},x.value=!1,setTimeout(()=>{ne.value=!0},1e3)})})},Q=g=>new Promise((r,C)=>{try{setTimeout(()=>{document.querySelectorAll('input[type="date"]').forEach((c,z)=>{c.value=g[z],b.value[z]=c}),r(!0)},50)}catch(c){C(c)}}),et=g=>{const r=`https://jamer.findingoillosses.com/fol/playback/${g.key}`;navigator.clipboard.writeText(r).then(()=>{Y.notifyShow(`${g.name} -> Link copied. CTRL+V to paste`)}),x.value=!1},U=u(!1),ke=u([]),he=g=>{ke.value=g,U.value=!1,L.value=g[0],b.value=[],T.value=0;for(let r=1;r<g.length;r++)me();setTimeout(()=>{document.querySelectorAll('input[type="date"]').forEach((r,C)=>{r.value=g[C],b.value[C]=r}),W()},100)},Oe=()=>{b.value=[],ke.value=[],T.value=0,W()},tt=()=>{U.value=!1};return(g,r)=>{const C=Ie("font-awesome-icon");return a(),n(O,null,[i(At,{"context-title":"Playback"},{default:w(()=>[t("div",ga,[t("div",ka,[i(De,{"in-label":"Select Line","model-value":j.value,"onUpdate:modelValue":r[0]||(r[0]=c=>j.value=c)},{default:w(()=>[(a(!0),n(O,null,B(m.value,(c,z)=>(a(),n("option",{key:z,value:c},y(E.value[c].name),9,ha))),128))]),_:1},8,["model-value"]),i(De,{"in-label":"Time Range","model-value":A.value,"onUpdate:modelValue":r[1]||(r[1]=c=>A.value=c)},{default:w(()=>r[6]||(r[6]=[t("option",{value:"1"},"1 Menit",-1),t("option",{value:"2"},"2 Menit",-1),t("option",{value:"3"},"3 Menit",-1),t("option",{value:"4"},"4 Menit",-1),t("option",{value:"5"},"5 Menit",-1),t("option",{value:"10"},"10 Menit",-1),t("option",{value:"15"},"15 Menit",-1),t("option",{value:"30"},"30 Menit",-1),t("option",{value:"60"},"60 Menit",-1)])),_:1},8,["model-value"]),t("div",wa,[i(ye,{"in-type":"date","in-label":"Date Filter","model-value":L.value,"onUpdate:modelValue":r[2]||(r[2]=c=>L.value=c),style:{width:"100%"}},null,8,["model-value"])]),t("div",xa,[i($,{onClick:$e,"bt-size":"small","bt-type":"button","bt-disabled":!1},{default:w(()=>[i(C,{icon:"minus"})]),_:1}),t("span",{class:te([`${f(Y).textTheme}`])},y(T.value),3),i($,{onClick:me,"bt-size":"small","bt-type":"button","bt-disabled":!1},{default:w(()=>[i(C,{icon:"plus"})]),_:1})]),(a(!0),n(O,null,B(T.value,(c,z)=>(a(),n("div",{key:z,style:{display:"flex","flex-flow":"row nowrap","align-items":"center",gap:"1rem"}},[i(ye,{"in-type":"date","in-label":`Date Filter ${c}`,onOnValueChange:F=>ie(F,z),style:{width:"100%"}},null,8,["in-label","onOnValueChange"])]))),128)),i($,{"bt-size":"normal","bt-type":"button",onClick:r[3]||(r[3]=c=>U.value=!U.value),"bt-disabled":!1,style:{"margin-top":"0.5rem",width:"fit-content"}},{default:w(()=>[i(C,{icon:"calendar"}),r[7]||(r[7]=p(" Select Dates "))]),_:1}),b.value.length>0?(a(),X($,{key:0,"bt-size":"normal","bt-type":"button",onClick:Oe,"bt-disabled":!1,style:{"margin-top":"0.5rem","margin-left":"5px",width:"fit-content",background:"red"}},{default:w(()=>[i(C,{icon:"trash"}),r[8]||(r[8]=p(" Clear Dates "))]),_:1})):M("",!0)]),t("div",Da,[v.value&&D.value?(a(),n("div",Sa,r[9]||(r[9]=[t("img",{src:"https://cdn.dribbble.com/users/1138184/screenshots/3796132/oil.gif",style:{width:"350px",height:"350px","object-fit":"contain","border-radius":"20px"}},null,-1)]))):M("",!0),_.value&&ne.value?(a(),X(sa,{key:1,"snap-shots":V.value,onOnDataSave:_e,onOnLoadPreset:be,"init-date-filter":L.value,"selected-spot":j.value,"init-playback-datas":_.value,onOnDateChange:Ze},null,8,["snap-shots","init-date-filter","selected-spot","init-playback-datas"])):M("",!0)])])]),_:1}),x.value?(a(),n("div",Ma,[t("div",Ca,[t("button",{type:"button",class:"load-dismiss",onClick:r[4]||(r[4]=c=>x.value=!x.value)},[i(C,{icon:"times"})]),H.value.length>0?(a(),n(O,{key:0},[r[15]||(r[15]=t("h2",{style:{"padding-left":"1rem"}},[t("b",null,"Saved Snapshots")],-1)),(a(!0),n(O,null,B(H.value,(c,z)=>(a(),n("div",{class:"preset-item",key:z},[t("div",$a,[t("h5",_a,[t("b",null,[p(y(c.name)+" ",1),t("sup",Pa,[t("b",null,"#"+y(c.key),1)])])]),t("div",Ya,[r[10]||(r[10]=p("Description: ")),t("b",null,y(c.desc),1)]),t("div",Oa,[(a(!0),n(O,null,B(c.dates,(F,N)=>(a(),n("div",{key:N,style:{"font-weight":"bold"}},[t("div",La,[t("b",null,[i(C,{icon:"calendar"}),p(" "+y(F),1)])])]))),128))]),t("div",Ta,[(a(!0),n(O,null,B(c.selections,(F,N)=>(a(),n("div",{key:N,style:{"font-weight":"bold",width:"150px"}},[t("div",Va,[t("b",{style:K({color:`${F.type=="drop"?"red":"green"}`})},y(`${F.name}: (${F.timerange})`),5)])]))),128))]),t("div",za,[t("span",Ea,[r[11]||(r[11]=p("Pick: ")),t("code",Aa,y(c.selectedModel),1)]),t("span",Fa,[r[12]||(r[12]=p("Prediction: ")),t("code",Na,y(c.selectedMethod),1)])]),t("div",Ra,[i($,{"bt-disabled":!1,"bt-size":"small","bt-type":"button",onClick:F=>ve(c),style:{"margin-top":"1rem"}},{default:w(()=>[i(C,{icon:"plus"}),p(" Import "+y(c.name),1)]),_:2},1032,["onClick"]),i($,{"bt-disabled":!1,"bt-size":"small","bt-type":"button",onClick:F=>et(c),style:{"margin-top":"1rem"}},{default:w(()=>[i(C,{icon:"copy"}),r[13]||(r[13]=p(" Copy Share Link "))]),_:2},1032,["onClick"]),i($,{"bt-disabled":!1,"bt-size":"small","bt-type":"button",onClick:r[5]||(r[5]=F=>x.value=!x.value),style:{"margin-top":"1rem",background:"red"}},{default:w(()=>[i(C,{icon:"trash"}),r[14]||(r[14]=p(" Delete "))]),_:1})])])]))),128))],64)):(a(),n("div",ja,[t("span",Ia,[i(C,{icon:"inbox"})]),r[16]||(r[16]=t("h5",{style:{padding:"0",margin:"0"}},"No Snapshot(s) Found!",-1)),r[17]||(r[17]=t("p",{style:{padding:"0",margin:"0","text-align":"center"}},[p("To add a new Snapshot, select Normal & Drop(s) on active Leak Detection chart and click "),t("b",null,"Create Snapshot")],-1))]))])])):M("",!0),U.value?(a(),X(ba,{key:1,"initial-dates":ke.value,onOnClose:tt,onOnApply:he},null,8,["initial-dates"])):M("",!0)],64)}}}),to=it(Ua,[["__scopeId","data-v-b8eff23e"]]);export{to as default};
