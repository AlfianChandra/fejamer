import{u as ht}from"./theme-CM9sE5or.js";import{_ as Ut}from"./MainWrapperView.vue_vue_type_style_index_0_lang-BGrAbwFO.js";import{_ as Me}from"./SelectView.vue_vue_type_style_index_0_lang-DwzeLS0C.js";import{_ as ce}from"./InputView.vue_vue_type_style_index_0_lang-DAiU9CdF.js";import{_ as C}from"./ButtonView.vue_vue_type_style_index_0_computed_true_lang-Eho0sggM.js";import{t as ut}from"./trunk-DoavT4Nh.js";import{d as st,h as u,B as qt,i as dt,E as ot,r as Ke,o,c as i,a as n,w,b as te,l as S,g as wt,k as R,e as t,p as v,n as le,u as f,x as qe,C as Be,t as y,f as B,F as T,y as K,_ as pt,G as Bt,m as Kt}from"./index-BHDQpOjx.js";import{a as at}from"./axios-BimPEqV4.js";import{i as Wt}from"./index-CehbAW_K.js";import{h as O}from"./moment-C5S46NFB.js";import{_ as Ht,m as Gt,a as Qt,u as Jt,L as Xt}from"./LoadingView-Cv9UOd_k.js";const Zt={style:{width:"100%",display:"flex","flex-flow":"column"}},el=st({__name:"PressureDistView",props:{selectedSpot:{type:String,required:!0},data:{type:Object,required:!0},leakPointResult:Object},setup(Ce){const ae=u(!1),P=Ce,V=qt(()=>P.data),j=u(ut().getAllTrunk()),b=u({}),z=u(P.selectedSpot),L=()=>j.value[z.value].trunkLength,g=u(0),E=Y=>{g.value=Y};return dt(()=>{ae.value=!0,b.value=V.value,ae.value=!1}),ot(()=>{ae.value=!0,b.value=V.value,ae.value=!1}),(Y,G)=>{const D=Ke("center");return o(),i("div",Zt,[n(D,null,{default:w(()=>[n(ce,{"in-label":"Drop Tolerance Value","in-type":"number","model-value":g.value,"onUpdate:modelValue":G[0]||(G[0]=X=>g.value=X),style:{width:"200px"}},null,8,["model-value"])]),_:1}),!ae.value&&Object.keys(b.value).length?(o(),te(Ht,{key:0,onOnToleranceChanged:E,"chart-data":b.value,"selected-spot":z.value,"trunk-length":L(),"tolerance-value":g.value,"prediction-result":P.leakPointResult},null,8,["chart-data","selected-spot","trunk-length","tolerance-value","prediction-result"])):S("",!0)])}}}),tl={key:0,class:"datepickdialog"},ll={class:"datepickinner"},al={style:{display:"flex","flex-flow":"row nowrap",gap:"0.2rem"}},ol={key:1,class:"selfnavdialog"},sl={class:"selfnavdialog-inner"},nl={style:{display:"flex","flex-flow":"row nowrap","justify-content":"center","margin-bottom":"1rem",gap:"1rem"}},il={style:{display:"flex","flex-flow":"row nowrap",gap:"0.5rem","justify-content":"space-between"}},rl={style:{display:"flex","flex-flow":"row nowrap",gap:"0.3rem"}},ul={style:{display:"flex","flex-flow":"row nowrap",gap:"0.3rem",height:"45px","align-items":"center"}},dl={style:{"border-radius":"10px",display:"flex","flex-flow":"row nowrap","justify-content":"space-between","padding-left":"10px","padding-right":"10px",border:"1px solid #ccc",padding:"20px","margin-bottom":"1rem"}},pl={style:{border:"1px solid #ccc",padding:"5px","padding-left":"70px","text-align":"center","padding-right":"70px","border-radius":"100px"}},vl={key:0,style:{"font-size":"11px"}},cl={key:0,style:{"font-size":"11px"}},fl={key:1,style:{"font-size":"11px"}},yl={style:{display:"flex","flex-flow":"row nowrap",width:"100%","align-items":"center"}},ml={style:{display:"flex","flex-flow":"no wrap",padding:"10px",gap:"0.5rem"}},bl={style:{width:"100%",padding:"10px",position:"relative"}},gl=["max","value"],kl={key:0,class:"sel-wrapper"},hl={style:{display:"flex","justify-content":"flex-start","overflow-x":"auto","white-space":"nowrap",padding:"20px",gap:"1rem",width:"40%"}},wl=["onClick"],xl={key:0,class:"dataspan"},Dl={style:{width:"50%"}},Sl={style:{color:"#fff",background:"red",width:"70px",padding:"5px","border-radius":"5px","font-size":"10px","text-align":"center"}},Ml={style:{width:"60%","padding-right":"5rem","padding-top":"1rem","padding-bottom":"1rem"}},Cl=["src"],$l={class:"table-responsive"},Ol={style:{"margin-top":"1rem"}},Yl={class:"tbl2"},Pl={style:{"margin-top":"1rem"}},_l={class:"tbl2"},Tl={key:0,style:{color:"red","text-shadow":"0.5px 0.5px 1px rgba(0,0,0,0.6)"}},Ll={key:1,style:{color:"orange","text-shadow":"0.5px 0.5px 1px rgba(0,0,0,0.6)"}},Al={key:2,style:{color:"yellow","text-shadow":"0.5px 0.5px 1px rgba(0,0,0,0.6)"}},El={key:3,style:{color:"lime","text-shadow":"0.5px 0.5px 1px rgba(0,0,0,0.6)"}},Vl={key:4},zl={key:2,class:"hmloader"},Fl={key:3,class:"model-window"},Nl={class:"modelpick-inner"},Rl={key:4,class:"predict-action"},jl={style:{"margin-bottom":"0.1rem"}},Il={style:{"margin-bottom":"0.5rem"}},Ul={style:{display:"flex","flex-flow":"row nowrap",gap:"0.5rem"}},ql={key:5,class:"leak-window"},Bl={style:{color:"rgb(0,150,255)"}},Kl={class:"table-responsive"},Wl={style:{width:"100%","margin-top":"1rem"},class:"table table-striped table-hover;"},Hl={key:0,style:{border:"1px solid #ccc",padding:"10px"}},Gl={key:1,style:{border:"1px solid #ccc",padding:"10px"}},Ql={style:{"font-weight":"bold",border:"1px solid #ccc",padding:"10px"}},Jl={key:0,style:{"font-weight":"bold",border:"1px solid #ccc",padding:"10px"}},Xl={key:1,style:{"font-weight":"bold",border:"1px solid #ccc",padding:"10px"}},Zl={key:0},ea=["href"],ta={style:{"margin-top":"1rem"}},la={key:1},aa={style:{"margin-top":"1rem"}},oa={key:6,class:"setting-window"},sa={class:"setting-inner"},na={class:"pref-block"},ia={key:7,class:"save-window"},ra={class:"save-inner"},ua={style:{display:"flex","flex-flow":"row nowrap",gap:"0.5rem"}},da={key:8,class:"chart-option-window"},pa={class:"chart-option-inner"},va={type:"button",class:"chart-option-dismiss"},ca=st({__name:"PlaybackView",props:{initDateFilter:{type:String,required:!0},selectedSpot:{type:String,required:!0},initPlaybackDatas:{type:Array,required:!0},snapShots:{type:Object,required:!1,default:null},mainSize:{type:Object,required:!1},selectedDates:{type:Array,default:null,required:!1}},emits:["onDateChange","onDataSave","onLoadPreset"],setup(Ce,{emit:ae}){const P=Jt(),V=ut(),j=ae,b=ht(),z=u("forward"),L=u(!1),g=u(""),E=u(!0),Y=u(!1),G=u(150),D=Ce,X=u(),c=u(),oe=u(V.getAllTrunk()),F=u(0),fe=u(0),We=u([]),de=u(!1),Z=u(250);let ne=null;const $e=u(!1);let ie=[];const Oe={},ge=u(),Ye=u(""),Pe=u(""),Q=u(!0),U=u(!1),$=u(!1),ke=u(!1),he=u(!1),ye=u(!1),ee=u(7),we=wt();u(we.params.saveid);let W=u({}),Le=null;const Ae=u([]),xe=u(null),m=u({}),r=()=>{c.value=Wt(X.value);const a={grid:{top:"10%",left:"10%",right:"10%",bottom:"15%"},legend:{show:!0,type:"scroll",orient:"horizontal"},tooltip:{trigger:"item",triggerOn:"mousemove",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},axisPointer:{show:!0,type:"shadow"},xAxis:[{type:"category",data:[],boundaryGap:!1,splitNumber:1,minInterval:1,scale:!0,axisLabel:{fontSize:9,formatter:function(e){const s=e.split(" ("),d=s[1].split(")")[0],l=d.split(" - ")[0],p=s[0].split("-");return`${p[2]}${p[1]}${p[0]}`,l=="00:00"?(Ae.value.includes(e)||Ae.value.push(e),e):d},rotate:45},splitLine:{show:!0,lineStyle:{type:"dashed"}},axisTick:{alignWithLabel:!0}}],yAxis:{type:"value",name:"Pressure (PSI)",nameGap:10,max:G.value,interval:20,axisTick:{show:!0,inside:!0},splitLine:{show:!0,lineStyle:{type:"solid",color:"#999"}},minorTick:{show:!0},minorSplitLine:{show:!0,lineStyle:{type:"dashed",color:"#ccc"}}},series:[]};c.value.setOption(a),setTimeout(()=>{c.value.dispatchAction({type:"legendInverseSelect"}),c.value.dispatchAction({type:"legendAllSelect"}),c.value.resize()},100)},M=a=>{const e={type:"line",name:a,xAxisIndex:0,data:[],markLine:{symbol:"none",symbolSize:0,data:[{xAxis:a}],lineStyle:{width:.7,type:"solid"},label:{color:"#fff",backgroundColor:"inherit",height:14,show:!0,formatter:function(l){const p=l.value.split(" (")[0];return O(p).format("ddd, DD MMM YYYY hh:mm:ss")},position:"middle",distance:-6}}},s=c.value.getOption();let d=!1;if(s.series.forEach(l=>{l.name==a&&(d=!0)}),!d){const l=c.value.getOption().series;l.push(e),c.value.setOption({series:l})}},k=()=>{const a=O().format("YYYY-MM-DD"),e=O(D.initDateFilter).format("YYYY-MM-DD");$e.value=a===e};dt(()=>{window.addEventListener("keyup",St),k()}),R(()=>X.value,()=>{r(),_(F.value)}),R(()=>D.initPlaybackDatas,(a,e)=>{!a||a.length===0||(k(),A(),_(F.value),de.value=!1,U.value&&($.value=!0))});const _=a=>{ie=[];for(let l of oe.value[D.selectedSpot].spot)Oe[l.name]=[];D.initPlaybackDatas.slice(0,a+1).forEach((l,p)=>{const h=`${l.dateFilter} (${l.timeRange})`;ie.push(h),ge.value=h,l.data.forEach(q=>{const et=oe.value[D.selectedSpot].spot.find(lt=>lt.id===q.idSpot).name,tt=q.avgPsiValues??0;Oe[et][p]=Number(tt.toFixed(2))})});const s=Object.keys(Oe).map(l=>({name:l,type:"line",data:Oe[l],showAllSymbol:ye.value,smooth:!1,tooltip:{trigger:"axis",formatter:function(p){return p[0].value}},endLabel:{show:!0,formatter:function(p){return p.value+" ; "+l},color:"#000",backgroundColor:"inherit",padding:5,fontSize:10,borderRadius:5}}));let d=c.value.getOption();d.xAxis[0].data=ie,d.series=s,c.value.setOption(d),Ae.value.forEach(l=>{M(l)})},I=()=>{c.value.getOption()},A=()=>{$.value=!1,F.value=0,We.value=[],clearInterval(ne),_(F.value),fe.value=F.value/D.initPlaybackDatas.length*100},pe=a=>{$.value=!1,We.value=[],F.value=parseInt(a.target.value,10),_(F.value),fe.value=F.value/D.initPlaybackDatas.length*100};R(()=>D.initDateFilter,async()=>{it(),nt(),await Ee().then(()=>{me()})});const me=()=>{const a=O(D.initDateFilter),e=a.add(1,"days").format("YYYY-MM-DD"),s=a.subtract(2,"days").format("YYYY-MM-DD");Ye.value=e,Pe.value=s};me();const De=async()=>{it(),await Ee().then(()=>{if($e.value)b.notifyShowError("End of playback");else{ke.value=!0,A();const a=O(Ye.value).format("YYYY-MM-DD");U.value&&($.value=!0),de.value=!0,j("onDateChange",a),setTimeout(()=>{ke.value=!1},5e3)}})},He=async()=>{it(),await Ee().then(()=>{ke.value=!0,A();const a=O(Pe.value).format("YYYY-MM-DD");U.value&&($.value=!0),de.value=!0,j("onDateChange",a),setTimeout(()=>{ke.value=!1},5e3)})};R(()=>Q.value,()=>{Q.value&&(ze(),L.value=!1,U.value=!1)}),R(()=>L.value,()=>{L.value?(Q.value=!1,U.value=!0):Q.value=!0}),R(()=>U.value,()=>{U.value&&(Q.value=!1)}),R(()=>$.value,()=>{if(!$.value&&F.value==D.initPlaybackDatas.length)if(Q.value)A(),$.value=!0;else{const a=O().format("YYYY-MM-DD"),e=O(D.initDateFilter).format("YYYY-MM-DD");a===e?$.value=!1:L.value?z.value=="forward"?re.value?D.initDateFilter!=ue.value?De():Qe.value?(A(),j("onDateChange",ve.value)):ze():De():re.value?D.initDateFilter!=ve.value?He():Qe.value?(A(),j("onDateChange",ue.value)):ze():He():(A(),$.value=!0)}J.value&&N.value?(ct(),vt(),I()):Ge()});const vt=()=>{if($.value)Ge();else{const a=c.value.getOption();a.series.forEach(s=>{s.symbolSize=ee.value}),a.series.forEach(s=>{s.symbol="circle"});const e=c.value.getOption().tooltip;e.show=!0,c.value.setOption(a)}},Ge=()=>{const a=c.value.getOption();a.series.forEach(e=>{e.symbolSize=0}),a.series.forEach(e=>{e.symbol="none"}),c.value.setOption(a),c.value.off("click")},x=u({}),ct=()=>{c.value.off("click"),c.value.on("click",a=>{if(a.componentType==="markLine"){if(a.seriesName==="Normal"){b.notifyConfirm("Delete Normal","Are you sure?","Delete","Cancel",async()=>{ft()},()=>{});return}else b.notifyConfirm("Delete Marker","Delete this marker?","Delete","Cancel",async()=>{const p=c.value.getOption();p.series=p.series.filter((h,q)=>q!==a.seriesIndex),c.value.clear(),c.value.setOption(p),Object.keys(x.value).forEach(h=>{x.value[h].index===a.value&&delete x.value[h]}),E.value=!1,setTimeout(()=>{E.value=!0},100)},()=>{});return}const e=ie.findIndex(p=>p===a.name);if(e<0)return;if(x.value.normal){const p=Object.keys(x.value).length,h={type:"line",name:`Drop ${p}`,xAxisIndex:0,data:[],markLine:{symbol:"image://https://gpng.net/wp-content/uploads/ROBBER.png",symbolSize:35,data:[{xAxis:e,symbolRotate:180}],lineStyle:{color:"blue",width:2,type:"dotted"},label:{show:!0,formatter:`Drop ${p}`,position:"insideEndTop"}}},q=c.value.getOption().series;q.push(h),c.value.setOption({series:q})}else{const p={type:"line",name:"Normal",xAxisIndex:0,data:[],markLine:{symbol:"image://https://png.pngtree.com/png-clipart/20230325/original/pngtree-petroleum-workers-or-miners-vector-png-image_9004441.png",symbolSize:42,data:[{xAxis:e}],lineStyle:{color:"red",width:2,type:"dotted"},label:{show:!0,formatter:"Normal",position:"insideEndTop"}}},h=c.value.getOption().series;h.push(p),c.value.setOption({series:h})}const l=c.value.getOption().series.filter(p=>Array.isArray(p.data)).map(p=>({seriesName:p.name,yValue:p.data[e]??0}));if(x.value.normal){const p=Object.keys(x.value).length;x.value[`drop${p}`]={index:e,name:`Drop ${p}`,data:l,order:c.value.getOption().series.length-1,type:"drop",timerange:ie[e].split(" (")[1].split(")")[0],seriesName:ie[e].split(" (")[1].split(")")[0]+".drop."+D.initDateFilter,date:D.initDateFilter}}else{const p={normal:{index:e,name:"Normal",data:l,order:0,type:"normal",timerange:ie[e].split(" (")[1].split(")")[0],seriesName:ie[e].split(" (")[1].split(")")[0]+".normal."+D.initDateFilter,date:D.initDateFilter}};x.value={...p,...x.value},xe.value=p.normal.seriesName}})},ft=()=>{const a=c.value.getOption();a.series=a.series.filter(e=>e.name!=="Normal"),c.value.clear(),c.value.setOption(a),delete x.value.normal,b.notifyShow("Normal deleted"),xe.value=null},Ee=()=>new Promise((a,e)=>{try{if(Object.keys(x.value).length===0){a();return}const s=c.value.getOption();s.series=s.series.filter(d=>!d.markLine),c.value.clear(),c.value.setOption(s),x.value={},a()}catch(s){e(s)}});R(()=>[$.value,Z.value],()=>{$.value?(ne!=null&&clearInterval(ne),ne=setInterval(()=>{F.value<D.initPlaybackDatas.length?(F.value++,D.initPlaybackDatas[F.value]!=null&&(_(F.value),fe.value=F.value/D.initPlaybackDatas.length*100)):($.value=!1,clearInterval(ne))},Z.value)):ne&&(clearInterval(ne),ne=null)}),R(()=>[b.asideVisible],()=>{setTimeout(()=>{c.value.resize()},500)});const Ve=u(!1),xt=()=>z.value=="forward"?Ye.value:Pe.value,be=u(!1),re=u(!1),Qe=u(!0),ve=u(""),ue=u(""),Dt=()=>{ve.value?ue.value?(re.value=!0,Q.value=!1,L.value=!0,U.value=!0,be.value=!1,$.value=!1):b.notifyShowError("Date 2 is required"):b.notifyShowError("Date 1 is required")};R(()=>be.value,()=>{be.value?($.value=!1,re.value=!1):$.value=!0}),R(()=>[re.value],()=>{re.value&&(A(),z.value=="forward"?j("onDateChange",ve.value):j("onDateChange",ue.value))}),R(()=>z.value,()=>{z.value=="backward"&&(A(),ze())});const ze=()=>{A(),j("onDateChange",D.initDateFilter),re.value=!1,ve.value=null,ue.value=null},St=a=>{Y.value||((a.keyCode==80||a.keyCode==32)&&($.value=!$.value),a.keyCode==37&&He(),a.keyCode==39&&De())},Mt=(a,e)=>{if(a.type=="normal"){b.notifyConfirm("Delete Normal","Are you sure?","Delete","Cancel",async()=>{ft()},()=>{});return}const s=c.value.getOption();s.series=s.series.filter(d=>d.name!==a.name),c.value.clear(),c.value.setOption(s),delete x.value[e],E.value=!1,setTimeout(()=>{E.value=!0},100)},J=u(null),N=u(null),se=u(!1),Fe=u(!1),Ct=()=>{Fe.value?(se.value=!1,Fe.value=!1):(J.value=null,N.value=null,se.value=!1)};R(()=>se.value,()=>{Fe.value=!1});const nt=()=>{J.value=null,N.value=null,se.value=!1,Ge(),Ee(),x.value={}};R(()=>[J.value,N.value],()=>{J.value&&N.value?(ct(),vt()):(Ge(),b.notifyShow("Prediction stopped"))});const $t=()=>{Fe.value=!0,se.value=!0},Ne=u(!1),yt=u([]),H=u([]),_e=u(!1),Je=u(),Ot=u(),Yt=()=>{const a=Pt();if(console.log(a),!J.value||!N.value){b.notifyShowError("Please select model and method");return}b.notifyShow("Prediction started"),se.value=!1;let e={};Object.keys(x.value).forEach(d=>{if(x.value[d].type!=="normal"||x.value[d].type!=="drop"){const l=V.getAllTrunk().trunk1.spot.length;let p={name:x.value[d].name,data:x.value[d].data.map(h=>({avgPsiValues:h.yValue})).slice(0,l),type:x.value[d].type};e[x.value[d].name]=p}}),yt.value=[];const s=P.mlpredict(e,N.value);if(Ne.value=!0,N.value==="rf_single"?setTimeout(()=>{H.value=s.sort((d,l)=>d.drop-l.drop),Te(a)},4e3):N.value==="rf4_multi"?setTimeout(()=>{H.value=s.sort((d,l)=>d.drop-l.drop),Te(a)},4e3):N.value==="lr_single"?setTimeout(()=>{H.value=s.sort((d,l)=>d.drop-l.drop),Te(a)},4e3):N.value==="dt_single"?setTimeout(()=>{H.value=s.sort((d,l)=>d.drop-l.drop),Te(a)},4e3):N.value==="dt4_multi"?setTimeout(()=>{H.value=s.sort((d,l)=>d.drop-l.drop),Te(a)},4e3):N.value==="dynamic"&&setTimeout(()=>{H.value=s.sort((d,l)=>d.drop-l.drop),Te(a)},4e3),H.value!=null)for(let d=0;d<H.value.length;d++)H.value[d].suspectLocation.leak&&yt.value.push(H.value[d])},Te=a=>{for(let e=0;e<H.value.length;e++){const s=H.value[e].drop,d=a.find(l=>l.dropnum===s);H.value[e].date=d.date,H.value[e].time=d.time}},Pt=()=>{const a=[];let e=0;return Object.keys(x.value).forEach(s=>{x.value[s].type==="drop"&&a.push({date:x.value[s].date,time:x.value[s].timerange,dropnum:e}),e++}),a},mt=u(),bt=u(),_t=(a,e,s)=>{Je.value=a,_e.value=!1,_e.value=!0,mt.value=e,bt.value=s};R(()=>Ne.value,()=>{Ne.value||(_e.value=!1,H.value=null,Je.value=null,Ot.value=null)});const Tt=async a=>{g.value=a,await navigator.clipboard.writeText(g.value),b.notifyShow("Coordinate copied to clipboard")},Xe=a=>{const e=Math.floor(a),s=Math.abs(a-e)*60,d=Math.floor(s),l=(s-d)*60;return`${e}° ${d}' ${l.toFixed(2)}"`};R(()=>ye.value,()=>{if(ye.value){ee.value=5;const a=c.value.getOption();a.series.forEach(e=>{e.showAllSymbol=!0}),a.series.forEach(e=>{e.symbolSize=ee.value}),c.value.setOption(a)}else{ee.value=7;const a=c.value.getOption();a.series.forEach(e=>{e.showAllSymbol=!1}),a.series.forEach(e=>{e.symbolSize=ee.value}),c.value.setOption(a)}}),R(()=>ee.value,()=>{const a=c.value.getOption();a.series.forEach(e=>{e.symbolSize=ee.value}),c.value.setOption(a)});const it=()=>{ee.value=7,ye.value=!1;const a=c.value.getOption();a.series.forEach(e=>{e.symbolSize=ee.value,e.showAllSymbol=!1}),c.value.setOption(a)},Se=u(!1);R(()=>x.value,()=>{W.value={},Object.keys(x.value).forEach(a=>{const e=x.value[a].seriesName,s=x.value[a].data,l=s.map(p=>{const h=V.getAllTrunk().trunk1.spot.find(q=>q.name===p.seriesName);if(h!==void 0)return h.id}).filter(p=>p!==void 0);W.value[e]===void 0&&(W.value[e]=[]),l.length>0&&(W.value[e]={date:x.value[a].date,timerange:x.value[a].timerange,type:x.value[a].type,data:l.map((p,h)=>({idSpot:p,avgPsiValues:s[h].yValue}))})})},{deep:!0});const gt=(a,e)=>{const d=W.value[a].data;for(let l=0;l<d.length;l++)if(d[l].idSpot==e)return d[l].avgPsiValues.toFixed(2)};ot(()=>{var a;if(W.value!=null&&(Le=Object.keys(W.value),xe.value!=null)){m.value=[];const e=xe.value,s=(a=W.value[e])==null?void 0:a.data;Le.filter(l=>l!==e).forEach(l=>{const p=W.value[l].data,h=[];oe.value.trunk1.spot.forEach((q,et)=>{const tt=q.id,lt=s.find(Ue=>Ue.idSpot===tt),kt=p.find(Ue=>Ue.idSpot===tt);if(lt&&kt){const Ue=lt.avgPsiValues.toFixed(2)-kt.avgPsiValues.toFixed(2);h[et]=Ue}else h[et]=0}),m.value.push({dropKey:l,deltas:h})})}});const rt=a=>a.spot,Ze=u(!1),Re=u(""),je=u(""),Lt=()=>{$.value=!1,Ze.value=!0,Y.value=!0},At=()=>{Ze.value=!1,Y.value=!1},Et=()=>{if(Re.value==""||je.value==""){b.notifyShowError("Name and description are required");return}b.notifyShow("Saving preset. Please wait..."),Ze.value=!1;const a={name:Re.value,desc:je.value,selectedModel:J.value,selectedMethod:N.value,selections:x.value,seekerValue:F.value};j("onDataSave",a),Re.value="",je.value=""},Vt=()=>{j("onLoadPreset")},zt=()=>{b.notifyShow("Snapshot loaded"),J.value=D.snapShots.selectedModel,N.value=D.snapShots.selectedMethod,setTimeout(()=>{F.value=D.snapShots.seekerValue,setTimeout(()=>{x.value=D.snapShots.selection;const a=c.value.getOption().series;Object.keys(x.value).forEach(s=>{const d=x.value[s];d.type==="normal"?(a.push({type:"line",name:"Normal",xAxisIndex:0,data:[],markLine:{symbol:"image://https://png.pngtree.com/png-clipart/20230325/original/pngtree-petroleum-workers-or-miners-vector-png-image_9004441.png",symbolSize:42,data:[{xAxis:d.index}],lineStyle:{color:"red",width:2,type:"dotted"},label:{show:!0,formatter:"Normal",position:"insideEndTop"}}}),xe.value=d.seriesName):a.push({type:"line",name:d.name,xAxisIndex:0,data:[],markLine:{symbol:"image://https://gpng.net/wp-content/uploads/ROBBER.png",symbolSize:35,data:[{xAxis:d.index,symbolRotate:180}],lineStyle:{color:"blue",width:2,type:"dotted"},label:{show:!0,formatter:d.name,position:"insideEndTop"}}})}),c.value.setOption({series:a});const e=c.value.getOption();c.value.clear(),c.value.setOption(e)},1e3),_(F.value)},3e3)};ot(()=>{c.value&&D.snapShots&&Object.keys(D.snapShots).length>0&&zt()});const Ft=(a,e)=>{let s=!0;return e.forEach(d=>{a<d&&(s=!1)}),s},Nt=(a,e)=>{let s=0;e.forEach(l=>{s<l&&(s=l)});let d=!0;return e.forEach(l=>{a<l&&l<s&&(d=!1)}),d},Rt=(a,e)=>{let s=0;e.forEach(p=>{s<p&&(s=p)});let d=0;e.forEach(p=>{d<p&&p<s&&(d=p)});let l=!0;return e.forEach(p=>{a<p&&p<d&&(l=!1)}),l},jt=(a,e)=>{let s=!0;return e.forEach(d=>{a>d&&(s=!1)}),s},It=()=>{c.value&&c.value.resize()},Ie=u(!1);return R(()=>G.value,()=>{G.value<0&&(G.value=0);const a=c.value.getOption();a.yAxis[0].max=G.value,c.value.setOption(a)}),(a,e)=>{const s=Ke("font-awesome-icon"),d=Ke("center");return o(),i(T,null,[be.value?(o(),i("div",tl,[t("div",ll,[e[34]||(e[34]=t("h2",null,[t("b",null,"Select Range")],-1)),e[35]||(e[35]=t("p",{style:{padding:"0",margin:"0"}},"Automatically plays the playback based on current setup",-1)),n(Me,{"in-label":"Speed","model-value":Z.value,"onUpdate:modelValue":e[0]||(e[0]=l=>Z.value=l)},{default:w(()=>e[31]||(e[31]=[t("option",{value:"1000"},"Slowest",-1),t("option",{value:"500"},"Slower",-1),t("option",{value:"300"},"Moderate",-1),t("option",{value:"250"},"Faster",-1),t("option",{value:"200"},"Fastest",-1)])),_:1},8,["model-value"]),n(ce,{"in-type":"date","in-label":"Date 1","model-value":ve.value,"onUpdate:modelValue":e[1]||(e[1]=l=>ve.value=l)},null,8,["model-value"]),n(ce,{"in-type":"date","in-label":"Date 2","model-value":ue.value,"onUpdate:modelValue":e[2]||(e[2]=l=>ue.value=l)},null,8,["model-value"]),t("div",al,[n(C,{onClick:Dt,"bt-disabled":!1,style:{width:"fit-content"}},{default:w(()=>e[32]||(e[32]=[v("Apply Filter")])),_:1}),n(C,{onClick:e[3]||(e[3]=l=>be.value=!be.value),"bt-disabled":!1,style:{width:"fit-content"}},{default:w(()=>e[33]||(e[33]=[v("Cancel ")])),_:1})])])])):S("",!0),Ve.value?(o(),i("div",ol,[t("div",sl,[e[38]||(e[38]=t("h2",null,[t("b",null,"Select Preference")],-1)),n(Me,{"in-label":"Select","model-value":z.value,"onUpdate:modelValue":e[4]||(e[4]=l=>z.value=l)},{default:w(()=>e[36]||(e[36]=[t("option",{value:"forward"},"Forward",-1),t("option",{value:"backward"},"Backward",-1)])),_:1},8,["model-value"]),n(C,{onClick:e[5]||(e[5]=l=>Ve.value=!Ve.value),style:{width:"fit-content"},"bt-disabled":!1},{default:w(()=>[n(s,{icon:"save"}),e[37]||(e[37]=v(" Save & Apply"))]),_:1})])])):S("",!0),e[97]||(e[97]=t("h5",{style:{"text-align":"center"}},[t("b",null,"Playback")],-1)),n(d,null,{default:w(()=>[n(Me,{style:{width:"400px"},"in-label":"Speed","model-value":Z.value,"onUpdate:modelValue":e[6]||(e[6]=l=>Z.value=l)},{default:w(()=>e[39]||(e[39]=[t("option",{value:"1000"},"Slowest",-1),t("option",{value:"500"},"Slower",-1),t("option",{value:"300"},"Moderate",-1),t("option",{value:"250"},"Faster",-1),t("option",{value:"200"},"Fastest",-1)])),_:1},8,["model-value"])]),_:1}),t("div",nl,[!$.value&&!N.value&&!J.value?(o(),te(C,{key:0,onClick:e[7]||(e[7]=l=>se.value=!se.value),"bt-disabled":!1},{default:w(()=>[n(s,{icon:"atom"}),e[40]||(e[40]=v(" Leak Detection"))]),_:1})):S("",!0),$.value?S("",!0):(o(),te(C,{key:1,onClick:Vt,"bt-disabled":!1},{default:w(()=>[n(s,{icon:"download"}),e[41]||(e[41]=v(" Import Snapshot "))]),_:1})),N.value&&J.value?(o(),te(C,{key:2,onClick:e[8]||(e[8]=l=>he.value=!he.value),"bt-disabled":!1},{default:w(()=>[n(s,{icon:"sliders"}),e[42]||(e[42]=v(" Settings "))]),_:1})):S("",!0),N.value&&J.value?(o(),te(C,{key:3,style:{background:"red"},onClick:nt,"bt-disabled":!1},{default:w(()=>[n(s,{icon:"close"}),e[43]||(e[43]=v(" Quit Prediction"))]),_:1})):S("",!0)]),t("div",il,[t("div",rl,[t("label",{class:le([`${f(b).textTheme}`]),style:{cursor:"pointer",padding:"10px",border:"1px solid #ccc","margin-bottom":"1rem","border-radius":"10px"}},[qe(t("input",{"onUpdate:modelValue":e[9]||(e[9]=l=>Q.value=l),type:"checkbox"},null,512),[[Be,Q.value]]),e[44]||(e[44]=v(" Auto-replay "))],2),t("label",{class:le([`${f(b).textTheme}`]),style:{cursor:"pointer",padding:"10px",border:"1px solid #ccc","margin-bottom":"1rem","border-radius":"10px"}},[qe(t("input",{"onUpdate:modelValue":e[10]||(e[10]=l=>U.value=l),type:"checkbox"},null,512),[[Be,U.value]]),e[45]||(e[45]=v(" Autoplay on navigating "))],2),t("label",{class:le([`${f(b).textTheme}`]),style:{cursor:"pointer",padding:"10px",border:"1px solid #ccc","margin-bottom":"1rem","border-radius":"10px"}},[qe(t("input",{"onUpdate:modelValue":e[11]||(e[11]=l=>L.value=l),type:"checkbox"},null,512),[[Be,L.value]]),e[46]||(e[46]=v(" Self Navigate "))],2),L.value?(o(),te(C,{key:0,onClick:e[12]||(e[12]=l=>Ve.value=!Ve.value),"bt-disabled":!1,type:"button",class:"slfnavbtn"},{default:w(()=>[n(s,{icon:"sliders"})]),_:1})):S("",!0)]),t("div",ul,[re.value?(o(),i("label",{key:0,class:le([`${f(b).textTheme}`]),style:{border:"1px solid #ccc",padding:"10px","border-radius":"10px"}},[v(y(f(O)(ve.value).format("ddd, DD MMM YY"))+"    ",1),n(s,{icon:z.value=="forward"?"caret-right":"caret-left"},null,8,["icon"]),v("    "+y(f(O)(ue.value).format("ddd, DD MMM YY")),1)],2)):S("",!0),re.value?(o(),i("label",{key:1,class:le([`${f(b).textTheme}`]),style:{cursor:"pointer",padding:"10px",border:"1px solid #ccc","border-radius":"10px"}},[qe(t("input",{"onUpdate:modelValue":e[13]||(e[13]=l=>Qe.value=l),type:"checkbox"},null,512),[[Be,Qe.value]]),e[47]||(e[47]=v(" Repeat "))],2)):S("",!0),n(C,{onClick:e[14]||(e[14]=l=>be.value=!be.value),"bt-disabled":!1,type:"button",class:"slfnavbtn"},{default:w(()=>[n(s,{icon:"calendar"})]),_:1}),ve.value&&ue.value?(o(),te(C,{key:2,onClick:ze,"bt-disabled":!1,class:"slfnavbtn"},{default:w(()=>[n(s,{icon:"close"})]),_:1})):S("",!0)])]),t("div",dl,[n(C,{"bt-disabled":ke.value,onClick:He},{default:w(()=>[n(s,{icon:"backward"}),v("    "+y(f(O)(Pe.value).format("ddd, DD MMM YY")),1)]),_:1},8,["bt-disabled"]),t("span",pl,[t("b",{style:B({color:`${f(b).accentColor}`})},y(f(O)(D.initDateFilter).format("ddd, DD MMM YY")),5),e[51]||(e[51]=t("br",null,null,-1)),re.value?(o(),i("span",{key:0,class:le([`${f(b).textTheme}`]),style:{"font-size":"11px"}},[e[48]||(e[48]=v("Stops at: ")),t("b",null,y(f(O)(ue.value).format("ddd, DD MMM YY")),1)],2)):(o(),i(T,{key:1},[Q.value?(o(),i("span",vl,[e[49]||(e[49]=v("Repeating: ")),t("b",null,y(f(O)(D.initDateFilter).format("ddd, DD MMM YY")),1)])):(o(),i(T,{key:1},[$e.value?(o(),i("span",fl,"[End of playback  ·  Autoplay stopped]")):(o(),i("span",cl,[e[50]||(e[50]=v("Upcoming: ")),t("b",null,y(f(O)(xt()).format("ddd, DD MMM YY")),1)]))],64))],64))]),n(C,{"bt-disabled":$e.value,onClick:De},{default:w(()=>[v(y(f(O)(Ye.value).format("ddd, DD MMM YY"))+"    ",1),n(s,{icon:"forward"})]),_:1},8,["bt-disabled"])]),t("div",{style:B([{position:"relative",width:"100%"},{marginBottom:Object.keys(x.value).length>1?"8rem":"0"}])},[t("div",{ref_key:"heatMap",ref:X,style:{width:"100%",height:"600px"}},null,512),t("div",yl,[t("div",ml,[$.value?S("",!0):(o(),i("button",{key:0,style:{"z-index":"1",position:"relative"},onClick:e[15]||(e[15]=l=>$.value=!$.value),class:"controlbtn",type:"button"},[n(s,{icon:"play"})])),$.value?(o(),i("button",{key:1,style:{"z-index":"1",position:"relative"},onClick:e[16]||(e[16]=l=>$.value=!$.value),class:"controlbtn",type:"button"},[n(s,{icon:"pause"})])):S("",!0)]),t("div",bl,[t("input",{onChange:pe,type:"range",min:0,max:D.initPlaybackDatas.length,value:F.value,class:"slider"},null,40,gl)]),t("div",null,[!$.value&&F.value==D.initPlaybackDatas.length?(o(),i("button",{key:0,onClick:A,class:"controlbtn",type:"button"},[n(s,{icon:"undo"})])):S("",!0)])]),Object.keys(x.value).length?(o(),i("div",kl,[t("div",hl,[(o(!0),i(T,null,K(x.value,(l,p)=>(o(),i("div",{key:p,class:"selection-item",onClick:h=>Mt(l,p)},[t("h5",{style:B({color:l.type=="normal"?"red":"blue"})},[t("b",null,y(l.name),1)],4),(o(!0),i(T,null,K(l.data,h=>(o(),i("div",{key:h.seriesName},[h.seriesName!="Normal"&&!h.seriesName.includes("Drop")?(o(),i("span",xl,[t("span",Dl,y(h.seriesName),1),e[52]||(e[52]=v()),t("span",Sl,[t("b",null,y(h.yValue)+" PSI",1)])])):S("",!0)]))),128))],8,wl))),128))]),t("div",Ml,[e[57]||(e[57]=t("h4",{style:{"text-align":"center"}},[t("b",null,"Pressure Distribution")],-1)),E.value?(o(),te(el,{key:0,style:{width:"100%"},data:f(W),"selected-spot":"trunk1"},null,8,["data"])):S("",!0),t("img",{src:f(Gt),alt:"map",style:{width:"100%",height:"600px","border-radius":"10px","object-fit":"contain"}},null,8,Cl),t("div",$l,[t("h5",Ol,[t("b",null,[n(s,{icon:"oil-well"}),e[53]||(e[53]=v(" Selected Pressures"))])]),t("table",Yl,[t("thead",null,[t("tr",{style:{padding:"5px"},class:le([`${f(b).textTheme}`])},[t("th",{style:B({border:`1px solid ${f(b).accentColor}`})},"ACTION",4),t("th",{style:B({border:`1px solid ${f(b).accentColor}`})},"PINNED SERIES",4),(o(!0),i(T,null,K(rt(oe.value.trunk1),(l,p)=>(o(),i("th",{style:B({border:`1px solid ${f(b).accentColor}`}),key:p},y(l.name),5))),128))],2)]),t("tbody",null,[(o(!0),i(T,null,K(f(Le),(l,p)=>(o(),i("tr",{key:p},[t("td",{style:B({border:`1px solid ${f(b).accentColor}`,position:"relative",textTransform:"uppercase",fontWeight:"bold"})},null,4),t("td",{class:le([`${f(b).textTheme}`]),style:B({border:`1px solid ${f(b).accentColor}`,position:"relative",textTransform:"uppercase",fontWeight:"bold"})},[v(y(f(W)[l].date),1),e[54]||(e[54]=t("br",null,null,-1)),v(" "+y(f(W)[l].timerange),1),e[55]||(e[55]=t("br",null,null,-1)),v(" "+y(f(W)[l].type),1)],6),(o(!0),i(T,null,K(rt(oe.value.trunk1),(h,q)=>(o(),i("td",{style:B({border:`1px solid ${f(b).accentColor}`}),class:le([`${f(b).textTheme}`]),key:q},[gt(l,h.id)?(o(),i(T,{key:0},[v(y(gt(l,h.id)),1)],64)):(o(),i(T,{key:1},[v("0.00")],64))],6))),128))]))),128))])]),t("h5",Pl,[t("b",null,[n(s,{icon:"turn-down"}),e[56]||(e[56]=v(" Delta"))])]),t("table",_l,[t("thead",null,[t("tr",{style:{padding:"5px"},class:le([`${f(b).textTheme}`])},[t("th",{style:B({border:`1px solid ${f(b).accentColor}`})},"DROPS",4),t("th",{style:B({border:`1px solid ${f(b).accentColor}`})},"PINNED SERIES",4),(o(!0),i(T,null,K(rt(oe.value.trunk1),(l,p)=>(o(),i("th",{style:B({border:`1px solid ${f(b).accentColor}`}),key:p},y(l.name),5))),128))],2)]),t("tbody",null,[(o(!0),i(T,null,K(m.value,(l,p)=>(o(),i("tr",{key:p},[t("td",{style:B({border:`1px solid ${f(b).accentColor}`})},y(p+1),5),t("td",{style:B({border:`1px solid ${f(b).accentColor}`})},y(l.dropKey.split(".")[0]+"."+l.dropKey.split(".")[1]+"."+l.dropKey.split(".")[2]),5),(o(!0),i(T,null,K(l.deltas,(h,q)=>(o(),i("td",{key:q,style:B({border:`1px solid ${f(b).accentColor}`})},[Ft(h,l.deltas)?(o(),i("span",Tl,y(h.toFixed(2)),1)):Nt(h,l.deltas)?(o(),i("span",Ll,y(h.toFixed(2)),1)):Rt(h,l.deltas)?(o(),i("span",Al,y(h.toFixed(2)),1)):jt(h,l.deltas)?(o(),i("span",El,y(h.toFixed(2)),1)):(o(),i("span",Vl,y(h.toFixed(2)),1))],4))),128))]))),128))])])])])])):S("",!0)],4),de.value?(o(),i("div",zl,e[58]||(e[58]=[t("img",{src:"https://cdn.dribbble.com/users/1138184/screenshots/3796132/oil.gif"},null,-1)]))):S("",!0),se.value?(o(),i("div",Fl,[t("div",Nl,[t("button",{onClick:Ct,class:"modelpick-dismiss"},[n(s,{icon:"times"})]),e[61]||(e[61]=t("h2",null,[t("b",null,"Leak Detection")],-1)),n(Me,{"in-label":"Select Model","model-value":J.value,"onUpdate:modelValue":e[17]||(e[17]=l=>J.value=l)},{default:w(()=>e[59]||(e[59]=[t("option",{value:""},"Select...",-1),t("option",{value:"normal_pick"},"Normal Pick",-1),t("option",{value:"ranged_pick"},"Ranged Pick",-1)])),_:1},8,["model-value"]),n(Me,{"in-label":"Select Prediction Method","model-value":N.value,"onUpdate:modelValue":e[18]||(e[18]=l=>N.value=l)},{default:w(()=>e[60]||(e[60]=[t("option",{value:""},"Select method...",-1),t("option",{value:"rf_single"},"RF Single-leak",-1),t("option",{value:"rf4_multi"},"RF4 Multi-leak",-1),t("option",{value:"dt_single"},"DT Single-leak",-1),t("option",{value:"dt4_multi"},"DT4 Multi-leak",-1),t("option",{value:"lr_single"},"LR Single-leak",-1),t("option",{value:"dynamic"},"Dynamic",-1)])),_:1},8,["model-value"]),n(C,{onClick:e[19]||(e[19]=l=>se.value=!se.value),style:{width:"fit-content","margin-top":"0.5rem"},"bt-disabled":!1},{default:w(()=>[v(y(Fe.value?"Update Preference":"Start Picking"),1)]),_:1})])])):S("",!0),Object.keys(x.value).length>1&&!Se.value?(o(),i("div",Rl,[t("button",{type:"button",class:"predict-action-hide",onClick:e[20]||(e[20]=l=>Se.value=!Se.value)},[n(s,{icon:"eye-slash"})]),t("div",jl,[e[62]||(e[62]=v("Picking Model: ")),t("b",null,y(J.value.split("_").map(l=>l.charAt(0).toUpperCase()+l.slice(1)).join(" ")),1),e[63]||(e[63]=v(" ··· Prediction Method: ")),t("b",null,y(N.value.split("_").map(l=>l.charAt(0).toUpperCase()+l.slice(1)).join(" ")),1)]),t("div",Il,[e[64]||(e[64]=v("Num of drops: ")),t("b",null,y(Object.keys(x.value).filter(l=>x.value[l].type=="drop").length),1)]),t("div",Ul,[n(C,{"bt-size":"small",onClick:Yt,"bt-disabled":!1,style:{width:"fit-content"}},{default:w(()=>[n(s,{icon:"check"}),e[65]||(e[65]=v(" Predict "))]),_:1}),n(C,{"bt-size":"small",onClick:Lt,"bt-disabled":!1,style:{width:"fit-content",background:"rgb(0,150,255)"}},{default:w(()=>[n(s,{icon:"plus"}),e[66]||(e[66]=v(" Create Snapshot "))]),_:1}),n(C,{"bt-size":"small",onClick:$t,"bt-disabled":!1,style:{width:"fit-content",background:"#666"}},{default:w(()=>[n(s,{icon:"refresh"}),e[67]||(e[67]=v(" Change Method "))]),_:1}),n(C,{"bt-size":"small",onClick:Ee,"bt-disabled":!1,style:{width:"fit-content",background:"orange"}},{default:w(()=>[n(s,{icon:"trash"}),e[68]||(e[68]=v(" Clear Selection "))]),_:1}),n(C,{"bt-size":"small",onClick:nt,"bt-disabled":!1,style:{width:"fit-content",background:"red"}},{default:w(()=>[n(s,{icon:"close"}),e[69]||(e[69]=v(" Quit Prediction "))]),_:1})])])):S("",!0),Ne.value?(o(),i("div",ql,[t("div",{class:le(["leak-body",[`${f(b).mTheme}`]])},[t("button",{type:"button",onClick:e[21]||(e[21]=l=>Ne.value=!1),class:"leak-dismiss"},[n(s,{icon:"times"})]),t("div",{class:"l-left",style:B({width:_e.value?"40%":"100%"})},[e[84]||(e[84]=t("h4",{style:{"font-weight":"bold"}},"Leak Analysis",-1)),e[85]||(e[85]=t("hr",null,null,-1)),H.value?(o(!0),i(T,{key:0},K(H.value,(l,p)=>(o(),i("div",{class:"analysis-set",key:p},[l!=!1?(o(),i(T,{key:0},[t("h4",Bl,[t("b",null," DROP "+y(l.drop),1)]),t("p",null,[e[82]||(e[82]=v(" Result: ")),l!=!1&&l.suspectLocation.leak?(o(),i(T,{key:0},[e[80]||(e[80]=t("b",{style:{color:"red"}},"Possible leak detected!",-1)),t("div",Kl,[t("table",Wl,[t("tr",null,[e[70]||(e[70]=t("th",{style:{border:"1px solid #ccc",padding:"10px"}},"Estimated Leak Point",-1)),e[71]||(e[71]=t("th",{style:{border:"1px solid #ccc",padding:"10px"}},"Date & Time",-1)),l.suspectLocation.leakData.pu_location?(o(),i("th",Hl," PU ")):S("",!0),l.suspectLocation.leakData.coordinate?(o(),i("th",Gl," Coordinate ")):S("",!0)]),t("tbody",null,[t("tr",null,[t("td",Ql,y(l.suspectLocation.leakData.leak_point)+" KM ",1),t("td",null,[t("b",null,y(f(O)(l.date).format("dddd, DD MMM YYYY")),1),e[72]||(e[72]=t("br",null,null,-1)),v(y(l.time)+" WIB ",1)]),l.suspectLocation.leakData.pu_location?(o(),i("td",Jl," KM "+y(l.suspectLocation.leakData.pu_location),1)):S("",!0),l.suspectLocation.leakData.coordinate?(o(),i("td",Xl,[e[74]||(e[74]=v(" LatLng: ")),t("code",null,y(l.suspectLocation.leakData.coordinate.latitude+", "+l.suspectLocation.leakData.coordinate.longitude),1),e[75]||(e[75]=t("br",null,null,-1)),e[76]||(e[76]=v(" DMS: ")),t("code",null,y(`${Xe(l.suspectLocation.leakData.coordinate.latitude)}, ${Xe(l.suspectLocation.leakData.coordinate.longitude)}`),1),e[77]||(e[77]=t("br",null,null,-1)),n(C,{onClick:h=>Tt(`LATLNG: ${l.suspectLocation.leakData.coordinate.latitude}, ${l.suspectLocation.leakData.coordinate.longitude}
DMS: ${Xe(l.suspectLocation.leakData.coordinate.latitude)}, ${Xe(l.suspectLocation.leakData.coordinate.longitude)}`),style:{"margin-top":"5px"},"bt-disabled":!1,"bt-size":"small"},{default:w(()=>[n(s,{icon:"copy"}),e[73]||(e[73]=v(" Copy Coord "))]),_:2},1032,["onClick"])])):S("",!0)])])])]),l.suspectLocation.leakData.coordinate?S("",!0):(o(),i("p",Zl,[n(s,{icon:"info-circle"}),e[78]||(e[78]=v(" Map view and PU Location data is currently not supported for this line "))])),n(C,{onClick:h=>_t(l.suspectLocation.leakData.coordinate,l.suspectLocation.leakData.leak_point,l.suspectLocation.leakData.pu_location),"bt-disabled":!l.suspectLocation.leakData.coordinate},{default:w(()=>[n(s,{icon:"map-marker"}),e[79]||(e[79]=v(" Pinpoint on Map"))]),_:2},1032,["onClick","bt-disabled"]),l.suspectLocation.leakData.coordinate?(o(),i("a",{key:1,class:"gmaps",target:"_blank",href:`https://www.google.com/maps?q=${l.suspectLocation.leakData.coordinate.latitude},${l.suspectLocation.leakData.coordinate.longitude}`,style:{"margin-left":"0.5rem"}},"Google Maps",8,ea)):S("",!0)],64)):(o(),i(T,{key:1},[e[81]||(e[81]=t("b",{style:{color:"#555"}},"No leak detected",-1)),t("ol",ta,[(o(!0),i(T,null,K(l.suspectLocation.probabilities,(h,q)=>(o(),i("li",{key:q},y(h),1))),128))])],64))])],64)):(o(),i("h6",la,[t("b",null,"Analysis on Dataset "+y(p+1),1),e[83]||(e[83]=t("b",{style:{color:"#555"}},"Tidak ada indikasi",-1)),t("ol",aa,[(o(!0),i(T,null,K(l.suspectLocation.probabilities,(h,q)=>(o(),i("li",{key:q},y(h),1))),128))])]))]))),128)):(o(),te(Xt,{key:1,message:"Calculating leak probabilities..."}))],4),_e.value?(o(),i("div",{key:0,class:"l-right",style:B({width:_e.value?"60%":"100%",position:"relative"})},[e[86]||(e[86]=t("h4",{style:{"font-weight":"bold"}},"Map View",-1)),e[87]||(e[87]=t("hr",null,null,-1)),n(Qt,{latitude:Je.value.latitude,longitude:Je.value.longitude,"leak-point":mt.value,"pu-location":bt.value},null,8,["latitude","longitude","leak-point","pu-location"])],4)):S("",!0)],2)])):S("",!0),he.value?(o(),i("div",oa,[t("div",sa,[e[90]||(e[90]=t("h5",null,[t("b",null,"Prediction Mode Preferences")],-1)),e[91]||(e[91]=t("hr",null,null,-1)),n(ce,{"in-label":"Dot Symbol Size","model-value":ee.value,"onUpdate:modelValue":e[22]||(e[22]=l=>ee.value=l),"in-type":"number"},null,8,["model-value"]),t("label",na,[qe(t("input",{type:"checkbox","onUpdate:modelValue":e[23]||(e[23]=l=>ye.value=l)},null,512),[[Be,ye.value]]),e[88]||(e[88]=t("div",{style:{display:"flex","flex-flow":"column","margin-left":"0.7rem"}},[t("span",{style:{"font-size":"13px"}},[t("b",null,"Show all dots")]),t("span",{style:{"font-size":"11px"}},"Show all dots or reduce the dot placement")],-1))]),n(C,{onClick:e[24]||(e[24]=l=>he.value=!he.value),style:{width:"fit-content"},"bt-disabled":!1},{default:w(()=>e[89]||(e[89]=[v("Save Preferences")])),_:1})])])):S("",!0),Ze.value?(o(),i("div",ia,[t("div",ra,[e[94]||(e[94]=t("h2",null,[t("b",null,"Snapshot")],-1)),n(ce,{"in-label":"Name","model-value":Re.value,"onUpdate:modelValue":e[25]||(e[25]=l=>Re.value=l),"in-type":"text"},null,8,["model-value"]),n(ce,{"in-label":"Description","model-value":je.value,"onUpdate:modelValue":e[26]||(e[26]=l=>je.value=l),"in-type":"text"},null,8,["model-value"]),t("div",ua,[n(C,{onClick:Et,style:{width:"fit-content"},"bt-disabled":!1},{default:w(()=>[n(s,{icon:"save"}),e[92]||(e[92]=v(" Create "))]),_:1}),n(C,{onClick:At,style:{width:"fit-content"},"bt-disabled":!1},{default:w(()=>e[93]||(e[93]=[v("Cancel ")])),_:1})])])])):S("",!0),Ie.value?(o(),i("div",da,[t("div",pa,[t("button",va,[n(s,{icon:"times"})]),e[96]||(e[96]=t("h4",null,[t("b",null,"Playback Chart Option")],-1)),n(ce,{"in-label":"Y Axis Max","in-type":"number","model-value":G.value,"onUpdate:modelValue":e[27]||(e[27]=l=>G.value=l)},null,8,["model-value"]),n(C,{"bt-size":"normal",onClick:e[28]||(e[28]=l=>Ie.value=!Ie.value),"bt-type":"button","bt-disabled":!1,style:{width:"fit-content"}},{default:w(()=>e[95]||(e[95]=[v("Apply")])),_:1})])])):S("",!0),Se.value?(o(),i("button",{key:9,type:"button",onClick:e[29]||(e[29]=l=>Se.value=!Se.value),class:"predict-action-show"},[n(s,{icon:"eye"})])):S("",!0),Se.value?S("",!0):(o(),i("button",{key:10,type:"button",onClick:It,class:"chart-resize"},[n(s,{icon:"left-right"})])),t("button",{type:"button",onClick:e[30]||(e[30]=l=>Ie.value=!Ie.value),class:"chart-options"},[n(s,{icon:"gear"})])],64)}}}),fa=pt(ca,[["__scopeId","data-v-a843c9ec"]]),ya={class:"dateselect-window"},ma={class:"dateselect-inner"},ba={class:"calendar-navigation"},ga={style:{"font-size":"19px"}},ka={class:"calendar-days"},ha=["onClick"],wa={key:0,style:{color:"orange","font-weight":"bold"}},xa={key:1},Da={style:{"margin-top":"1rem",display:"flex","flex-flow":"row nowrap","justify-content":"space-between"}},Sa={style:{display:"flex","flex-flow":"row nowrap",gap:"0.3rem"}},Ma=st({__name:"DateSelectView",props:{calendarTitle:{type:String,default:"Select Dates"},initialDates:{type:Array,default:()=>[]}},emits:["onApply","onClose"],setup(Ce,{emit:ae}){const P=u(O().format("YYYY-MM-DD")),V=u([]),j=ae,b=Ce;R(()=>V.value,L=>{V.value=L.sort((g,E)=>new Date(g).getTime()-new Date(E).getTime())},{deep:!0});const z=()=>{j("onApply",V.value)};return ot(()=>{b.initialDates.length&&(V.value=b.initialDates)}),(L,g)=>{const E=Ke("font-awesome-icon");return o(),i("div",ya,[t("div",ma,[t("h4",null,[t("b",null,[n(E,{icon:"calendar"}),v(" "+y(b.calendarTitle),1)])]),g[8]||(g[8]=t("hr",null,null,-1)),t("div",ba,[t("button",{class:"navmonth-btn",onClick:g[0]||(g[0]=Y=>P.value=f(O)(P.value).subtract(1,"month").format("YYYY-MM-DD"))},[n(E,{icon:"angle-left"}),v(" "+y(f(O)(P.value).subtract(1,"month").format("MMMM")),1)]),t("h3",ga,[t("b",null,y(f(O)(P.value).format("MMMM YYYY")),1)]),t("button",{class:"navmonth-btn",onClick:g[1]||(g[1]=Y=>P.value=f(O)(P.value).add(1,"month").format("YYYY-MM-DD"))},[v(y(f(O)(P.value).add(1,"month").format("MMMM"))+" ",1),n(E,{icon:"angle-right"})])]),g[9]||(g[9]=Bt('<div class="calendar-days" data-v-0be19428><div class="calendar-day-week" data-v-0be19428>Sen</div><div class="calendar-day-week" data-v-0be19428>Sel</div><div class="calendar-day-week" data-v-0be19428>Rab</div><div class="calendar-day-week" data-v-0be19428>Kam</div><div class="calendar-day-week" data-v-0be19428>Jum</div><div class="calendar-day-week" data-v-0be19428>Sab</div><div class="calendar-day-week" data-v-0be19428>Min</div></div>',1)),t("div",ka,[(o(!0),i(T,null,K(f(O)(P.value).startOf("month").day(),Y=>(o(),i("div",{key:Y,class:"calendar-day-unclickable"}))),128)),(o(!0),i(T,null,K(f(O)(P.value).daysInMonth(),Y=>(o(),i("div",{key:Y,class:"calendar-day",onClick:G=>V.value.includes(f(O)(P.value).date(Y).format("YYYY-MM-DD"))?V.value.splice(V.value.indexOf(f(O)(P.value).date(Y).format("YYYY-MM-DD")),1):V.value.push(f(O)(P.value).date(Y).format("YYYY-MM-DD")),style:B({background:V.value.includes(f(O)(P.value).date(Y).format("YYYY-MM-DD"))?"#aaaaaa":"#f0f0f0"})},[f(O)(P.value).date(Y).format("YYYY-MM-DD")==f(O)().format("YYYY-MM-DD")?(o(),i("span",wa,[v(y(Y)+" ",1),g[4]||(g[4]=t("b",{style:{"font-size":"7px"}},"TODAY",-1))])):(o(),i("span",xa,y(Y),1))],12,ha))),128)),(o(!0),i(T,null,K(6-f(O)(P.value).endOf("month").day(),Y=>(o(),i("div",{key:Y,class:"calendar-day-unclickable"}))),128))]),t("div",Da,[n(C,{onClick:z,"bt-disabled":!V.value.length},{default:w(()=>g[5]||(g[5]=[v("Apply Selections")])),_:1},8,["bt-disabled"]),t("div",Sa,[V.value.length?(o(),te(C,{key:0,style:{background:"red"},onClick:g[2]||(g[2]=Y=>V.value=[]),"bt-disabled":!1},{default:w(()=>[n(E,{icon:"trash"}),g[6]||(g[6]=v(" Clear"))]),_:1})):S("",!0),n(C,{onClick:g[3]||(g[3]=Y=>j("onClose")),"bt-disabled":!1},{default:w(()=>[n(E,{icon:"times"}),g[7]||(g[7]=v(" Close"))]),_:1})])])])])}}}),Ca=pt(Ma,[["__scopeId","data-v-0be19428"]]),$a={class:"row"},Oa={class:"col-md-3"},Ya=["value"],Pa={style:{display:"flex","flex-flow":"row nowrap","align-items":"center",gap:"1rem"}},_a={style:{display:"flex","flex-flow":"row nowrap",gap:"1rem","align-items":"center"}},Ta={class:"col-md-12",style:{position:"relative"}},La={key:0,class:"loaders"},Aa={key:0,class:"load-window"},Ea={class:"load-inner"},Va={style:{display:"flex","flex-flow":"column","align-items":"flex-start",gap:"0.2rem"}},za={style:{margin:"0",padding:"0"}},Fa={style:{"font-size":"9px",color:"red"}},Na={style:{"font-size":"11px","margin-bottom":"1rem"}},Ra={style:{display:"flex","flex-flow":"row wrap","font-size":"11px",gap:"0.2rem",border:"1px solid #ccc",width:"100%",padding:"10px","border-radius":"10px"}},ja={style:{color:"#555",padding:"5px",background:"#ddd","border-radius":"5px"}},Ia={style:{display:"flex","flex-flow":"row wrap","font-size":"11px",gap:"0.2rem",border:"1px solid #ccc",width:"100%",padding:"10px","border-radius":"10px"}},Ua={style:{color:"#555",padding:"10px",background:"#eee","border-radius":"5px","text-align":"center"}},qa={style:{display:"flex","flex-flow":"row wrap","font-size":"12px",background:"#eee",padding:"10px","border-radius":"10px",border:"1px solid #ccc",width:"100%"}},Ba={style:{"margin-right":"10px","font-weight":"bold"}},Ka={style:{"font-weight":"bold"}},Wa={style:{"font-weight":"bold"}},Ha={style:{"font-weight":"bold"}},Ga={style:{display:"flex","flex-flow":"row nowrap",gap:"0.3rem"}},Qa={key:1,style:{display:"flex","flex-flow":"column","align-items":"center","justify-content":"center",gap:"1rem"}},Ja={style:{"font-size":"30px"}},Xa=st({__name:"PlaybackFol",setup(Ce){const ae=ut(),P=ht();P.asideToggle(!1);const V=u(ae.getAllTrunk()),j=u("trunk1"),b=u();b.value=Object.keys(V.value);const z=u(5),L=u(),g=u([]),E=u(0),Y=u([]),G=u(!1),D=u(!1),X=u(!1),c=u(!0),oe=u({}),F=wt();u([]);const fe=()=>{E.value++,g.value.push(null)};dt(()=>{const m=F.params.saveid;m?setTimeout(async()=>{const r="https://rtunode.findingoillosses.com/api/v1/getpresetbyid",M={key:m},k=await at.post(r,M),_=k.data.status,I=k.data.data;if(_===200){const A=I;Y.value=[],g.value=[];const pe=A.dates;E.value=0,z.value=A.timerange,L.value=pe[0];for(let me=1;me<pe.length;me++)fe();setTimeout(()=>{document.querySelectorAll('input[type="date"]').forEach((me,De)=>{me.value=pe[De],g.value[De]=me}),Z(),oe.value={name:A.name,desc:A.desc,selectedMethod:A.selectedMethod,selectedModel:A.selectedModel,selection:A.selections,seekerValue:A.seekerValue},G.value=!0},100)}else P.notifyShowError("Failed fetching snapshot!")},1e3):(We(),G.value=!0)}),R(()=>[L.value,z.value,j.value],async()=>{oe.value={},D.value=!0,await Z()});const We=()=>{const m=new Date,r=m.getFullYear(),M=String(m.getMonth()+1).padStart(2,"0"),k=String(m.getDate()).padStart(2,"0"),_=`${r}-${M}-${k}`;L.value=_},de=async m=>new Promise(async(r,M)=>{try{const k=V.value[j.value];let _=[];for(let pe=0;pe<k.spot.length;pe++)_.push(k.spot[pe].id);const I={datefilter:m,timeFilter:z.value,idFilter:_},A=await at.post(Kt.baseEnd+"api/History/getsplittedhistdata",I);r(A.data)}catch(k){M(k)}}),Z=async()=>{try{X.value=!0;let r=[...await de(L.value)];if(g.value.length>0){for(let M=0;M<g.value.length;M++){const k=g.value[M];if(k!==null){if(k.value!==L.value){const _=await de(k.value);r=r.concat(_)}}else console.log("Null")}D.value=!1}Y.value=r,X.value=!1}catch(m){console.log(m),D.value=!1,X.value=!1}},ne=async()=>new Promise(async(m,r)=>{try{X.value=!0;let k=[...await de(L.value)];if(g.value.length>0){for(let _=0;_<g.value.length;_++){const I=g.value[_];if(I!==null){if(I.value!==L.value){const A=await de(I.value);k=k.concat(A)}}else console.log("Null")}D.value=!1}Y.value=k,X.value=!1,m(!0)}catch(M){console.log(M),D.value=!1,X.value=!1,r(!1)}}),$e=(m,r)=>{g.value[r]=m,Z()},ie=()=>{E.value>0&&(E.value--,g.value.pop()),Z()},Oe=m=>{L.value=m},ge=u([]),Ye=async m=>{Pe();const r={};r.name=m.name,r.desc=m.desc,r.timerange=z.value,r.selectedModel=m.selectedModel,r.selectedMethod=m.selectedMethod,r.dates=ge.value,r.selections=m.selections,r.seekerValue=m.seekerValue,r.context="jamerfol",(await at.post("https://rtunode.findingoillosses.com/api/v1/savepreset",r)).data.status===200?(P.notifyShow("Preset has been saved!"),ge.value=[]):(P.notifyShowError("Failed saving preset!"),ge.value=[])},Pe=()=>{if(ge.value.push(L.value),g.value.length)for(let m in g.value)ge.value.push(g.value[m].value)},Q=u([]),U=u(!1),$=()=>{U.value=!0,ke()},ke=async()=>{const m={context:"jamerfol"},r=await at.post("https://rtunode.findingoillosses.com/api/v1/getpresets",m);r.data.status===200?Q.value=r.data.data:P.notifyShowError("Failed fetching snapshots!")},he=async m=>{c.value=!1,Y.value=null,g.value=[];const r=m.dates;E.value=0,z.value=m.timerange,L.value=r[0];for(let M=1;M<r.length;M++)fe();ye(r).then(async()=>{await ne().then(()=>{oe.value={name:m.name,desc:m.desc,selectedMethod:m.selectedMethod,selectedModel:m.selectedModel,selection:m.selections,seekerValue:m.seekerValue},U.value=!1,setTimeout(()=>{c.value=!0},1e3)})})},ye=m=>new Promise((r,M)=>{try{setTimeout(()=>{document.querySelectorAll('input[type="date"]').forEach((k,_)=>{k.value=m[_],g.value[_]=k}),r(!0)},50)}catch(k){M(k)}}),ee=m=>{const r=`https://jamer.findingoillosses.com/fol/playback/${m.key}`;navigator.clipboard.writeText(r).then(()=>{P.notifyShow(`${m.name} -> Link copied. CTRL+V to paste`)}),U.value=!1},we=u(!1),W=u([]),Le=m=>{W.value=m,we.value=!1,L.value=m[0],g.value=[],E.value=0;for(let r=1;r<m.length;r++)fe();setTimeout(()=>{document.querySelectorAll('input[type="date"]').forEach((r,M)=>{r.value=m[M],g.value[M]=r}),Z()},100)},Ae=()=>{g.value=[],W.value=[],E.value=0,Z()},xe=()=>{we.value=!1};return(m,r)=>{const M=Ke("font-awesome-icon");return o(),i(T,null,[n(Ut,{"context-title":"Playback"},{default:w(()=>[t("div",$a,[t("div",Oa,[n(Me,{"in-label":"Select Line","model-value":j.value,"onUpdate:modelValue":r[0]||(r[0]=k=>j.value=k)},{default:w(()=>[(o(!0),i(T,null,K(b.value,(k,_)=>(o(),i("option",{key:_,value:k},y(V.value[k].name),9,Ya))),128))]),_:1},8,["model-value"]),n(Me,{"in-label":"Time Range","model-value":z.value,"onUpdate:modelValue":r[1]||(r[1]=k=>z.value=k)},{default:w(()=>r[6]||(r[6]=[t("option",{value:"1"},"1 Menit",-1),t("option",{value:"2"},"2 Menit",-1),t("option",{value:"3"},"3 Menit",-1),t("option",{value:"4"},"4 Menit",-1),t("option",{value:"5"},"5 Menit",-1),t("option",{value:"10"},"10 Menit",-1),t("option",{value:"15"},"15 Menit",-1),t("option",{value:"30"},"30 Menit",-1),t("option",{value:"60"},"60 Menit",-1)])),_:1},8,["model-value"]),t("div",Pa,[n(ce,{"in-type":"date","in-label":"Date Filter","model-value":L.value,"onUpdate:modelValue":r[2]||(r[2]=k=>L.value=k),style:{width:"100%"}},null,8,["model-value"])]),t("div",_a,[n(C,{onClick:ie,"bt-size":"small","bt-type":"button","bt-disabled":!1},{default:w(()=>[n(M,{icon:"minus"})]),_:1}),t("span",{class:le([`${f(P).textTheme}`])},y(E.value),3),n(C,{onClick:fe,"bt-size":"small","bt-type":"button","bt-disabled":!1},{default:w(()=>[n(M,{icon:"plus"})]),_:1})]),(o(!0),i(T,null,K(E.value,(k,_)=>(o(),i("div",{key:_,style:{display:"flex","flex-flow":"row nowrap","align-items":"center",gap:"1rem"}},[n(ce,{"in-type":"date","in-label":`Date Filter ${k}`,onOnValueChange:I=>$e(I,_),style:{width:"100%"}},null,8,["in-label","onOnValueChange"])]))),128)),n(C,{"bt-size":"normal","bt-type":"button",onClick:r[3]||(r[3]=k=>we.value=!we.value),"bt-disabled":!1,style:{"margin-top":"0.5rem",width:"fit-content"}},{default:w(()=>[n(M,{icon:"calendar"}),r[7]||(r[7]=v(" Select Dates "))]),_:1}),g.value.length>0?(o(),te(C,{key:0,"bt-size":"normal","bt-type":"button",onClick:Ae,"bt-disabled":!1,style:{"margin-top":"0.5rem","margin-left":"5px",width:"fit-content",background:"red"}},{default:w(()=>[n(M,{icon:"trash"}),r[8]||(r[8]=v(" Clear Dates "))]),_:1})):S("",!0)]),t("div",Ta,[X.value&&G.value?(o(),i("div",La,r[9]||(r[9]=[t("img",{src:"https://cdn.dribbble.com/users/1138184/screenshots/3796132/oil.gif",style:{width:"350px",height:"350px","object-fit":"contain","border-radius":"20px"}},null,-1)]))):S("",!0),Y.value&&c.value?(o(),te(fa,{key:1,"snap-shots":oe.value,"selected-dates":W.value,onOnDataSave:Ye,onOnLoadPreset:$,"init-date-filter":L.value,"selected-spot":j.value,"init-playback-datas":Y.value,onOnDateChange:Oe},null,8,["snap-shots","selected-dates","init-date-filter","selected-spot","init-playback-datas"])):S("",!0)])])]),_:1}),U.value?(o(),i("div",Aa,[t("div",Ea,[t("button",{type:"button",class:"load-dismiss",onClick:r[4]||(r[4]=k=>U.value=!U.value)},[n(M,{icon:"times"})]),Q.value.length>0?(o(),i(T,{key:0},[r[15]||(r[15]=t("h2",{style:{"padding-left":"1rem"}},[t("b",null,"Saved Snapshots")],-1)),(o(!0),i(T,null,K(Q.value,(k,_)=>(o(),i("div",{class:"preset-item",key:_},[t("div",Va,[t("h5",za,[t("b",null,[v(y(k.name)+" ",1),t("sup",Fa,[t("b",null,"#"+y(k.key),1)])])]),t("div",Na,[r[10]||(r[10]=v("Description: ")),t("b",null,y(k.desc),1)]),t("div",Ra,[(o(!0),i(T,null,K(k.dates,(I,A)=>(o(),i("div",{key:A,style:{"font-weight":"bold"}},[t("div",ja,[t("b",null,[n(M,{icon:"calendar"}),v(" "+y(I),1)])])]))),128))]),t("div",Ia,[(o(!0),i(T,null,K(k.selections,(I,A)=>(o(),i("div",{key:A,style:{"font-weight":"bold",width:"150px"}},[t("div",Ua,[t("b",{style:B({color:`${I.type=="drop"?"red":"green"}`})},y(`${I.name}: (${I.timerange})`),5)])]))),128))]),t("div",qa,[t("span",Ba,[r[11]||(r[11]=v("Pick: ")),t("code",Ka,y(k.selectedModel),1)]),t("span",Wa,[r[12]||(r[12]=v("Prediction: ")),t("code",Ha,y(k.selectedMethod),1)])]),t("div",Ga,[n(C,{"bt-disabled":!1,"bt-size":"small","bt-type":"button",onClick:I=>he(k),style:{"margin-top":"1rem"}},{default:w(()=>[n(M,{icon:"plus"}),v(" Import "+y(k.name),1)]),_:2},1032,["onClick"]),n(C,{"bt-disabled":!1,"bt-size":"small","bt-type":"button",onClick:I=>ee(k),style:{"margin-top":"1rem"}},{default:w(()=>[n(M,{icon:"copy"}),r[13]||(r[13]=v(" Copy Share Link "))]),_:2},1032,["onClick"]),n(C,{"bt-disabled":!1,"bt-size":"small","bt-type":"button",onClick:r[5]||(r[5]=I=>U.value=!U.value),style:{"margin-top":"1rem",background:"red"}},{default:w(()=>[n(M,{icon:"trash"}),r[14]||(r[14]=v(" Delete "))]),_:1})])])]))),128))],64)):(o(),i("div",Qa,[t("span",Ja,[n(M,{icon:"inbox"})]),r[16]||(r[16]=t("h5",{style:{padding:"0",margin:"0"}},"No Snapshot(s) Found!",-1)),r[17]||(r[17]=t("p",{style:{padding:"0",margin:"0","text-align":"center"}},[v("To add a new Snapshot, select Normal & Drop(s) on active Leak Detection chart and click "),t("b",null,"Create Snapshot")],-1))]))])])):S("",!0),we.value?(o(),te(Ca,{key:1,"initial-dates":W.value,onOnClose:xe,onOnApply:Le},null,8,["initial-dates"])):S("",!0)],64)}}}),po=pt(Xa,[["__scopeId","data-v-fee4ceb3"]]);export{po as default};
