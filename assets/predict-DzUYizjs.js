import{a as F}from"./http-CA9uGFq8.js";const N=[[103.7970136375021,-2.099493805243171],[103.7956056123781,-2.100113123073712],[103.7944560766404,-2.099757766372572],[103.7907721899283,-2.094288737543678],[103.7913847152913,-2.093848446965421],[103.7900741031851,-2.091685148674769],[103.7899584448721,-2.090192767184724],[103.7897407335286,-2.088288417101904],[103.7883920137978,-2.082811381725315],[103.791848404545,-2.074789406746247],[103.7918828078844,-2.056340784236184],[103.795022144344,-2.05161400835461],[103.7941841253839,-2.04809340158612],[103.7924861554654,-2.036830510546856],[103.7874920367797,-2.007754441173685],[103.783429268785,-1.985516435878517],[103.7790810398948,-1.959727735887211],[103.7742822674068,-1.932313511680166],[103.7707037055431,-1.91050411512238],[103.7651290704715,-1.878671547908528],[103.7599377215253,-1.849010461152737],[103.7550951703012,-1.819631103896117],[103.753524175557,-1.812267041704817],[103.7535253772324,-1.810279647774424],[103.7529017968595,-1.807321328859274],[103.7495290236366,-1.788196330037738],[103.7473356431322,-1.775043979779626],[103.7470295409746,-1.773281484350851],[103.7464094357071,-1.769308920177515],[103.7475269346954,-1.76513745227952],[103.7480522750916,-1.764000620500642],[103.7542746402454,-1.749817212905429],[103.7538737919384,-1.741288740533017],[103.7538832500334,-1.740825295470237],[103.7537680922705,-1.739890588771685],[103.750261451185,-1.722189779035838],[103.7509151700592,-1.719188265203362],[103.7509384245413,-1.718622784503292],[103.7508538419885,-1.718140330192752],[103.7488610110933,-1.715889400757354],[103.7480063514191,-1.711495969107681],[103.7480148950649,-1.710986618631775],[103.7475334812153,-1.709261045954643],[103.7467655889916,-1.700485012755145],[103.7457501660986,-1.697648374135764],[103.7446852534826,-1.679356404058455],[103.7442356195023,-1.665815759582959],[103.743649807928,-1.645676210633454],[103.7436047817333,-1.642864604756159],[103.7432148655316,-1.64002939398771],[103.742102653611,-1.631574300458459],[103.7416343610202,-1.628998376507465],[103.7410623518985,-1.623289390162217],[103.7406325566379,-1.620285703774641],[103.7410126476677,-1.617082459179115],[103.7409868755961,-1.61638190031304],[103.7404417449936,-1.615326250488051],[103.7400770352503,-1.614570027855863],[103.7399404088893,-1.610588768794655],[103.7396343147235,-1.609105428474753],[103.737817547706,-1.604857124764165],[103.7370682916534,-1.604275249095449],[103.7360806394397,-1.603687649503773],[103.7292409933493,-1.595435343502588],[103.7282647442134,-1.591969591359584],[103.7284684399488,-1.586669443912877],[103.7292974688482,-1.584948892213772],[103.7291894895057,-1.581963140783565],[103.730639299715,-1.578459509953649],[103.7309068132321,-1.575898368491551],[103.7286215156747,-1.566231202608301],[103.7297779409311,-1.558598596633427],[103.7288041322423,-1.555249215072028],[103.7229902655567,-1.541444108184013],[103.722363452224,-1.539985677470733],[103.722269993277,-1.529878721427341],[103.7231376439989,-1.526744289160022],[103.7233883363559,-1.526283260630048],[103.723870979535,-1.500868790284734],[103.7242329333083,-1.491886890624902],[103.724206076013,-1.487830846460078],[103.7239264225253,-1.481132147759782],[103.7229793869443,-1.469684282787995],[103.7210687579173,-1.447355321797251],[103.7203709146931,-1.43981900282634],[103.7199325215957,-1.438219719582269],[103.7178135233924,-1.432840378926746],[103.715891334379,-1.425929974003098],[103.7149299426257,-1.423186356594958],[103.7077180568035,-1.402752918909063],[103.6991417163119,-1.374269231198143],[103.6986612830993,-1.372511145182513],[103.6933691775338,-1.356334791510209],[103.6905549226452,-1.346234946055765],[103.6883217629014,-1.340595988840261],[103.6867200131506,-1.335444480462097],[103.6834248611695,-1.325249578201173],[103.6812102337939,-1.318259425785618],[103.6810907769453,-1.316410220634224],[103.6770068988517,-1.305251209361063],[103.6683196924415,-1.278813802141408],[103.659306643262,-1.250409272506048],[103.6556191255425,-1.238581508721734],[103.6553495853275,-1.219861986188938],[103.7003607410499,-1.186103636083334],[103.7012285124331,-1.185567298346018],[103.7162725771665,-1.192858592508117]],V=R=>new Promise(A=>setTimeout(A,R)),z=()=>{const R=(i,u)=>{const p=A(i),a=[];for(let s=0;s<p.length;s++){const l=p[s][0],d=p[s][1],g=p[s][2],S=p[s][3];if(u==="dynamic")a.push(U(l,d,g,S));else if(u=="rf_single"){const m="https://apimljmr.findingoillosses.com/jmr/predict/randfor/single",k={spot1:l,spot2:d,spot3:g,spot4:S};F.post(m,k).then(_=>{const P=_.data.results;for(const j in P){const f=parseFloat(P[j].lokasi),h=P[j].status,y=P[j].titik,M=110,c=null;let n="",r,t;isNaN(f)?(t=!1,r={message:"Probabilitas yang terjadi",probabilities:["Tidak terdapat kebocoran","Start/Stop pompa","Switch tangki"],useMap:!1,leak:!1},a.push({suspectLocation:r,tap:t,y:f,status:h,titik:y})):(f<=0?(t=!1,r={message:"Probabilitas yang terjadi",probabilities:["Tidak terdapat kebocoran","Start/Stop pompa","Switch tangki"],useMap:!1,leak:!1}):f>=M?(t=!1,r={message:"Probabilitas yang terjadi",probabilities:["Tidak terdapat kebocoran","Start/Stop pompa","Switch tangki"],useMap:!1,leak:!1}):(t=!0,n=L(f*1e3,N),r={message:"Terdapat indikasi kebocoran",leak:!0,useMap:!0,leakData:{leak_point:f,pu_location:c,coordinate:n}}),n?a.push({suspectLocation:r,tap:t,y:f,mapsLink:n}):a.push({suspectLocation:r,tap:t,y:f}))}}).catch(_=>{console.log(_)})}else if(u=="lr_single"){const m="https://apimljmr.findingoillosses.com/jmr/predict/randfor/single",k={spot1:l,spot2:d,spot3:g,spot4:S};F.post(m,k).then(_=>{const P=_.data.results;for(const j in P){const f=parseFloat(P[j].lokasi),h=P[j].status,y=P[j].titik,M=110,c=null;let n="",r,t;isNaN(f)?(t=!1,r={message:"Probabilitas yang terjadi",probabilities:["Tidak terdapat kebocoran","Start/Stop pompa","Switch tangki"],useMap:!1,leak:!1},a.push({suspectLocation:r,tap:t,y:f,status:h,titik:y})):(f<=0?(t=!1,r={message:"Probabilitas yang terjadi",probabilities:["Tidak terdapat kebocoran","Start/Stop pompa","Switch tangki"],useMap:!1,leak:!1}):f>=M?(t=!1,r={message:"Probabilitas yang terjadi",probabilities:["Tidak terdapat kebocoran","Start/Stop pompa","Switch tangki"],useMap:!1,leak:!1}):(t=!0,n=L(f*1e3,N),r={message:"Terdapat indikasi kebocoran",leak:!0,useMap:!0,leakData:{leak_point:f,pu_location:c,coordinate:n}}),n?a.push({suspectLocation:r,tap:t,y:f,mapsLink:n}):a.push({suspectLocation:r,tap:t,y:f}))}}).catch(_=>{console.log(_)})}}return a},A=i=>{const u=[],p=[];Object.keys(i).forEach(s=>{if(i[s].type==="normal")for(let l=0;l<i[s].data.length;l++)u.push(i[s].data[l].avgPsiValues);else{const l=[];for(let d=0;d<i[s].data.length;d++)l.push(i[s].data[d].avgPsiValues);p.push(l)}});const a=[];for(let s=0;s<p.length;s++){const l=[];for(let d=0;d<9;d++){const g=Math.max(0,u[d]-p[s][d]).toFixed(2);l.push(g)}a.push(l)}return a},I=(i,u)=>new Promise(async(p,a)=>{try{const s=[],l=["rf_single","rf4_multi","lr_single","dt_single","dt4_multi","dynamic"],d=["https://apimljmr.findingoillosses.com/jmr/predict/randfor/single","https://apimljmr.findingoillosses.com/jmr/predict/randfor/multi4","https://apimljmr.findingoillosses.com/jmr/predict/lreg/single","https://apimljmr.findingoillosses.com/jmr/predict/dtree/single","https://apimljmr.findingoillosses.com/jmr/predict/dtree/multi4","dynamic"],g=l.indexOf(u);if(g===-1){a(new Error("Invalid prediction type"));return}const S=d[g],m=A(i),k=m[0][0],_=m[0][1],P=m[0][2],j=m[0][3],f={spot1:k,spot2:_,spot3:P,spot4:j};if(d[g]==="dynamic"){await V(50),s.push(U(k,_,P,j)),p(s);return}else F.post(S,f).then(h=>{const y=h.data.results;for(const M in y){const c=parseFloat(y[M].lokasi),n=y[M].status,r=y[M].titik,t=110,D=null;let T="",w,x;isNaN(c)?(x=!1,w={message:"Probabilitas yang terjadi",probabilities:["Tidak terdapat kebocoran","Start/Stop pompa","Switch tangki"],useMap:!1,leak:!1},s.push({drop:M,suspectLocation:w,tap:x,y:c,status:n,titik:r})):(c<=0?(x=!1,w={message:"Probabilitas yang terjadi",probabilities:["Tidak terdapat kebocoran","Start/Stop pompa","Switch tangki"],useMap:!1,leak:!1}):c>=t?(x=!1,w={message:"Probabilitas yang terjadi",probabilities:["Tidak terdapat kebocoran","Start/Stop pompa","Switch tangki"],useMap:!1,leak:!1}):(x=!0,T=L(c*1e3,N),w={message:"Terdapat indikasi kebocoran",leak:!0,useMap:!0,leakData:{leak_point:c,pu_location:D,coordinate:T}}),T?s.push({drop:M,suspectLocation:w,tap:x,y:c,mapsLink:T}):s.push({drop:M,suspectLocation:w,tap:x,y:c}))}p(s)})}catch(s){a(s)}}),E=(i,u)=>{const p=A(i),a=[];let s=1;for(let l=0;l<p.length;l++){const d=p[l][0],g=p[l][1],S=p[l][2],m=p[l][3],k=p[l][4],_=p[l][5],P=p[l][6],j=p[l][7],f=p[l][8],h=s;if(u==="lr_lasso"){const y="https://apimljmr.findingoillosses.com/jmr/predict/lr/lasso",M={spot1:d,spot2:g,spot3:S,spot4:m,spot5:k,spot6:_,spot7:P,spot8:j,spot9:f};F.post(y,M).then(c=>{const n=c.data.results;for(const r in n){const t=parseFloat(n[r].lokasi),D=n[r].status,T=n[r].titik,w=109.3,x=null;let b="",e,o;isNaN(t)?(o=!1,e={message:"Probabilitas yang terjadi",probabilities:["Tidak terdapat kebocoran","Start/Stop pompa","Switch tangki"],useMap:!1,leak:!1},a.push({drop:h,suspectLocation:e,tap:o,y:t,status:D,titik:T})):(t<=0?(o=!1,e={message:"Probabilitas yang terjadi",probabilities:["Tidak terdapat kebocoran","Start/Stop pompa","Switch tangki"],useMap:!1,leak:!1}):t>=w?(o=!1,e={message:"Probabilitas yang terjadi",probabilities:["Tidak terdapat kebocoran","Start/Stop pompa","Switch tangki"],useMap:!1,leak:!1}):(o=!0,b=L(t*1e3,N),e={message:"Terdapat indikasi kebocoran",leak:!0,useMap:!0,leakData:{leak_point:t,pu_location:x,coordinate:b}}),b?a.push({drop:h,suspectLocation:e,tap:o,y:t,mapsLink:b}):a.push({drop:h,suspectLocation:e,tap:o,y:t}))}}).catch(c=>{console.log(c)}),s+=1}else if(u==="rf_single"){const y="https://apimljmr.findingoillosses.com/jmr/predict/randfor/single",M={spot1:d,spot2:g,spot3:S,spot4:m};F.post(y,M).then(c=>{const n=c.data.results;for(const r in n){const t=parseFloat(n[r].lokasi),D=n[r].status,T=n[r].titik,w=109.3,x=null;let b="",e,o;isNaN(t)?(o=!1,e={message:"Probabilitas yang terjadi",probabilities:["Tidak terdapat kebocoran","Start/Stop pompa","Switch tangki"],useMap:!1,leak:!1},a.push({drop:h,suspectLocation:e,tap:o,y:t,status:D,titik:T})):(t<=0?(o=!1,e={message:"Probabilitas yang terjadi",probabilities:["Tidak terdapat kebocoran","Start/Stop pompa","Switch tangki"],useMap:!1,leak:!1}):t>=w?(o=!1,e={message:"Probabilitas yang terjadi",probabilities:["Tidak terdapat kebocoran","Start/Stop pompa","Switch tangki"],useMap:!1,leak:!1}):(o=!0,b=L(t*1e3,N),e={message:"Terdapat indikasi kebocoran",leak:!0,useMap:!0,leakData:{leak_point:t,pu_location:x,coordinate:b}}),b?a.push({drop:h,suspectLocation:e,tap:o,y:t,mapsLink:b}):a.push({drop:h,suspectLocation:e,tap:o,y:t}))}}).catch(c=>{console.log(c)}),s+=1}if(u==="rf4_multi"){const y="https://apimljmr.findingoillosses.com/jmr/predict/randfor/multi4",M={spot1:d,spot2:g,spot3:S,spot4:m};F.post(y,M).then(c=>{const n=c.data.results;for(const r in n){const t=parseFloat(n[r].lokasi),D=n[r].status,T=n[r].titik,w=109.3,x=null;let b="",e,o;isNaN(t)?(o=!1,e={message:"Probabilitas yang terjadi",probabilities:["Tidak terdapat kebocoran","Start/Stop pompa","Switch tangki"],useMap:!1,leak:!1},a.push({drop:h,suspectLocation:e,tap:o,y:t,status:D,titik:T})):(t<=0?(o=!1,e={message:"Probabilitas yang terjadi",probabilities:["Tidak terdapat kebocoran","Start/Stop pompa","Switch tangki"],useMap:!1,leak:!1}):t>=w?(o=!1,e={message:"Probabilitas yang terjadi",probabilities:["Tidak terdapat kebocoran","Start/Stop pompa","Switch tangki"],useMap:!1,leak:!1}):(o=!0,b=L(t*1e3,N),e={message:"Terdapat indikasi kebocoran",leak:!0,useMap:!0,leakData:{leak_point:t,pu_location:x,coordinate:b}}),b?a.push({drop:h,suspectLocation:e,tap:o,y:t,mapsLink:b}):a.push({drop:h,suspectLocation:e,tap:o,y:t}))}}).catch(c=>{console.log(c)}),s+=1}else if(u=="lr_single"){const y="https://apimljmr.findingoillosses.com/jmr/predict/lreg/single",M={spot1:d,spot2:g,spot3:S,spot4:m};F.post(y,M).then(c=>{const n=c.data.results;for(const r in n){const t=parseFloat(n[r].lokasi),D=n[r].status,T=n[r].titik,w=109.3,x=null;let b="",e,o;isNaN(t)?(o=!1,e={message:"Probabilitas yang terjadi",probabilities:["Tidak terdapat kebocoran","Start/Stop pompa","Switch tangki"],useMap:!1,leak:!1},a.push({drop:h,suspectLocation:e,tap:o,y:t,status:D,titik:T})):(t<=0?(o=!1,e={message:"Probabilitas yang terjadi",probabilities:["Tidak terdapat kebocoran","Start/Stop pompa","Switch tangki"],useMap:!1,leak:!1}):t>=w?(o=!1,e={message:"Probabilitas yang terjadi",probabilities:["Tidak terdapat kebocoran","Start/Stop pompa","Switch tangki"],useMap:!1,leak:!1}):(o=!0,b=L(t*1e3,N),e={message:"Terdapat indikasi kebocoran",leak:!0,useMap:!0,leakData:{leak_point:t,pu_location:x,coordinate:b}}),b?a.push({drop:h,suspectLocation:e,tap:o,y:t,mapsLink:b}):a.push({drop:h,suspectLocation:e,tap:o,y:t}))}}).catch(c=>{console.log(c)}),s+=1}else if(u=="dt_single"){const y="https://apimljmr.findingoillosses.com/jmr/predict/dtree/single",M={spot1:d,spot2:g,spot3:S,spot4:m};F.post(y,M).then(c=>{const n=c.data.results;for(const r in n){const t=parseFloat(n[r].lokasi),D=n[r].status,T=n[r].titik,w=109.3,x=null;let b="",e,o;isNaN(t)?(o=!1,e={message:"Probabilitas yang terjadi",probabilities:["Tidak terdapat kebocoran","Start/Stop pompa","Switch tangki"],useMap:!1,leak:!1},a.push({drop:h,suspectLocation:e,tap:o,y:t,status:D,titik:T})):(t<=0?(o=!1,e={message:"Probabilitas yang terjadi",probabilities:["Tidak terdapat kebocoran","Start/Stop pompa","Switch tangki"],useMap:!1,leak:!1}):t>=w?(o=!1,e={message:"Probabilitas yang terjadi",probabilities:["Tidak terdapat kebocoran","Start/Stop pompa","Switch tangki"],useMap:!1,leak:!1}):(o=!0,b=L(t*1e3,N),e={message:"Terdapat indikasi kebocoran",leak:!0,useMap:!0,leakData:{leak_point:t,pu_location:x,coordinate:b}}),b?a.push({drop:h,suspectLocation:e,tap:o,y:t,mapsLink:b}):a.push({drop:h,suspectLocation:e,tap:o,y:t}))}}).catch(c=>{console.log(c)}),s+=1}else if(u=="dt4_multi"){const y="https://apimljmr.findingoillosses.com/jmr/predict/dtree/multi4",M={spot1:d,spot2:g,spot3:S,spot4:m};F.post(y,M).then(c=>{const n=c.data.results;for(const r in n){const t=parseFloat(n[r].lokasi),D=n[r].status,T=n[r].titik,w=109.3,x=null;let b="",e,o;isNaN(t)?(o=!1,e={message:"Probabilitas yang terjadi",probabilities:["Tidak terdapat kebocoran","Start/Stop pompa","Switch tangki"],useMap:!1,leak:!1},a.push({drop:h,suspectLocation:e,tap:o,y:t,status:D,titik:T})):(t<=0?(o=!1,e={message:"Probabilitas yang terjadi",probabilities:["Tidak terdapat kebocoran","Start/Stop pompa","Switch tangki"],useMap:!1,leak:!1}):t>=w?(o=!1,e={message:"Probabilitas yang terjadi",probabilities:["Tidak terdapat kebocoran","Start/Stop pompa","Switch tangki"],useMap:!1,leak:!1}):(o=!0,b=L(t*1e3,N),e={message:"Terdapat indikasi kebocoran",leak:!0,useMap:!0,leakData:{leak_point:t,pu_location:x,coordinate:b}}),b?a.push({drop:h,suspectLocation:e,tap:o,y:t,mapsLink:b}):a.push({drop:h,suspectLocation:e,tap:o,y:t}))}}).catch(c=>{console.log(c)}),s+=1}else u=="dynamic"&&a.push(U(d,g,S,m))}return a},U=(i,u,p,a,s=1)=>{const l=i,d=u,g=p,S=a,m=110;let k=(m+-15.21*l+9.2*d+-10.5*g+-16.6*S).toFixed(2);k=parseFloat(k);const _=null;let P="",j,f;return isNaN(k)?(f=!1,j={message:"Probabilitas yang terjadi",probabilities:["Tidak terdapat kebocoran","Start/Stop pompa","Switch tangki"],useMap:!1,leak:!1},{drop:s,suspectLocation:j,tap:f,y:k}):(k<=0?(f=!1,j={message:"Probabilitas yang terjadi",probabilities:["Tidak terdapat kebocoran","Start/Stop pompa","Switch tangki"],useMap:!1,leak:!1}):k>=m?(f=!1,j={message:"Probabilitas yang terjadi",probabilities:["Tidak terdapat kebocoran","Start/Stop pompa","Switch tangki"],useMap:!1,leak:!1}):(f=!0,P=L(k*1e3,N),j={message:"Terdapat indikasi kebocoran",leak:!0,useMap:!0,leakData:{leak_point:k,pu_location:_,coordinate:P}}),P?{drop:s,suspectLocation:j,tap:f,y:k,mapsLink:P}:{drop:s,suspectLocation:j,tap:f,y:k})},L=(i,u)=>{const s=O(u,i);return{latitude:s[0],longitude:s[1]}},O=(i,u)=>{const p=i.length;for(let a=0;a<p-1;a++){const s=J(i[a][1],i[a][0],i[a+1][1],i[a+1][0]);if(u<=s){const l=v(i[a][1],i[a][0],i[a+1][1],i[a+1][0]);return q(i[a][1],i[a][0],u,l)}else u-=s}return i[p-1]},v=(i,u,p,a)=>{const s=k=>k*(Math.PI/180),l=k=>k*(180/Math.PI);i=s(i),p=s(p);const d=s(a-u),g=Math.sin(d)*Math.cos(p),S=Math.cos(i)*Math.sin(p)-Math.sin(i)*Math.cos(p)*Math.cos(d),m=Math.atan2(g,S);return(l(m)+360)%360},q=(i,u,p,a)=>{const l=k=>k*(Math.PI/180),d=k=>k*(180/Math.PI);i=l(i),u=l(u),a=l(a);const g=p/6371e3,S=Math.asin(Math.sin(i)*Math.cos(g)+Math.cos(i)*Math.sin(g)*Math.cos(a)),m=u+Math.atan2(Math.sin(a)*Math.sin(g)*Math.cos(i),Math.cos(g)-Math.sin(i)*Math.sin(S));return[d(S),d(m)]},J=(i,u,p,a)=>{const l=k=>k*(Math.PI/180),d=l(p-i),g=l(a-u),S=Math.sin(d/2)**2+Math.cos(l(i))*Math.cos(l(p))*Math.sin(g/2)**2;return 6371e3*(2*Math.atan2(Math.sqrt(S),Math.sqrt(1-S)))};return{buildDeltas:A,predict:R,mlpredict:E,asyncPredict:I}};export{N as J,z as u};
